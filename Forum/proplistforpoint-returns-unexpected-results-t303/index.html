<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>Moai Forum | The mobile platform for pro game developers &bull; View topic - propListForPoint returns unexpected results</title>

<link rel="alternate" type="application/atom+xml" title="Feed - Moai Forum | The mobile platform for pro game developers" href="../feed.php.html" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="../feed.php%3Fmode=forums.html" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="../feed.php%3Fmode=topics.html" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="../feed.php%3Fmode=topics_active.html" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - Moai SDK Developer Support" href="../feed.php%3Ff=7.html" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - propListForPoint returns unexpected results" href="../feed.php%3Ff=7&amp;t=303.html" />

<!--
	phpBB style name: proFormell
	Based on style:   prosilver (this is the default phpBB3 style)
	Inspired by:	  Formell (Joomla Style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  	  Marc Alexander
	
	NOTE: This page was generated by phpBB, the free open-source bulletin board package.
	      The phpBB Group is not responsible for the content of this page and forum. For more information
	      about phpBB please visit http://www.phpbb.com
-->

<script type="text/javascript">
// <![CDATA[
	var jump_page = 'Enter the page number you wish to go to:';
	var on_page = '1';
	var per_page = '';
	var base_url = '';
	var style_cookie = 'phpBBstyle';
	var style_cookie_settings = '; path=/';
	var onload_functions = new Array();
	var onunload_functions = new Array();
	var is_ie6 = false;

	/**
	* Find a member
	*/
	function find_username(url)
	{
		popup(url, 760, 570, '_usersearch');
		return false;
	}

	/**
	* New function for handling multiple calls to window.onload and window.unload by pentapenguin
	*/
	window.onload = function()
	{
		for (var i = 0; i < onload_functions.length; i++)
		{
			eval(onload_functions[i]);
		}
	}

	window.onunload = function()
	{
		for (var i = 0; i < onunload_functions.length; i++)
		{
			eval(onunload_functions[i]);
		}
	}

// ]]>
</script>
<!--[if lt IE 7]>
<script type="text/javascript">
// <![CDATA[
var is_ie6 = true;
// ]]>
</script>
<![endif]-->


<link href="../styles/proFormell/theme/print.css" rel="stylesheet" type="text/css" media="print" title="printonly" />

<link href="../style.css" rel="stylesheet" type="text/css" media="screen, projection" />



<link href="../styles/proFormell/theme/images/favicon.ico" rel="shortcut icon" />

<script type="text/javascript" src="../styles/prosilver/template/forum_fn.js"></script>
<script src="../styles/prosilver/template/jquery-1.4.4.min.js" type="text/javascript"></script>

<script type="text/javascript">
// <![CDATA[
/**
* New pop-up functions
* based on  http://yensdesign.com/2008/09/how-to-create-a-stunning-and-smooth-popup-using-jquery/
*/

//SETTING UP OUR POPUP
//0 means disabled; 1 means enabled;
var popupStatus = 0;
var openPopup = '';

//loading popup with jQuery magic!
function loadPopup()
{
	//loads popup only if it is disabled
	if(popupStatus==0)
	{
		$('#backgroundPopup').css({'opacity': '0.7'});
		// Now let's make sure we actually see the image
		var scroll = $(window).scrollTop();
		$('#popupPM').animate({marginTop: scroll}, 'fast', function() {
			// Animation complete.
			});
		$('#backgroundPopup').fadeIn('slow');
		$('#popupPM').fadeIn('slow');
		popupStatus = 1;
		openPopup = 'PM';
	}
}

//disabling popup with jQuery magic!
function disablePopup()
{
	//disables popup only if it is enabled
	if(popupStatus==1 && openPopup == 'PM')
	{
		$('#backgroundPopup').fadeOut('slow');
		$('#popupPM').fadeOut('slow');
		popupStatus = 0;
		openPopup = '';
	}
}

//centering popup
function centerPopup()
{
	//request data for centering
	var windowWidth = document.documentElement.clientWidth;
	var windowHeight = document.documentElement.clientHeight;
	var popupHeight = $('#popupPM').height();
	var popupWidth = $('#popupPM').width();
	//centering
	$('#popupPM').css({
	'position': 'absolute',
	'top': windowHeight/2-popupHeight/2,
	'left': windowWidth/2-popupWidth/2
	});
	//only need force for IE6
	$('#backgroundPopup').css({'height': windowHeight});
}

$(document).ready(function(){
	
	resize_images();
	
	
	// IE6 and below PNG fix (not really)
	if(is_ie6)
	{
		replace_png();
	}
	
	//CLOSING POPUP
	//Click the x event!
	$('#popupPMClose').click(function(){
		disablePopup();
	});
	//Click out event!
	$('#backgroundPopup').click(function(){
		disablePopup();
		disableImage();
	});
	//Press Escape event!
	$(document).keypress(function(e){
		if(e.keyCode==27 && popupStatus==1)
		{
			disablePopup();
			disableImage();
		}
	});
	
	
	// Image popup
	$('img', 'dt.attach-image').click(function(){
		image_load($(this).attr('src'), $(this).attr('alt'));
		centerImage();
	});
	
	$('.content img').click(function(){
		var check = $(this).parent().hasClass('content');
		if(check)
		{
			image_load($(this).attr('src'), $(this).attr('alt'));
			centerImage();
		}
	});
	
	// Closing Image popup
	//Click the x event!
	$('#popupImageClose').click(function(){
		disableImage();
	});
	
	//Click image box event
	$('#popupImage').click(function(){
		disableImage();
	});
	
	//Click image event
	$('#ImagePopup img').click(function(){
		disableImage();
	});
	

});

/**
* Replaces weird looking PNG files with the respectie GIF file
* Only run this if the browser is IE6 or below
*/
function replace_png()
{
	// Fix Logo
	var str = $('#logo img').attr('src'); 
	$('#logo img').attr('src', str.substring(0, str.length - 3) + 'gif');
	
	// Fix forum icons
	$('dl.icon').each(function() {
		var str = $(this).css('background-image');
		if(str != '')
		{
			$(this).css('background-image', str.substring(0, str.length - 5) + 'gif")');
		}
	});
}


/**
* Image resizer
*/
function resize_images()
{
	var hello = $('dl.attachbox dd dl.file dt.attach-image img').innerWidth();
	var maxWidth = $('div.content').innerWidth() - 30;
	
	// resize the attached images
	$('img', 'dt.attach-image').each(function(i){
		// check the width of the image
		if ($(this).width() > maxWidth)
		{
			// calculate new image dimensions
			newWidth = maxWidth;
			newHeight = $(this).height() / ( $(this).width() / maxWidth );
			   
			// set new image dimensions
			$(this).height(newHeight).width(newWidth);
		}
	});
	
	// resize the images that were added via [img] bbcode
	$('img', 'div.content').each(function(i){
		// check the width of the image
		$(this).css('max-width', maxWidth); // fix for IE
		if ($(this).width() > maxWidth)
		{
			// calculate new image dimensions
			newWidth = maxWidth;
			newHeight = $(this).height() / ( $(this).width() / maxWidth );
			   
			// set new image dimensions
			$(this).height(newHeight).width(newWidth);
		}
	});
}

/**
* Image pop-up
*/
function image_load(src, alt)
{
	//loads popup only if it is disabled
	if(popupStatus==0)
	{
		$('#ImagePopup').html('<img id="imgpopup" src="http://192.168.20.226:3000/forums/proplistforpoint-returns-unexpected-results-t303/'&#32;+&#32;src&#32;+&#32;'" alt="' + alt + '" />');
		var windowWidth = document.documentElement.clientWidth;
		var windowHeight = document.documentElement.clientHeight;
		var maxWidth = windowWidth * 0.85;
		var maxHeight = windowHeight * 0.85;
		$('#popupImage img').css('max-width', maxWidth);
		$('#popupImage img').css('max-height', maxHeight);
		$('#backgroundPopup').css({'opacity': '0.7'});
		// Now let's make sure we actually see the image
		var scroll = $(window).scrollTop();
		$('#popupImage').animate({marginTop: scroll}, 'fast', function() {
			// Animation complete.
			});
		$('#backgroundPopup').fadeIn('slow');
		$('#popupImage').fadeIn('slow');
		popupStatus = 1;
		openPopup = 'Image';
	}
}

//centering popup
function centerImage()
{
	//request data for centering
	var windowWidth = document.documentElement.clientWidth;
	var windowHeight = document.documentElement.clientHeight;
	var popupHeight = $('#popupImage').height();
	var popupWidth = $('#popupImage').width();
	var newTop = windowHeight/2-popupHeight/2;
	var newLeft = windowWidth/2-popupWidth/2;
	//centering
	$('#popupImage').css({
	'position': 'absolute',
	'top': newTop,
	'left': newLeft
	});
	
	//only need force for IE6
	$('#backgroundPopup').css({'height': windowHeight});
}

//disabling popup with jQuery magic!
function disableImage()
{
	//disables popup only if it is enabled
	if(popupStatus==1 && openPopup == 'Image')
	{
		$('#backgroundPopup').fadeOut('slow');
		$('#popupImage').fadeOut('slow');
		popupStatus = 0;
		openPopup = '';
	}
}


// ]]>
</script>

</head>

<body id="phpbb" class="section-viewtopic ltr">
<!--- box border START -->
<div id="box">

<div class="top-left"></div><div class="top-center"></div><div class="top-right"></div>
<div id="left-border">
<div id="right-border">


<!--- box border END -->
<div class="inside">
 <div class="notopgap">
<div id="wrap">
	<a id="top" name="top" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar">
			<div class="inner"><!-- <span class="corners-top"><span></span></span> -->
			<div style="height: 140px ;">
			<div id="site-description">
				<div class="header-pad"><a href="http://getmoai.com" title="" id="logo"><img src="../styles/proFormell/imageset/site-logo.png" width="410" height="98" alt="" title="" /></a></div>
			
		<!--		<p class="site-desc">The mobile platform for pro game developers</p> -->
				<p class="skiplink"><a href="index.html#start_here">Skip to content</a></p>
			</div>

		
    </div>

			<span class="corners-bottom"><span></span></span></div>
		</div>

		<div class="navbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<ul class="linklist navlinks">
				<li class="icon-home"><a href="../index.html" accesskey="h">Board index</a>  <strong>&#8249;</strong> <a href="../moai-development-forums.html">Moai Development Forums</a> <strong>&#8249;</strong> <a href="../moai-sdk-developer-support.html">Moai SDK Developer Support</a></li>

				<li class="rightside"><a href="index.html#" onclick="fontsizeup(); return false;" onkeypress="return fontsizeup(event);" class="fontsize" title="Change font size">Change font size</a></li>

				<li class="rightside"><a href="../memberlist.php%3Fmode=email&amp;t=303.html" title="E-mail friend" class="sendemail">E-mail friend</a></li><li class="rightside"><a href="../viewtopic.php%3Ff=7&amp;t=303&amp;start=0&amp;view=print.html" title="Print view" accesskey="p" class="print">Print view</a></li>
			</ul>

			

			<ul class="linklist rightside">
				<li class="icon-faq"><a href="../faq.php.html" title="Frequently Asked Questions">FAQ</a></li>
				
				
			</ul>

			<span class="corners-bottom"><span></span></span></div>
		</div>
	</div>

	<a name="start_here"></a>
	<div id="page-body">
		
<h2><a href="index.html">propListForPoint returns unexpected results</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body --><div style="display: none !important;">Support for using Moai on IOS and Android - post questions, bugs and issues here.<br /></div>

<div class="topic-actions">

	<div class="buttons">
	
	</div>

	
		<div class="pagination">
			16 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	

</div>
<div class="clear"></div>


	<div id="p1449" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 class="first"><a href="index.html#p1449">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>lledwichau</strong> &raquo; Wed Dec 28, 2011 3:31 pm </p>

			

			<div class="content">I have a simple screen system going using images as buttons and have been happily using Partition:propForPoint without a problem.  As the system gets more complicated I am attempting to use Partition:propListForPoint but the results returned are random and useless.
<br />
<br />
<br />
<br />I would expect the list returned to include each prop beneath the point, however I usually get a single random prop from the partition.  At the least I would expect the result to include the result from Partition:propForPoint.
<br />
<br />
<br />
<br />Is there something that needs to be setup to make this work?</div>

			

		</div>

		
			<dl class="postprofile" id="profile1449">
			<dt>
				<strong>lledwichau</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 3</dd><dd><strong>Joined:</strong> Wed Dec 28, 2011 11:20 pm</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1459" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1459">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>bonozogames</strong> &raquo; Wed Dec 28, 2011 6:11 pm </p>

			

			<div class="content">Any luck with <a href="http://192.168.20.226:3000/docs/class_m_o_a_i_partition.html#acae225f18d88e6008556a0868632b9dd" target="_blank">sortedPropListForPoint</a> ?</div>

			

		</div>

		
			<dl class="postprofile" id="profile1459">
			<dt>
				<img src="http://192.168.20.226:3000/forums/download/file.php?avatar=282_1327341093.png" width="120" height="120" alt="User avatar" /><br />
				<strong>bonozogames</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 166</dd><dd><strong>Joined:</strong> Sun Nov 06, 2011 4:17 am</dd><dd><strong>Location:</strong> Tulsa, OK</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1461" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1461">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>lledwichau</strong> &raquo; Wed Dec 28, 2011 6:56 pm </p>

			

			<div class="content">no, it returns the same seemingly random list.
<br />
<br />
<br />
<br />I searched the forums a little more deeply and found a few posts about Partition:reserveLayer but the results of that were even worse.
<br />
<br />
<br />
<br />Can anyone confirm that these functions perform as indicated, they return a list of all props under the current position?
<br />
<br />
<br />
<br />Alternatively is anything else needed to setup layer/viewport/partition?
<br />
<br />
<br />
<br />Code Snippet:
<br />
<br />
<br />
<br />viewport = MOAIViewport.new ()
<br />viewport:setSize ( SCREEN_WIDTH, SCREEN_HEIGHT )
<br />viewport:setScale ( SCREEN_UNITS_X, SCREEN_UNITS_Y )
<br />
<br />uiLayer = MOAILayer2D.new ()
<br />uiLayer:setViewport ( viewport )
<br />MOAISim.pushRenderPass ( uiLayer )
<br />
<br />
<br />
<br />screenUIPartition = MOAIPartition.new ()
<br />
<br />uiLayer:setPartition ( screenUIPartition )</div>

			

		</div>

		
			<dl class="postprofile" id="profile1461">
			<dt>
				<strong>lledwichau</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 3</dd><dd><strong>Joined:</strong> Wed Dec 28, 2011 11:20 pm</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1462" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1462">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>bonozogames</strong> &raquo; Wed Dec 28, 2011 7:02 pm </p>

			

			<div class="content">In the distant past, I too was getting unexpected results.  I assumed the sorted version would fix it, but before trying it, I re-organized my props so that all the buttons were on top.  Ultimately, I, too, will need to be able to click on props underneath other props reliably.
<br />
<br />I hope you will consider creating a sample with the issue in <a href="http://pastebin.com/" target="_blank">pastebin</a>, so we can all try/fix it. </div>

			

		</div>

		
			<dl class="postprofile" id="profile1462">
			<dt>
				<img src="http://192.168.20.226:3000/forums/download/file.php?avatar=282_1327341093.png" width="120" height="120" alt="User avatar" /><br />
				<strong>bonozogames</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 166</dd><dd><strong>Joined:</strong> Sun Nov 06, 2011 4:17 am</dd><dd><strong>Location:</strong> Tulsa, OK</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1463" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1463">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>lledwichau</strong> &raquo; Wed Dec 28, 2011 7:14 pm </p>

			

			<div class="content">So I did something similar.  I modified the Pick sample and proved that the call works, it returns the list of props under the cursor.  Note that when all 5 images were stacked it crashes, 3 of 3, also the picking fails when there are 4 in the stack, returns a double entry.
<br />
<br />
<br />
<br />I just have to figure out where my code deviates, however given the above crash, I might have to look into manually performing the pick.
<br />
<br />
<br />
<br />Below is the edited callback function for the crash. To repro just drag all the images on top of each other and crash.
<br />
<br />
<br />
<br />function clickCallback ( down )
<br />   
<br />    if down then
<br />       
<br />        pick = partition:propForPoint ( mouseX, mouseY )
<br />       
<br />        pickList = partition:propListForPoint  ( mouseX, mouseY )
<br />        for pickKey, pickValue in pairs ( pickList ) do
<br />       
<br />            print ( "Key: " .. pickKey .. ", Value: " .. pickValue.name )
<br />        end
<br />       
<br />        if pick then
<br />            print ( pick.name )
<br />            pick:setPriority ( priority )
<br />            priority = priority + 1
<br />            pick:moveScl ( 0.25, 0.25, 0.125, MOAIEaseType.EASE_IN )
<br />        end
<br />    else
<br />        if pick then
<br />            pick:moveScl ( -0.25, -0.25, 0.125, MOAIEaseType.EASE_IN )
<br />            pick = nil
<br />        end
<br />    end
<br />end</div>

			

		</div>

		
			<dl class="postprofile" id="profile1463">
			<dt>
				<strong>lledwichau</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 3</dd><dd><strong>Joined:</strong> Wed Dec 28, 2011 11:20 pm</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1464" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1464">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>bonozogames</strong> &raquo; Wed Dec 28, 2011 7:20 pm </p>

			

			<div class="content"><blockquote>
<br />when all 5 images were stacked it crashes, 3 of 3, also the picking fails when there are 4 in the stack, returns a double entry.
<br />
<br /></blockquote>
<br /><img src="http://192.168.20.226:3000/wp-content/forum-smileys/sf-surprised.gif" alt="Surprised" /> ??</div>

			

		</div>

		
			<dl class="postprofile" id="profile1464">
			<dt>
				<img src="http://192.168.20.226:3000/forums/download/file.php?avatar=282_1327341093.png" width="120" height="120" alt="User avatar" /><br />
				<strong>bonozogames</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 166</dd><dd><strong>Joined:</strong> Sun Nov 06, 2011 4:17 am</dd><dd><strong>Location:</strong> Tulsa, OK</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1470" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1470">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong><span style="color: #AA0000;" class="username-coloured">patrick</span></strong> &raquo; Wed Dec 28, 2011 9:30 pm </p>

			

			<div class="content">Excellent, thanks. I ran your script and saw the repro. Will see what's going on and get you a fix ASAP.</div>

			

		</div>

		
			<dl class="postprofile" id="profile1470">
			<dt>
				<img src="http://www.gravatar.com/avatar/3f2c5c26c628e4b5500d87c737c60015?s=120.jpg" width="120" height="120" alt="User avatar" /><br />
				<strong><span style="color: #AA0000;" class="username-coloured">patrick</span></strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 574</dd><dd><strong>Joined:</strong> Sun Apr 03, 2011 5:50 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1472" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1472">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong><span style="color: #AA0000;" class="username-coloured">patrick</span></strong> &raquo; Wed Dec 28, 2011 9:54 pm </p>

			

			<div class="content">Bah... found the mistake. Just a dumb regression on my part. Fixed now. Will be in the next release. Or, if you are building from source, the fix was just pushed up to moai-dev/integration, MOAIPartitionResultBuffer.cpp lines 161-165.
<br />
<br />As always, thanks for your patience and for reporting this stuff.</div>

			

		</div>

		
			<dl class="postprofile" id="profile1472">
			<dt>
				<img src="http://www.gravatar.com/avatar/3f2c5c26c628e4b5500d87c737c60015?s=120.jpg" width="120" height="120" alt="User avatar" /><br />
				<strong><span style="color: #AA0000;" class="username-coloured">patrick</span></strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 574</dd><dd><strong>Joined:</strong> Sun Apr 03, 2011 5:50 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1474" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1474">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>mervills.email</strong> &raquo; Wed Dec 28, 2011 9:59 pm </p>

			

			<div class="content">While we are on this subject... why does this return nil?
<br />
<br /><a href="http://pastebin.com/ca8KRidZ" target="_blank">http://pastebin.com/ca8KRidZ</a>
<br />
<br />Is it the same error, or am I missing something obvious?</div>

			

		</div>

		
			<dl class="postprofile" id="profile1474">
			<dt>
				<strong>mervills.email</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 15</dd><dd><strong>Joined:</strong> Mon Dec 19, 2011 9:48 pm</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1476" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1476">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>bonozogames</strong> &raquo; Wed Dec 28, 2011 10:03 pm </p>

			

			<div class="content">Nice job pastebin'ing.  Helps us all help each other.
<br />
<br />You have to create the partition:
<br />
<br /><blockquote>
<br />
<br />partition = MOAIPartition.new ()
<br />layer:setPartition ( partition )
<br />
<br /></blockquote>
<br />On the rough chance it is not enough, then the simulation has to do its step; to prove, could try blocking on an action before propForPoint.
<br />
<br />BTW, I actually don't even know what the partition does/is.  But I do know I need it to read touches/clicks.  I've been able to interchange partitions and layers, but now I only use it for propForPoint. </div>

			

		</div>

		
			<dl class="postprofile" id="profile1476">
			<dt>
				<img src="http://192.168.20.226:3000/forums/download/file.php?avatar=282_1327341093.png" width="120" height="120" alt="User avatar" /><br />
				<strong>bonozogames</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 166</dd><dd><strong>Joined:</strong> Sun Nov 06, 2011 4:17 am</dd><dd><strong>Location:</strong> Tulsa, OK</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1477" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1477">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>mervills.email</strong> &raquo; Wed Dec 28, 2011 10:19 pm </p>

			

			<div class="content">Your original post about blocking on an action did the trick, as I said in the pastebin file, inserting a prop onto the layer forces partition creation.</div>

			

		</div>

		
			<dl class="postprofile" id="profile1477">
			<dt>
				<strong>mervills.email</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 15</dd><dd><strong>Joined:</strong> Mon Dec 19, 2011 9:48 pm</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1478" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1478">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>mervills.email</strong> &raquo; Wed Dec 28, 2011 10:33 pm </p>

			

			<div class="content">Here is what the code looks like now: <a href="http://pastebin.com/7cit78EZ" target="_blank">http://pastebin.com/7cit78EZ</a>
<br />
<br />
<br />
<br />As for what a partition does, I defer to the documentation: Class for optimizing spatial queries against sets of primitives
<br />
<br />
<br />
<br />Could use a more straightforward name though, or even better: integration into the layer class. (I.E. layer:propForPoint(x,y) )</div>

			

		</div>

		
			<dl class="postprofile" id="profile1478">
			<dt>
				<strong>mervills.email</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 15</dd><dd><strong>Joined:</strong> Mon Dec 19, 2011 9:48 pm</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1479" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1479">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>bonozogames</strong> &raquo; Wed Dec 28, 2011 10:36 pm </p>

			

			<div class="content">Cool, perhaps MOAIThread.blockOnAction( action ) instead of "while action:isBusy () do coroutine:yield () end"</div>

			

		</div>

		
			<dl class="postprofile" id="profile1479">
			<dt>
				<img src="http://192.168.20.226:3000/forums/download/file.php?avatar=282_1327341093.png" width="120" height="120" alt="User avatar" /><br />
				<strong>bonozogames</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 166</dd><dd><strong>Joined:</strong> Sun Nov 06, 2011 4:17 am</dd><dd><strong>Location:</strong> Tulsa, OK</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1480" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1480">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>mervills.email</strong> &raquo; Wed Dec 28, 2011 10:42 pm </p>

			

			<div class="content">Of course.
<br />
<br />I just ripped that code out of the docs for a quick test. XD</div>

			

		</div>

		
			<dl class="postprofile" id="profile1480">
			<dt>
				<strong>mervills.email</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 15</dd><dd><strong>Joined:</strong> Mon Dec 19, 2011 9:48 pm</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1513" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1513">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>bonozogames</strong> &raquo; Fri Dec 30, 2011 4:46 pm </p>

			

			<div class="content"><strong>Mervill said: </strong>
<br /><blockquote>
<br />As for what a partition does, I defer to the documentation: Class for optimizing spatial queries against sets of primitives
<br />
<br />Could use a more straightforward name though, or even better: integration into the layer class. (I.E. layer:propForPoint(x,y) )
<br />
<br /></blockquote>
<br />So it's a <a href="http://en.wikipedia.org/wiki/Quadtree" target="_blank">quad tree</a>?  I'm not understanding what it does more then match x,y to all objects...?  I need to investigate the code.  I feel I should have figured out what it does by just looking at it, and yet I don't. <img src="http://192.168.20.226:3000/wp-content/forum-smileys/sf-embarassed.gif" alt="Embarassed" /></div>

			

		</div>

		
			<dl class="postprofile" id="profile1513">
			<dt>
				<img src="http://192.168.20.226:3000/forums/download/file.php?avatar=282_1327341093.png" width="120" height="120" alt="User avatar" /><br />
				<strong>bonozogames</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 166</dd><dd><strong>Joined:</strong> Sun Nov 06, 2011 4:17 am</dd><dd><strong>Location:</strong> Tulsa, OK</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1514" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1514">propListForPoint returns unexpected results</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong><span style="color: #AA0000;" class="username-coloured">patrick</span></strong> &raquo; Fri Dec 30, 2011 6:12 pm </p>

			

			<div class="content">It's just a multi-level grid, nothing fancy. You have to set the number of grid levels and cell sizes yourself. You can use it to model a quad tree or (if it makes more sense for your game) a two- or three- level coarse/fine grid setup.
<br />
<br />Props have three kinds of dimensionality for the purpose of placement in the partition: empty, bounded and global. Empty is used for props that scale down to 0 or have uninitialized rects. Bounded is for props with normal rectangles and global is for props that should be returned for every query - things like tile maps with wrapping turned on.
<br />
<br />One quirk of our implementation is that each grid level rolls over at the edges. This means you don't have to worry about going off the edge of the partition, but you can wind up with distant objects stacked on top of each other in the same cell. These objects will turn up when walking the partition but get culled out by the broad phase check.
<br />
<br />FWIW, we wound up never using anything but the default 'one big list' partition for Wolf Toss... unless you have thousands of objects and are doing lots of spatial queries you probably don't need to worry much about it.</div>

			

		</div>

		
			<dl class="postprofile" id="profile1514">
			<dt>
				<img src="http://www.gravatar.com/avatar/3f2c5c26c628e4b5500d87c737c60015?s=120.jpg" width="120" height="120" alt="User avatar" /><br />
				<strong><span style="color: #AA0000;" class="username-coloured">patrick</span></strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 574</dd><dd><strong>Joined:</strong> Sun Apr 03, 2011 5:50 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<form id="viewtopic" method="post" action="index.html">

	<fieldset class="display-options" style="margin-top: 0; ">
		
	</fieldset>

	</form>
	<hr />


<div class="topic-actions">
	<div class="buttons">
	
	</div>

	
		<div class="pagination">
			16 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	
</div>


	<p></p><p><a href="../moai-sdk-developer-support.html" class="left-box left" accesskey="r">Return to Moai SDK Developer Support</a></p>

	<form method="post" id="jumpbox" action="http://192.168.20.226:3000/forums/viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	
		<fieldset class="jumpbox">
	
			<label for="f" accesskey="j">Jump to:</label>
			<select name="f" id="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">
			
				<option value="-1">Select a forum</option>
			<option value="-1">------------------</option>
				<option value="4">Moai Development Forums</option>
			
				<option value="7" selected="selected">&nbsp; &nbsp;Moai SDK Developer Support</option>
			
				<option value="8">&nbsp; &nbsp;Moai Cloud Developer Support</option>
			
				<option value="9">&nbsp; &nbsp;New Users</option>
			
				<option value="10">&nbsp; &nbsp;Bug Reports</option>
			
				<option value="3">Moai Community Forums</option>
			
				<option value="5">&nbsp; &nbsp;Moai Roadmap</option>
			
				<option value="6">&nbsp; &nbsp;Made With Moai</option>
			
			</select>
			<input type="submit" value="Go" class="button2" />
		</fieldset>
	</form>


	<h3>Who is online</h3>
	<p>Users browsing this forum: No registered users and 0 guests</p>
</div>

<div id="page-footer">

	<div class="navbar">
		<div class="inner"><span class="corners-top"><span></span></span>

		<ul class="linklist">
			<li class="icon-home"><a href="../index.html" accesskey="h">Board index</a></li>
				
			<li class="rightside">All times are UTC </li>
		</ul>

		<span class="corners-bottom"><span></span></span></div>
	</div>
	
	<div class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group<br />Style by <a href="http://www.m-a-styles.de">Marc Alexander</a> &copy;
		<br /><br /><a href="http://www.phpbb-seo.com/" title="Search Engine Optimization"><img src="../images/phpbb-seo.png" alt="phpBB SEO"/></a><br />Time : 0.045s | 11 Queries | GZIP : Off
	</div>
</div>

</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
	
	</div>
	</div>
<div class="nobottomgap"></div>
</div>
<!--- end of box border -->
</div></div>
<!-- -->
<div class="bottom-left"></div><div class="bottom-center"></div><div class="bottom-right"></div>
</div>
<!-- JQuery Pop Up --><!-- PM Popup --><!-- PM Popup end --><!-- Image Popup -->
<div id="popupImage">
	<p id="ImagePopup"></p>
	<a id="popupImageClose">x</a> 
</div>
<!-- Image Popup -->
<div id="backgroundPopup"></div> 
<!-- JQuery Pop Up END -->
</body>
</html>