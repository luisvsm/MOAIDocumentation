<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta name="robots" content="noindex" />

<title>Moai Forum &bull; View topic - FMOD Plugin battery draining? FIXED!</title>

<link href="styles/proFormell/theme/print.css" rel="stylesheet" type="text/css" />
<link type="image/vnd.microsoft.icon" rel="shortcut icon" href="styles/proFormell/theme/images/favicon.ico">
</head>

<body id="phpbb">
<div id="wrap">
	<a id="top" name="top" accesskey="t"></a>

	<div id="page-header">
		<h1>Moai Forum</h1>
		<p>The mobile platform for pro game developers<br /><a href="index.html">/forums/</a></p>

		<h2>FMOD Plugin battery draining? FIXED!</h2>
		<p><a href="fmod-plugin-battery-draining-fixed-t3035/index.html">/forums/fmod-plugin-battery-draining-fixed-t3035/</a></p>
	</div>

	<div id="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
		
			<div class="post">
				<h3>FMOD Plugin battery draining? FIXED!</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Tue Jan 27, 2015 3:18 am</strong></div>
				<div class="author">by <strong>JKON</strong></div>
				<div class="content">Hi..!<br /><br />We're getting some battery draining on Android with FMOD plugin version: <!-- m --><a class="postlink" href="https://github.com/Vavius/moai-fmod-studio/tree/master/moai-fmod-studio">https://github.com/Vavius/moai-fmod-stu ... mod-studio</a><!-- m --><br /><br />Looks like when the app is paused and screen is off, audio is still consuming power about 300mW..<br /><br />- in host.cpp.in there is no code for AKUPluginsPause or AKUPluginsResume ... Should there be?<br /><br />// JKON</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: FMOD Plugin battery draining?</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Tue Jan 27, 2015 7:31 am</strong></div>
				<div class="author">by <strong>Vavius</strong></div>
				<div class="content">Yes, there definitely should be code for Pause/Resume. Missed that... Or maybe in one of many MOAI branches those methods were defined. Checked moai-dev/1.5-stable - AKUPluginsPause is missing. <br /><br />Also, make sure that you call those from your host (add it near the place where untz pause/resume is called).</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: FMOD Plugin battery draining?</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Wed Jan 28, 2015 6:38 am</strong></div>
				<div class="author">by <strong>JKON</strong></div>
				<div class="content"><blockquote><div><cite>Vavius wrote:</cite>Yes, there definitely should be code for Pause/Resume. Missed that... Or maybe in one of many MOAI branches those methods were defined. Checked moai-dev/1.5-stable - AKUPluginsPause is missing. <br /><br />Also, make sure that you call those from your host (add it near the place where untz pause/resume is called).</div></blockquote><br /><br />Okay.. Now I got it working properly..! Looks like the pause and resume hooks were not implemented in moai plugin architecture, fmod plugin itself was perfect! <img src="images/smilies/icon_e_smile.gif" alt=":)" title="Smile" /> <br /><br />I made these modifications:<br /><br />\cmake\moai-plugins\CMakeLists.txt<br /><br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=23&amp;t=3035&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="cmake" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><a href="http://www.cmake.org/cmake/help/cmake2.6docs.html#command:set"><span style="color: #1f3f81; font-style: bold;">set</span></a><span style="color: #197d8b;">(</span>PLUGIN_PAUSE <span style="color: #912f11;">&quot;// plugin pause here&quot;</span><span style="color: #197d8b;">)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><a href="http://www.cmake.org/cmake/help/cmake2.6docs.html#command:set"><span style="color: #1f3f81; font-style: bold;">set</span></a><span style="color: #197d8b;">(</span>PLUGIN_RESUME <span style="color: #912f11;">&quot;// plugin resume here&quot;</span><span style="color: #197d8b;">)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">...</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><a href="http://www.cmake.org/cmake/help/cmake2.6docs.html#command:set"><span style="color: #1f3f81; font-style: bold;">set</span></a> <span style="color: #197d8b;">(</span>PLUGIN_PAUSE <span style="color: #912f11;">&quot;<span style="color: #b08000;">${PLUGIN_PAUSE}</span><span style="color: #000099; font-weight: bold;">\n</span><span style="color: #b08000;">${PLUGIN_PREFIX}</span>Pause();&quot;</span> <span style="color: #197d8b;">)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><a href="http://www.cmake.org/cmake/help/cmake2.6docs.html#command:set"><span style="color: #1f3f81; font-style: bold;">set</span></a> <span style="color: #197d8b;">(</span>PLUGIN_RESUME <span style="color: #912f11;">&quot;<span style="color: #b08000;">${PLUGIN_RESUME}</span><span style="color: #000099; font-weight: bold;">\n</span><span style="color: #b08000;">${PLUGIN_PREFIX}</span>Resume();&quot;</span> <span style="color: #197d8b;">)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl><br /><br />\src\host-modules\aku_modules.cpp<br /><br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=23&amp;t=3035&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="cpp" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">void</span> AKUModulesPause <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">:</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339900;">#if AKU_WITH_PLUGINS</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AKUPluginsPause<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339900;">#endif</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">void</span> AKUModulesResume <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">:</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339900;">#if AKU_WITH_PLUGINS</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AKUPluginsResume<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #339900;">#endif</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl><br /><br /><br />\src\moai-plugins\host.cpp.in<br /><br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=23&amp;t=3035&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="cpp" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">void</span> AKUPluginsPause <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; @PLUGIN_PAUSE@</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #008000;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">void</span> AKUPluginsResume <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; @PLUGIN_RESUME@</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #008000;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl><br /><br /><br />\src\moai-plugins\host.h<br /><br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=23&amp;t=3035&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="cpp" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">AKU_API <span style="color: #0000ff;">void</span>&nbsp; &nbsp; AKUPluginsPause<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">AKU_API <span style="color: #0000ff;">void</span>&nbsp; &nbsp; AKUPluginsResume<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl></div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: FMOD Plugin battery draining? FIXED!</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Wed Jan 28, 2015 8:09 am</strong></div>
				<div class="author">by <strong>ibisum</strong></div>
				<div class="content">Come on guys, submit a pull request already.  Posting these fixes to the forum means they get swallowed up and forgotten about forever .. or at least, until someone else runs into the same bug and neglects to search for posts in the forum that might fix it.  This seems to be a continuing occurrence with bugs found .. please, I implore you, send pull requests so these fixes get in the right place!</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: FMOD Plugin battery draining? FIXED!</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Wed Jan 28, 2015 1:06 pm</strong></div>
				<div class="author">by <strong>JKON</strong></div>
				<div class="content"><blockquote><div><cite>ibisum wrote:</cite>Come on guys, submit a pull request already.  Posting these fixes to the forum means they get swallowed up and forgotten about forever .. or at least, until someone else runs into the same bug and neglects to search for posts in the forum that might fix it.  This seems to be a continuing occurrence with bugs found .. please, I implore you, send pull requests so these fixes get in the right place!</div></blockquote><br /><br />We're using bitbucket at the moment, not sure what is the easiest way to create a pull request from our fix. I'll try creating branch in GitHub later when I get proper internet connection. I have 1 megabit connection and I've had already 4 power cuts today <img src="images/smilies/icon_razz.gif" alt=":P" title="Razz" /><br /><br />// JKON</div>
			</div>
			<hr />
		
	</div>

	<div id="page-footer">
		<div class="page-number">All times are UTC <br />Page <strong>1</strong> of <strong>1</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</div>
	</div>
</div>

</body>
</html>