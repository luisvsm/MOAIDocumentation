<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="feed.php.html" />

<title>Moai Forum</title>
<subtitle>The mobile platform for pro game developers</subtitle>
<link href="http://192.168.20.226:3000/forums/index.php" />
<updated>2018-04-18T08:10:24+00:00</updated>

<author><name><![CDATA[Moai Forum]]></name></author>
<id>/forums/feed.php</id>
<entry>
<author><name><![CDATA[lindseynicole010]]></name></author>
<updated>2018-04-18T08:10:24+00:00</updated>
<published>2018-04-18T08:10:24+00:00</published>
<id>/forums/viewtopic.php?t=3059&amp;p=18451#p18451</id>
<link href="http://192.168.20.226:3000/forums/viewtopic.php?t=3059&amp;p=18451#p18451"/>
<title type="html"><![CDATA[Off Topic • Re: React - how do you guys feel?]]></title>

<category term="Off Topic" scheme="/forums/viewforum.php?f=27" label="Off Topic"/>
<content type="html" xml:base="/forums/viewtopic.php?t=3059&amp;p=18451#p18451"><![CDATA[
With propelling innovation, these little security gadgets have turned out to be modest and generally accessible to buyers for use in an assortment of circumstances. A claim to fame home surveillance camera is commonly very minor and might be connected to a screen with remote innovation. Because of the constant headways in innovation, the expenses of a wide range of reconnaissance cameras appear to dropping all the time. Divider tickers, stereo speakers and smoke indicators would all be able to house small shrouded observation cameras. There are numerous sorts of reconnaissance cameras, for example, vault cameras, shrouded cameras, smoke identifying cameras, and &quot;brilliant&quot; cameras that are furnished with movement finders. A buy of a computerized video recorder or home surveillance camera framework can be to a great degree troublesome with all the government operative cameras and determinations for reconnaissance cameras accessible nowadays. When you search for a reconnaissance framework for home utilize, search for a framework that incorporates such rewards as clocks for your lights and movement sensors to run with the remote camera, a manual for video observation gear, CCTV cameras and remote security frameworks for home and business. Alongside surveillance cameras and gadgets to view and record camera pictures, different bits of reconnaissance gear might be important to finish a video security service.<br />Thanks&amp; regards,<br />Lindsey Nicole<br /><a href="http://www.viewtech.ca/" class="postlink">Security Cameras Toronto</a> | <a href="http://www.viewtech.ca/" class="postlink">Security Cameras Vancouver</a><p>Statistics: Posted by <a href="http://192.168.20.226:3000/forums/memberlist.php?mode=viewprofile&amp;u=2318">lindseynicole010</a> — Wed Apr 18, 2018 8:10 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[lindseynicole010]]></name></author>
<updated>2018-04-14T09:24:33+00:00</updated>
<published>2018-04-14T09:24:33+00:00</published>
<id>/forums/viewtopic.php?t=3123&amp;p=18450#p18450</id>
<link href="http://192.168.20.226:3000/forums/viewtopic.php?t=3123&amp;p=18450#p18450"/>
<title type="html"><![CDATA[Off Topic • Re: Intro:-):-)]]></title>

<category term="Off Topic" scheme="/forums/viewforum.php?f=27" label="Off Topic"/>
<content type="html" xml:base="/forums/viewtopic.php?t=3123&amp;p=18450#p18450"><![CDATA[
Another enormous advantage of surveillance cameras is that it can help in enhancing the efficiency of your representatives. A noteworthy worry with numerous directors is to guarantee that all representatives are working legitimately all through their day of work and not squandering their opportunity or enjoying other non-beneficial exercises like talking with others, taking continuous breaks, browsing their messages or Facebook refreshes and so forth. When you have legitimate video observation set up, representatives will have no other alternative to however work earnestly on the undertakings alloted to them. This can dramatically affect the organization's primary concern.<br />Thanks&amp; regards,<br />Lindsey Nicole<br /><a href="http://www.viewtech.ca/" class="postlink">Security Cameras Toronto</a> | <a href="http://www.viewtech.ca/" class="postlink">Security Cameras Vancouver</a><p>Statistics: Posted by <a href="http://192.168.20.226:3000/forums/memberlist.php?mode=viewprofile&amp;u=2318">lindseynicole010</a> — Sat Apr 14, 2018 9:24 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[BacioiuC]]></name></author>
<updated>2018-04-10T13:16:11+00:00</updated>
<published>2018-04-10T13:16:11+00:00</published>
<id>/forums/viewtopic.php?t=3345&amp;p=18449#p18449</id>
<link href="http://192.168.20.226:3000/forums/viewtopic.php?t=3345&amp;p=18449#p18449"/>
<title type="html"><![CDATA[Android • Re: Android status and stable version to build for android?]]></title>

<category term="Android" scheme="/forums/viewforum.php?f=17" label="Android"/>
<content type="html" xml:base="/forums/viewtopic.php?t=3345&amp;p=18449#p18449"><![CDATA[
It seems that libmoai is not included in the final apk! <br /><br /><dl class="codebox"><dt>Code: </dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">java<span style="color: #66cc66;">.</span>lang<span style="color: #66cc66;">.</span>UnsatisfiedLinkError<span style="color: #66cc66;">:</span> Couldn<span style="color: #ff6666;">'t load moai from loader dalvik.system.PathClassLoader[DexPathList[[zip file &quot;/data/app/com.example.anonymousmoaidev.moaiproj-2.apk&quot;],nativeLibraryDirectories=[/data/app-lib/com.example.anonymousmoaidev.moaiproj-2, /system/lib, /system/lib/arm, /data/downloads]]]: findLibrary returned null</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /></ol></code></dd></dl><p>Statistics: Posted by <a href="http://192.168.20.226:3000/forums/memberlist.php?mode=viewprofile&amp;u=1392">BacioiuC</a> — Tue Apr 10, 2018 1:16 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[BacioiuC]]></name></author>
<updated>2018-04-09T21:23:27+00:00</updated>
<published>2018-04-09T21:23:27+00:00</published>
<id>/forums/viewtopic.php?t=3345&amp;p=18448#p18448</id>
<link href="http://192.168.20.226:3000/forums/viewtopic.php?t=3345&amp;p=18448#p18448"/>
<title type="html"><![CDATA[Android • Re: Android status and stable version to build for android?]]></title>

<category term="Android" scheme="/forums/viewforum.php?f=17" label="Android"/>
<content type="html" xml:base="/forums/viewtopic.php?t=3345&amp;p=18448#p18448"><![CDATA[
Hey guys,<br /><br />I had some free time this weekend so I've setup an android build for ESH. Building went fine and a debug and debug-unaligned apk is generated under the project folder in host/android/moai/output/apk. The built apk crashes under Moto G4 (android 7), Huawei M3 (Android 7) and the current Chrome OS Android Ark version.<br /><br />Tried adb logcat and it said the apk crashed after loading libmoai.so. <br /><br />Following the guide halfnelson posted here: <!-- m --><a class="postlink" href="https://github.com/moai/moai-community/wiki/Building-MOAI-on-Ubuntu-16.04">https://github.com/moai/moai-community/ ... untu-16.04</a><!-- m --><br /><br />I tried changing the sdkmanager target api to lower version (went down from 26 to 17) with no luck. Note that I also tried the default moai sample when the host is created and I get the same crash. Also note that the Linux build works fine!<br /><br />Anything I could be doing wrong?<p>Statistics: Posted by <a href="http://192.168.20.226:3000/forums/memberlist.php?mode=viewprofile&amp;u=1392">BacioiuC</a> — Mon Apr 09, 2018 9:23 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[naturally]]></name></author>
<updated>2018-03-09T02:54:03+00:00</updated>
<published>2018-03-09T02:54:03+00:00</published>
<id>/forums/viewtopic.php?t=2933&amp;p=18442#p18442</id>
<link href="http://192.168.20.226:3000/forums/viewtopic.php?t=2933&amp;p=18442#p18442"/>
<title type="html"><![CDATA[Made With Moai • Re: Don't Be Patchman: A Sneak-and-Grow Adventure]]></title>

<category term="Made With Moai" scheme="/forums/viewforum.php?f=6" label="Made With Moai"/>
<content type="html" xml:base="/forums/viewtopic.php?t=2933&amp;p=18442#p18442"><![CDATA[
Another Kickstarter is live for our second episode!<br /><br /><!-- m --><a class="postlink" href="https://www.kickstarter.com/projects/naturally/patchman-vs-blue-squares">https://www.kickstarter.com/projects/na ... ue-squares</a><!-- m --><br /><br /><img src="images/smilies/icon_e_geek.gif" alt=":geek:" title="Geek" /><p>Statistics: Posted by <a href="http://192.168.20.226:3000/forums/memberlist.php?mode=viewprofile&amp;u=1551">naturally</a> — Fri Mar 09, 2018 2:54 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Galdred]]></name></author>
<updated>2018-03-08T23:24:00+00:00</updated>
<published>2018-03-08T23:24:00+00:00</published>
<id>/forums/viewtopic.php?t=3383&amp;p=18441#p18441</id>
<link href="http://192.168.20.226:3000/forums/viewtopic.php?t=3383&amp;p=18441#p18441"/>
<title type="html"><![CDATA[Game Development • Re: Sprite outline shader]]></title>

<category term="Game Development" scheme="/forums/viewforum.php?f=16" label="Game Development"/>
<content type="html" xml:base="/forums/viewtopic.php?t=3383&amp;p=18441#p18441"><![CDATA[
I forgot to post the result, after having made the color variant:<br /><img src="https://i.imgur.com/5mWv1Hj.png" alt="Image" /><p>Statistics: Posted by <a href="http://192.168.20.226:3000/forums/memberlist.php?mode=viewprofile&amp;u=1454">Galdred</a> — Thu Mar 08, 2018 11:24 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Galdred]]></name></author>
<updated>2018-03-03T10:55:49+00:00</updated>
<published>2018-03-03T10:55:49+00:00</published>
<id>/forums/viewtopic.php?t=2974&amp;p=18440#p18440</id>
<link href="http://192.168.20.226:3000/forums/viewtopic.php?t=2974&amp;p=18440#p18440"/>
<title type="html"><![CDATA[Re: New Account Registrations]]></title>

<content type="html" xml:base="/forums/viewtopic.php?t=2974&amp;p=18440#p18440"><![CDATA[
Actually, bots usually post random nonsensical comments...<p>Statistics: Posted by <a href="http://192.168.20.226:3000/forums/memberlist.php?mode=viewprofile&amp;u=1454">Galdred</a> — Sat Mar 03, 2018 10:55 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Galdred]]></name></author>
<updated>2018-03-03T10:53:29+00:00</updated>
<published>2018-03-03T10:53:29+00:00</published>
<id>/forums/viewtopic.php?t=3383&amp;p=18439#p18439</id>
<link href="http://192.168.20.226:3000/forums/viewtopic.php?t=3383&amp;p=18439#p18439"/>
<title type="html"><![CDATA[Game Development • Re: Sprite outline shader]]></title>

<category term="Game Development" scheme="/forums/viewforum.php?f=16" label="Game Development"/>
<content type="html" xml:base="/forums/viewtopic.php?t=3383&amp;p=18439#p18439"><![CDATA[
Actually, I had written a tool to generate an outline for each sprite on a sprite sheet before going the shader route.<br />I just felt too lazy generating the outlines for all the spritesheet, then generating the texturepacker files.<br />It should be even faster as it is done before runtime. <br /><br /><dl class="codebox"><dt>Code: </dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- In order to create the sprite outlines, the ways to do that would be:</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- - Either to do it dynamically, with a shader on the selected sprite elements</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- (add selected frameLayers duplicating each frameLayer with a lower priority)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- - Either create a spritesheet with the outline</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">--</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- This program follows the second road :</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> M <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> gd <span style="color: #66cc66;">=</span> <span style="color: #0000aa;">require</span> <span style="color: #ff6666;">&quot;gd&quot;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> lfs <span style="color: #66cc66;">=</span> <span style="color: #0000aa;">require</span> <span style="color: #ff6666;">&quot;lfs&quot;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> M<span style="color: #66cc66;">.</span>outline<span style="color: #66cc66;">&#40;</span>im_name<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">if</span> <span style="color: #aa9900; font-weight: bold;">not</span> <span style="color: #0000aa;">string.find</span><span style="color: #66cc66;">&#40;</span>im_name<span style="color: #66cc66;">,</span> <span style="color: #ff6666;">&quot;.png&quot;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #aa9900; font-weight: bold;">then</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;incorrect file extension, .png required&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #aa9900; font-weight: bold;">return</span> <span style="color: #aa9900;">false</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> im <span style="color: #66cc66;">=</span> gd<span style="color: #66cc66;">.</span>createFromPng<span style="color: #66cc66;">&#40;</span>im_name<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> xSz<span style="color: #66cc66;">,</span> ySz <span style="color: #66cc66;">=</span> im<span style="color: #66cc66;">:</span>sizeXY<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span>xSz<span style="color: #66cc66;">,</span> ySz<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> new_filename <span style="color: #66cc66;">=</span> <span style="color: #0000aa;">string.gsub</span><span style="color: #66cc66;">&#40;</span>im_name<span style="color: #66cc66;">,</span> <span style="color: #ff6666;">&quot;.png&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #ff6666;">&quot;_outline.png&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> im2 <span style="color: #66cc66;">=</span> gd<span style="color: #66cc66;">.</span>createPalette<span style="color: #66cc66;">&#40;</span>xSz<span style="color: #66cc66;">,</span> ySz<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> col1 <span style="color: #66cc66;">=</span> im2<span style="color: #66cc66;">:</span>colorAllocateAlpha<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">255</span><span style="color: #66cc66;">,</span><span style="color: #cc66cc;">255</span><span style="color: #66cc66;">,</span><span style="color: #cc66cc;">255</span><span style="color: #66cc66;">,</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> col2 <span style="color: #66cc66;">=</span> im2<span style="color: #66cc66;">:</span>colorAllocateAlpha<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">,</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">,</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">,</span><span style="color: #cc66cc;">110</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">for</span> y<span style="color: #66cc66;">=</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">,</span> ySz<span style="color: #66cc66;">-</span><span style="color: #cc66cc;">1</span> <span style="color: #aa9900; font-weight: bold;">do</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #aa9900; font-weight: bold;">for</span> x<span style="color: #66cc66;">=</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">,</span> xSz<span style="color: #66cc66;">-</span><span style="color: #cc66cc;">1</span> <span style="color: #aa9900; font-weight: bold;">do</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      <span style="color: #aa9900; font-weight: bold;">local</span> c <span style="color: #66cc66;">=</span> im<span style="color: #66cc66;">:</span>getPixel<span style="color: #66cc66;">&#40;</span>x<span style="color: #66cc66;">,</span>y<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      <span style="color: #aa9900; font-weight: bold;">if</span> im<span style="color: #66cc66;">:</span>alpha<span style="color: #66cc66;">&#40;</span>c<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">~=</span> <span style="color: #cc66cc;">0</span> <span style="color: #aa9900; font-weight: bold;">then</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #aa9900; font-weight: bold;">local</span> border <span style="color: #66cc66;">=</span> <span style="color: #aa9900;">false</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #aa9900; font-weight: bold;">for</span> i <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">-</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">,</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">,</span><span style="color: #cc66cc;">2</span> <span style="color: #aa9900; font-weight: bold;">do</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">          <span style="color: #aa9900; font-weight: bold;">local</span> x1 <span style="color: #66cc66;">=</span> x<span style="color: #66cc66;">+</span>i</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">          <span style="color: #aa9900; font-weight: bold;">local</span> y1 <span style="color: #66cc66;">=</span> y</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">          <span style="color: #aa9900; font-weight: bold;">if</span> x1<span style="color: #66cc66;">&gt;=</span><span style="color: #cc66cc;">0</span> <span style="color: #aa9900; font-weight: bold;">and</span> x1<span style="color: #66cc66;">&lt;</span>xSz <span style="color: #aa9900; font-weight: bold;">and</span> y1<span style="color: #66cc66;">&gt;=</span><span style="color: #cc66cc;">0</span> <span style="color: #aa9900; font-weight: bold;">and</span> y1<span style="color: #66cc66;">&lt;</span>ySz <span style="color: #aa9900; font-weight: bold;">then</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">            <span style="color: #aa9900; font-weight: bold;">local</span> c2 <span style="color: #66cc66;">=</span>  im<span style="color: #66cc66;">:</span>getPixel<span style="color: #66cc66;">&#40;</span>x1<span style="color: #66cc66;">,</span>y1<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">            <span style="color: #aa9900; font-weight: bold;">if</span> im<span style="color: #66cc66;">:</span>alpha<span style="color: #66cc66;">&#40;</span>c2<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">==</span><span style="color: #cc66cc;">0</span> <span style="color: #aa9900; font-weight: bold;">then</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">              border <span style="color: #66cc66;">=</span> <span style="color: #aa9900;">true</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">            <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">          <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #aa9900; font-weight: bold;">for</span> j <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">-</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">,</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">,</span><span style="color: #cc66cc;">2</span> <span style="color: #aa9900; font-weight: bold;">do</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">          <span style="color: #aa9900; font-weight: bold;">local</span> x1 <span style="color: #66cc66;">=</span> x</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">          <span style="color: #aa9900; font-weight: bold;">local</span> y1 <span style="color: #66cc66;">=</span> y<span style="color: #66cc66;">+</span>j</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">          <span style="color: #aa9900; font-weight: bold;">if</span> x1<span style="color: #66cc66;">&gt;=</span><span style="color: #cc66cc;">0</span> <span style="color: #aa9900; font-weight: bold;">and</span> x1<span style="color: #66cc66;">&lt;</span>xSz <span style="color: #aa9900; font-weight: bold;">and</span> y1<span style="color: #66cc66;">&gt;=</span><span style="color: #cc66cc;">0</span> <span style="color: #aa9900; font-weight: bold;">and</span> y1<span style="color: #66cc66;">&lt;</span>ySz <span style="color: #aa9900; font-weight: bold;">then</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">            <span style="color: #aa9900; font-weight: bold;">local</span> c2 <span style="color: #66cc66;">=</span>  im<span style="color: #66cc66;">:</span>getPixel<span style="color: #66cc66;">&#40;</span>x1<span style="color: #66cc66;">,</span>y1<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">            <span style="color: #aa9900; font-weight: bold;">if</span> im<span style="color: #66cc66;">:</span>alpha<span style="color: #66cc66;">&#40;</span>c2<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">==</span><span style="color: #cc66cc;">0</span> <span style="color: #aa9900; font-weight: bold;">then</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">              border <span style="color: #66cc66;">=</span> <span style="color: #aa9900;">true</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">            <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">          <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #aa9900; font-weight: bold;">if</span> border <span style="color: #aa9900; font-weight: bold;">then</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">          im2<span style="color: #66cc66;">:</span>setPixel<span style="color: #66cc66;">&#40;</span>x<span style="color: #66cc66;">,</span>y<span style="color: #66cc66;">,</span> col1<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #aa9900; font-weight: bold;">else</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">          im2<span style="color: #66cc66;">:</span>setPixel<span style="color: #66cc66;">&#40;</span>x<span style="color: #66cc66;">,</span>y<span style="color: #66cc66;">,</span>col2<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      <span style="color: #aa9900; font-weight: bold;">else</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        im2<span style="color: #66cc66;">:</span>setPixel<span style="color: #66cc66;">&#40;</span>x<span style="color: #66cc66;">,</span>y<span style="color: #66cc66;">,</span>col1<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  im2<span style="color: #66cc66;">:</span>png<span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;outline/&quot;</span><span style="color: #66cc66;">..</span>new_filename<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> M<span style="color: #66cc66;">.</span>outline_all<span style="color: #66cc66;">&#40;</span>dir<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">if</span> dir <span style="color: #aa9900; font-weight: bold;">then</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    lfs<span style="color: #66cc66;">.</span>chdir<span style="color: #66cc66;">&#40;</span>dir<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  lfs<span style="color: #66cc66;">.</span>mkdir<span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;outline&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">for</span> fileName<span style="color: #66cc66;">,</span> ob <span style="color: #aa9900; font-weight: bold;">in</span> lfs<span style="color: #66cc66;">.</span>dir<span style="color: #66cc66;">&#40;</span>lfs<span style="color: #66cc66;">.</span>currentdir<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #aa9900; font-weight: bold;">do</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    M<span style="color: #66cc66;">.</span>outline<span style="color: #66cc66;">&#40;</span>fileName<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">--M.outline_all(&quot;sprites&quot;)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">return</span> M</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /></ol></code></dd></dl><br /><br />To use, either create a sprite folder spriteFolder with everything you want to outline and call outline_all(&quot;spriteFolder&quot;), or call outline for a specific file.<br /><br />Disclaimer : This program is distributed as is. Use at your own risk. I am not accountable for any permanet damage caused to your files or hardware  <img src="images/smilies/icon_e_biggrin.gif" alt=":D" title="Very Happy" /><p>Statistics: Posted by <a href="http://192.168.20.226:3000/forums/memberlist.php?mode=viewprofile&amp;u=1454">Galdred</a> — Sat Mar 03, 2018 10:53 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[naturally]]></name></author>
<updated>2018-03-03T02:13:54+00:00</updated>
<published>2018-03-03T02:13:54+00:00</published>
<id>/forums/viewtopic.php?t=3383&amp;p=18438#p18438</id>
<link href="http://192.168.20.226:3000/forums/viewtopic.php?t=3383&amp;p=18438#p18438"/>
<title type="html"><![CDATA[Game Development • Re: Sprite outline shader]]></title>

<category term="Game Development" scheme="/forums/viewforum.php?f=16" label="Game Development"/>
<content type="html" xml:base="/forums/viewtopic.php?t=3383&amp;p=18438#p18438"><![CDATA[
Great contribution!  Thanks G<br /><br />I had another idea, to do it by calculating the texture outline with MOAIImage (and cache the results) then use MOAIScriptDeck + MOAIDraw to draw the outline.  Possibly faster than a shader, but more work.  Only mentioning this for the heck of it  <img src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /><p>Statistics: Posted by <a href="http://192.168.20.226:3000/forums/memberlist.php?mode=viewprofile&amp;u=1551">naturally</a> — Sat Mar 03, 2018 2:13 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Galdred]]></name></author>
<updated>2018-03-02T20:49:39+00:00</updated>
<published>2018-03-02T20:49:39+00:00</published>
<id>/forums/viewtopic.php?t=3383&amp;p=18437#p18437</id>
<link href="http://192.168.20.226:3000/forums/viewtopic.php?t=3383&amp;p=18437#p18437"/>
<title type="html"><![CDATA[Game Development • Re: Sprite outline shader]]></title>

<category term="Game Development" scheme="/forums/viewforum.php?f=16" label="Game Development"/>
<content type="html" xml:base="/forums/viewtopic.php?t=3383&amp;p=18437#p18437"><![CDATA[
The code was written for moai 1.75<p>Statistics: Posted by <a href="http://192.168.20.226:3000/forums/memberlist.php?mode=viewprofile&amp;u=1454">Galdred</a> — Fri Mar 02, 2018 8:49 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ibisum]]></name></author>
<updated>2018-03-02T18:05:04+00:00</updated>
<published>2018-03-02T18:05:04+00:00</published>
<id>/forums/viewtopic.php?t=3383&amp;p=18436#p18436</id>
<link href="http://192.168.20.226:3000/forums/viewtopic.php?t=3383&amp;p=18436#p18436"/>
<title type="html"><![CDATA[Game Development • Re: Sprite outline shader]]></title>

<category term="Game Development" scheme="/forums/viewforum.php?f=16" label="Game Development"/>
<content type="html" xml:base="/forums/viewtopic.php?t=3383&amp;p=18436#p18436"><![CDATA[
Nice!  Which version of MOAI is the demo code for?<p>Statistics: Posted by <a href="http://192.168.20.226:3000/forums/memberlist.php?mode=viewprofile&amp;u=262">ibisum</a> — Fri Mar 02, 2018 6:05 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Galdred]]></name></author>
<updated>2018-03-08T23:31:00+00:00</updated>
<published>2018-03-02T15:20:46+00:00</published>
<id>/forums/viewtopic.php?t=3383&amp;p=18435#p18435</id>
<link href="http://192.168.20.226:3000/forums/viewtopic.php?t=3383&amp;p=18435#p18435"/>
<title type="html"><![CDATA[Game Development • Sprite outline shader]]></title>

<category term="Game Development" scheme="/forums/viewforum.php?f=16" label="Game Development"/>
<content type="html" xml:base="/forums/viewtopic.php?t=3383&amp;p=18435#p18435"><![CDATA[
As discussed on slack, there are basically 2 ways to outline sprites:<br />The first one is to create an outline texture for each sprite or spritesheet.<br />It is a bit cumbersome, but it is faster (that said, sprite outline is seldom something you need very high performance for).<br />The second one is to use shader.<br /><br />I took inspiration from <a href="http://blogs.love2d.org/content/let-it-glow-dynamically-adding-outlines-characters#theory" class="postlink">here</a>.<br /><br />The following uses moai 1.75<br />So here is the vertex shader, outline.vsh:<br /><br /><dl class="codebox"><dt>Code: </dt><dd><code style="line-height: 30%;"><ol class="glsl" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #333399; font-weight: bold;">attribute</span> <span style="color: #000066; font-weight: bold;">vec4</span> position<span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #333399; font-weight: bold;">attribute</span> <span style="color: #000066; font-weight: bold;">vec2</span> uv<span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #333399; font-weight: bold;">attribute</span> <span style="color: #000066; font-weight: bold;">vec4</span> color<span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #333399; font-weight: bold;">varying</span> <span style="color: #000066; font-weight: bold;">vec2</span> uvVarying<span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #000066; font-weight: bold;">void</span> main <span style="color: #000066;">&#40;</span><span style="color: #000066;">&#41;</span> <span style="color: #000066;">&#123;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #551111;">gl_Position</span> <span style="color: #000066;">=</span> position<span style="color: #000066;">;</span> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  uvVarying <span style="color: #000066;">=</span> uv<span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #000066;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /></ol></code></dd></dl><br /><br />It basically only transfer the uv coordinates to the fragment shader.<br /><br />and now the fragment shader, outline.fsh:<br /><br /><br /><dl class="codebox"><dt>Code: </dt><dd><code style="line-height: 30%;"><ol class="glsl" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #333399; font-weight: bold;">uniform</span> <span style="color: #000066; font-weight: bold;">float</span> stepX<span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #333399; font-weight: bold;">uniform</span> <span style="color: #000066; font-weight: bold;">float</span> stepY<span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #333399; font-weight: bold;">uniform</span> <span style="color: #000066; font-weight: bold;">float</span> r<span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #333399; font-weight: bold;">uniform</span> <span style="color: #000066; font-weight: bold;">float</span> g<span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #333399; font-weight: bold;">uniform</span> <span style="color: #000066; font-weight: bold;">float</span> b<span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #666666; font-style: italic;">// We will retrieve the texture from whatever prop the shader is attached to. No need to feed it in the code.</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #333399; font-weight: bold;">uniform</span> <span style="color: #000066; font-weight: bold;">sampler2D</span> texture<span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #333399; font-weight: bold;">varying</span> <span style="color: #000066; font-weight: bold;">vec2</span> uvVarying<span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #000066; font-weight: bold;">void</span> main<span style="color: #000066;">&#40;</span><span style="color: #000066;">&#41;</span> <span style="color: #000066;">&#123;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #666666; font-style: italic;">// alpha will be the value we compute for each fragment</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #000066; font-weight: bold;">float</span> alpha<span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #666666; font-style: italic;">// we recover texture position from the vertex shader</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #000066; font-weight: bold;">vec2</span> texturePos <span style="color: #000066;">=</span> uvVarying<span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #666666; font-style: italic;">// we want the pixel to be drawn if its alpha value is different from one of the neighboring ones, so we sum:</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #666666; font-style: italic;">// texture2D( texture, texturePos ).a-texture2D( texture, texturePos + vec2( i, j ) ).a ;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #666666; font-style: italic;">// for i,j in [-1,1], excluding (0,0)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #666666; font-style: italic;">// summing the absolute values would be more accurate if alpha is not always 1 or 0</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    alpha <span style="color: #000066;">=</span> <span style="color: #0000ff;">8</span><span style="color: #000066;">*</span><span style="color: #993333; font-weight: bold;">texture2D</span><span style="color: #000066;">&#40;</span> texture<span style="color: #000066;">,</span> texturePos <span style="color: #000066;">&#41;</span><span style="color: #000066;">.</span><span style="color: #006600;">a</span><span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    alpha <span style="color: #000066;">-=</span> <span style="color: #993333; font-weight: bold;">texture2D</span><span style="color: #000066;">&#40;</span> texture<span style="color: #000066;">,</span> texturePos <span style="color: #000066;">+</span> <span style="color: #000066; font-weight: bold;">vec2</span><span style="color: #000066;">&#40;</span> stepX<span style="color: #000066;">,</span> <span style="color: #0000ff;">0.0</span> <span style="color: #000066;">&#41;</span> <span style="color: #000066;">&#41;</span><span style="color: #000066;">.</span><span style="color: #006600;">a</span><span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    alpha <span style="color: #000066;">-=</span> <span style="color: #993333; font-weight: bold;">texture2D</span><span style="color: #000066;">&#40;</span> texture<span style="color: #000066;">,</span> texturePos <span style="color: #000066;">+</span> <span style="color: #000066; font-weight: bold;">vec2</span><span style="color: #000066;">&#40;</span> <span style="color: #000066;">-</span>stepX<span style="color: #000066;">,</span> <span style="color: #0000ff;">0.0</span> <span style="color: #000066;">&#41;</span> <span style="color: #000066;">&#41;</span><span style="color: #000066;">.</span><span style="color: #006600;">a</span><span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    alpha <span style="color: #000066;">-=</span> <span style="color: #993333; font-weight: bold;">texture2D</span><span style="color: #000066;">&#40;</span> texture<span style="color: #000066;">,</span> texturePos <span style="color: #000066;">+</span> <span style="color: #000066; font-weight: bold;">vec2</span><span style="color: #000066;">&#40;</span> <span style="color: #0000ff;">0.0</span><span style="color: #000066;">,</span> stepY <span style="color: #000066;">&#41;</span> <span style="color: #000066;">&#41;</span><span style="color: #000066;">.</span><span style="color: #006600;">a</span><span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    alpha <span style="color: #000066;">-=</span> <span style="color: #993333; font-weight: bold;">texture2D</span><span style="color: #000066;">&#40;</span> texture<span style="color: #000066;">,</span> texturePos <span style="color: #000066;">+</span> <span style="color: #000066; font-weight: bold;">vec2</span><span style="color: #000066;">&#40;</span> <span style="color: #0000ff;">0.0</span><span style="color: #000066;">,</span> <span style="color: #000066;">-</span>stepY <span style="color: #000066;">&#41;</span> <span style="color: #000066;">&#41;</span><span style="color: #000066;">.</span><span style="color: #006600;">a</span><span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    alpha <span style="color: #000066;">-=</span> <span style="color: #993333; font-weight: bold;">texture2D</span><span style="color: #000066;">&#40;</span> texture<span style="color: #000066;">,</span> texturePos <span style="color: #000066;">+</span> <span style="color: #000066; font-weight: bold;">vec2</span><span style="color: #000066;">&#40;</span> stepX<span style="color: #000066;">,</span> stepY <span style="color: #000066;">&#41;</span> <span style="color: #000066;">&#41;</span><span style="color: #000066;">.</span><span style="color: #006600;">a</span><span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    alpha <span style="color: #000066;">-=</span> <span style="color: #993333; font-weight: bold;">texture2D</span><span style="color: #000066;">&#40;</span> texture<span style="color: #000066;">,</span> texturePos <span style="color: #000066;">+</span> <span style="color: #000066; font-weight: bold;">vec2</span><span style="color: #000066;">&#40;</span> stepX<span style="color: #000066;">,</span> <span style="color: #000066;">-</span>stepY <span style="color: #000066;">&#41;</span> <span style="color: #000066;">&#41;</span><span style="color: #000066;">.</span><span style="color: #006600;">a</span><span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    alpha <span style="color: #000066;">-=</span> <span style="color: #993333; font-weight: bold;">texture2D</span><span style="color: #000066;">&#40;</span> texture<span style="color: #000066;">,</span> texturePos <span style="color: #000066;">+</span> <span style="color: #000066; font-weight: bold;">vec2</span><span style="color: #000066;">&#40;</span> <span style="color: #000066;">-</span>stepX<span style="color: #000066;">,</span> stepY <span style="color: #000066;">&#41;</span> <span style="color: #000066;">&#41;</span><span style="color: #000066;">.</span><span style="color: #006600;">a</span><span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    alpha <span style="color: #000066;">-=</span> <span style="color: #993333; font-weight: bold;">texture2D</span><span style="color: #000066;">&#40;</span> texture<span style="color: #000066;">,</span> texturePos <span style="color: #000066;">+</span> <span style="color: #000066; font-weight: bold;">vec2</span><span style="color: #000066;">&#40;</span> <span style="color: #000066;">-</span>stepX<span style="color: #000066;">,</span> <span style="color: #000066;">-</span>stepY <span style="color: #000066;">&#41;</span> <span style="color: #000066;">&#41;</span><span style="color: #000066;">.</span><span style="color: #006600;">a</span><span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #666666; font-style: italic;">// we want the pixel to be displayed only if it was transparent in the first place, so we take the opposite of alpha,</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #666666; font-style: italic;">// otherwise, we would get the inner outline (the line of outline pixels that are on the sprite, while we want the </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #666666; font-style: italic;">// pixels around).</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    alpha <span style="color: #000066;">=</span> <span style="color: #000066;">-</span>alpha<span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #551111;">gl_FragColor</span> <span style="color: #000066;">=</span> <span style="color: #000066; font-weight: bold;">vec4</span><span style="color: #000066;">&#40;</span> r<span style="color: #000066;">,</span> g<span style="color: #000066;">,</span> b<span style="color: #000066;">,</span> alpha<span style="color: #000066;">&#41;</span><span style="color: #000066;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #000066;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /></ol></code></dd></dl><br /><br />And the lua code, main.lua:<br /><dl class="codebox"><dt>Code: </dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- moai 1.75</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> init</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> initShader</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- init the shader program</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> initShader<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> shaderProgram <span style="color: #66cc66;">=</span> MOAIShaderProgram<span style="color: #66cc66;">.</span>new<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #808080; font-style: italic;">-- transmits vertex attribute values to shader program</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shaderProgram<span style="color: #66cc66;">:</span>setVertexAttribute <span style="color: #66cc66;">&#40;</span> <span style="color: #cc66cc;">1</span><span style="color: #66cc66;">,</span> <span style="color: #ff6666;">'position'</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shaderProgram<span style="color: #66cc66;">:</span>setVertexAttribute <span style="color: #66cc66;">&#40;</span> <span style="color: #cc66cc;">2</span><span style="color: #66cc66;">,</span> <span style="color: #ff6666;">'uv'</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shaderProgram<span style="color: #66cc66;">:</span>setVertexAttribute <span style="color: #66cc66;">&#40;</span> <span style="color: #cc66cc;">3</span><span style="color: #66cc66;">,</span> <span style="color: #ff6666;">'color'</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #808080; font-style: italic;">-- uniform float variable declaration</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shaderProgram<span style="color: #66cc66;">:</span>reserveUniforms<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">5</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- we associate an attibute index to each glsl variable</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shaderProgram<span style="color: #66cc66;">:</span>declareUniform<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">,</span><span style="color: #ff6666;">&quot;stepX&quot;</span><span style="color: #66cc66;">,</span>  MOAIShaderProgram<span style="color: #66cc66;">.</span>UNIFORM_FLOAT<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shaderProgram<span style="color: #66cc66;">:</span>declareUniform<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #66cc66;">,</span><span style="color: #ff6666;">&quot;stepY&quot;</span><span style="color: #66cc66;">,</span>  MOAIShaderProgram<span style="color: #66cc66;">.</span>UNIFORM_FLOAT<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shaderProgram<span style="color: #66cc66;">:</span>declareUniform<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">3</span><span style="color: #66cc66;">,</span><span style="color: #ff6666;">&quot;r&quot;</span><span style="color: #66cc66;">,</span>  MOAIShaderProgram<span style="color: #66cc66;">.</span>UNIFORM_FLOAT<span style="color: #66cc66;">&#41;</span>  </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shaderProgram<span style="color: #66cc66;">:</span>declareUniform<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">4</span><span style="color: #66cc66;">,</span><span style="color: #ff6666;">&quot;g&quot;</span><span style="color: #66cc66;">,</span>  MOAIShaderProgram<span style="color: #66cc66;">.</span>UNIFORM_FLOAT<span style="color: #66cc66;">&#41;</span>  </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shaderProgram<span style="color: #66cc66;">:</span>declareUniform<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">5</span><span style="color: #66cc66;">,</span><span style="color: #ff6666;">&quot;b&quot;</span><span style="color: #66cc66;">,</span>  MOAIShaderProgram<span style="color: #66cc66;">.</span>UNIFORM_FLOAT<span style="color: #66cc66;">&#41;</span>  </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #808080; font-style: italic;">-- Note that we have declared the variables, but not loaded the program yet</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">return</span> shaderProgram</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- width and height are the size of the sprite to outline</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> init<span style="color: #66cc66;">&#40;</span>width<span style="color: #66cc66;">,</span> height<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  width <span style="color: #66cc66;">=</span> width <span style="color: #aa9900; font-weight: bold;">or</span> <span style="color: #cc66cc;">128</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  height <span style="color: #66cc66;">=</span> height <span style="color: #aa9900; font-weight: bold;">or</span> <span style="color: #cc66cc;">128</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- we read and load both shader programs</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> file <span style="color: #66cc66;">=</span> <span style="color: #0000aa;">assert</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000aa;">io.open</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;outline.fsh&quot;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> file2 <span style="color: #66cc66;">=</span> <span style="color: #0000aa;">assert</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000aa;">io.open</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;outline.vsh&quot;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> fsh <span style="color: #66cc66;">=</span> file<span style="color: #66cc66;">:</span><span style="color: #0000aa;">read</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">'*all'</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> vsh <span style="color: #66cc66;">=</span> file2<span style="color: #66cc66;">:</span><span style="color: #0000aa;">read</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">'*all'</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  file<span style="color: #66cc66;">:</span>close<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  file2<span style="color: #66cc66;">:</span>close<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- the shader is the program instance</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> shader <span style="color: #66cc66;">=</span> MOAIShader<span style="color: #66cc66;">.</span>new<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> gfxQuad <span style="color: #66cc66;">=</span> MOAIGfxQuad2D<span style="color: #66cc66;">.</span>new <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  gfxQuad<span style="color: #66cc66;">:</span>setTexture <span style="color: #66cc66;">&#40;</span> <span style="color: #ff6666;">&quot;moai.png&quot;</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  gfxQuad<span style="color: #66cc66;">:</span>setRect <span style="color: #66cc66;">&#40;</span> <span style="color: #66cc66;">-</span>width<span style="color: #66cc66;">/</span><span style="color: #cc66cc;">2</span><span style="color: #66cc66;">,</span> <span style="color: #66cc66;">-</span>height<span style="color: #66cc66;">/</span><span style="color: #cc66cc;">2</span><span style="color: #66cc66;">,</span> width<span style="color: #66cc66;">/</span><span style="color: #cc66cc;">2</span><span style="color: #66cc66;">,</span> height<span style="color: #66cc66;">/</span><span style="color: #cc66cc;">2</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> prop <span style="color: #66cc66;">=</span> MOAIProp<span style="color: #66cc66;">.</span>new<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  prop<span style="color: #66cc66;">:</span>setDeck <span style="color: #66cc66;">&#40;</span> gfxQuad <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  prop<span style="color: #66cc66;">:</span>setLoc<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">,</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  layer<span style="color: #66cc66;">:</span>insertProp<span style="color: #66cc66;">&#40;</span>prop<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- we declare the variables for the shader program, and load the code that was in our string buffers.</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> shaderProgram <span style="color: #66cc66;">=</span> initShader<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shaderProgram<span style="color: #66cc66;">:</span>load<span style="color: #66cc66;">&#40;</span>vsh<span style="color: #66cc66;">,</span> fsh<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- We already declared the shader variables, and made the association between the attr id and the glsl variable names</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- We initialize the shaders with the shaderProgram, and pass the values</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shader<span style="color: #66cc66;">:</span>setProgram<span style="color: #66cc66;">&#40;</span>shaderProgram<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shader<span style="color: #66cc66;">:</span>setAttr<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">1.0</span><span style="color: #66cc66;">/</span>width<span style="color: #66cc66;">&#41;</span> <span style="color: #808080; font-style: italic;">--texture 1 pixel increment on x axis</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shader<span style="color: #66cc66;">:</span>setAttr<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">1.0</span><span style="color: #66cc66;">/</span>height<span style="color: #66cc66;">&#41;</span> <span style="color: #808080; font-style: italic;">-- texture 1 pixel increment on y axis</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shader<span style="color: #66cc66;">:</span>setAttr<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">3</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">1.0</span><span style="color: #66cc66;">&#41;</span> <span style="color: #808080; font-style: italic;">-- value for r</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shader<span style="color: #66cc66;">:</span>setAttr<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">4</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">0.0</span><span style="color: #66cc66;">&#41;</span> <span style="color: #808080; font-style: italic;">-- g</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  shader<span style="color: #66cc66;">:</span>setAttr<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">5</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">0.0</span><span style="color: #66cc66;">&#41;</span> <span style="color: #808080; font-style: italic;">-- b of the outline color</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  prop<span style="color: #66cc66;">:</span>setBlendMode<span style="color: #66cc66;">&#40;</span>MOAIProp2D<span style="color: #66cc66;">.</span>GL_SRC_ALPHA<span style="color: #66cc66;">,</span>MOAIProp2D<span style="color: #66cc66;">.</span>GL_ONE_MINUS_SRC_ALPHA<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  prop<span style="color: #66cc66;">:</span>setShader<span style="color: #66cc66;">&#40;</span>shader<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  prop<span style="color: #66cc66;">:</span>setVisible<span style="color: #66cc66;">&#40;</span><span style="color: #aa9900;">true</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #808080; font-style: italic;">-- we need to make a copy of the prop, that will be drawn without shader</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> prop2 <span style="color: #66cc66;">=</span> MOAIProp<span style="color: #66cc66;">.</span>new<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  prop2<span style="color: #66cc66;">:</span>setDeck <span style="color: #66cc66;">&#40;</span> gfxQuad <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  prop2<span style="color: #66cc66;">:</span>setLoc<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">,</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  layer<span style="color: #66cc66;">:</span>insertProp<span style="color: #66cc66;">&#40;</span>prop2<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  prop2<span style="color: #66cc66;">:</span>setVisible<span style="color: #66cc66;">&#40;</span><span style="color: #aa9900;">true</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">MOAISim<span style="color: #66cc66;">.</span>openWindow <span style="color: #66cc66;">&#40;</span> <span style="color: #ff6666;">&quot;test&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">640</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">480</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">viewport <span style="color: #66cc66;">=</span> MOAIViewport<span style="color: #66cc66;">.</span>new <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">viewport<span style="color: #66cc66;">:</span>setSize <span style="color: #66cc66;">&#40;</span> <span style="color: #cc66cc;">640</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">480</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">viewport<span style="color: #66cc66;">:</span>setScale <span style="color: #66cc66;">&#40;</span> <span style="color: #cc66cc;">640</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">480</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">layer <span style="color: #66cc66;">=</span> MOAILayer2D<span style="color: #66cc66;">.</span>new <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">layer<span style="color: #66cc66;">:</span>setViewport <span style="color: #66cc66;">&#40;</span> viewport <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> gfxQuad <span style="color: #66cc66;">=</span> MOAIGfxQuad2D<span style="color: #66cc66;">.</span>new <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  gfxQuad<span style="color: #66cc66;">:</span>setTexture <span style="color: #66cc66;">&#40;</span> <span style="color: #ff6666;">&quot;bg.png&quot;</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  gfxQuad<span style="color: #66cc66;">:</span>setRect <span style="color: #66cc66;">&#40;</span> <span style="color: #66cc66;">-</span><span style="color: #cc66cc;">320</span><span style="color: #66cc66;">,</span> <span style="color: #66cc66;">-</span><span style="color: #cc66cc;">240</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">320</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">240</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> prop <span style="color: #66cc66;">=</span> MOAIProp<span style="color: #66cc66;">.</span>new<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  prop<span style="color: #66cc66;">:</span>setDeck <span style="color: #66cc66;">&#40;</span> gfxQuad <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  prop<span style="color: #66cc66;">:</span>setLoc<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">,</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  layer<span style="color: #66cc66;">:</span>insertProp<span style="color: #66cc66;">&#40;</span>prop<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">MOAISim<span style="color: #66cc66;">.</span>pushRenderPass <span style="color: #66cc66;">&#40;</span>layer <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">init<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">128</span><span style="color: #66cc66;">,</span><span style="color: #cc66cc;">128</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /></ol></code></dd></dl><p>Statistics: Posted by <a href="http://192.168.20.226:3000/forums/memberlist.php?mode=viewprofile&amp;u=1454">Galdred</a> — Fri Mar 02, 2018 3:20 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[sshukul]]></name></author>
<updated>2018-02-28T05:23:42+00:00</updated>
<published>2018-02-28T05:23:42+00:00</published>
<id>/forums/viewtopic.php?t=3095&amp;p=18433#p18433</id>
<link href="http://192.168.20.226:3000/forums/viewtopic.php?t=3095&amp;p=18433#p18433"/>
<title type="html"><![CDATA[Game Development • Re: Dynamic lighting using normal maps / SpriteIlluminator]]></title>

<category term="Game Development" scheme="/forums/viewforum.php?f=16" label="Game Development"/>
<content type="html" xml:base="/forums/viewtopic.php?t=3095&amp;p=18433#p18433"><![CDATA[
Resurrecting thread as per discussion with @naturally on Slack.<br /><br /><dl class="codebox"><dt>Code: </dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">--- Simulates light coming onto the sprite from a single point, with additional options to simulate</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">--- ambient background light, coloring a sprite black before lighting (eg for shadows), or simulating </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">--- a light that moves with the sprite for example light from a torch that a character is carrying that </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">--- moves with it</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- @param lightx    The x coord of the light origin point</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- @param lighty    The y coord of the light origin point</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- @param lightz    The y coord of the light origin point</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- @param intensity The brightness of the light. </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- @param range     How far the light travels before it starts to taper off in brightness </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- @param red       The red component of light color</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- @param green     The green component of light color</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- @param blue      The blue component of light color</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- @param am_red    The red component of ambient background light color</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- @param am_green  The green component of ambient background light color</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- @param am_blue   The blue component of ambient background light color</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- @param move_with_prop   Does the light source point move along with the sprite or stay stationary?</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- @param is_black  Should we color the sprite black before lighting it (this is useful for simulating shadows etc.)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> point_lighting_shader_desktop<span style="color: #66cc66;">&#40;</span>lightx<span style="color: #66cc66;">,</span> lighty<span style="color: #66cc66;">,</span> lightz<span style="color: #66cc66;">,</span> intensity<span style="color: #66cc66;">,</span> range<span style="color: #66cc66;">,</span> red<span style="color: #66cc66;">,</span> green<span style="color: #66cc66;">,</span> blue<span style="color: #66cc66;">,</span> am_red<span style="color: #66cc66;">,</span> am_green<span style="color: #66cc66;">,</span> am_blue<span style="color: #66cc66;">,</span> move_with_prop<span style="color: #66cc66;">,</span> is_black<span style="color: #66cc66;">&#41;</span>  </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">  <span style="color: #aa9900; font-weight: bold;">local</span> fsh <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#91;</span><span style="color: #66cc66;">&#91;</span>  </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    varying MEDP vec2 uvVarying<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    varying MEDP vec4 positionVarying<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    varying MEDP vec4 colourVarying<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    varying MEDP vec4 light<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    varying MEDP vec3 lightColour<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    uniform sampler2D diffuseMap<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    uniform sampler2D normalMap<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    uniform float light_intensity<span style="color: #66cc66;">,</span> light_range<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    uniform MEDP float ambientColourR<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    uniform MEDP float ambientColourG<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    uniform MEDP float ambientColourB<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    uniform MEDP float is_black<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    uniform mat4 worldMatrix<span style="color: #66cc66;">;</span>               <span style="color: #66cc66;">//</span> Sum of all MOAITransforms on object</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    vec2 resolution <span style="color: #66cc66;">=</span> vec2<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">1.0</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">1.0</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    vec3 attenuation <span style="color: #66cc66;">=</span> vec3<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">1.0</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">1.0</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">1.0</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">;</span> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    void main<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #66cc66;">&#123;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      <span style="color: #66cc66;">//</span>sample color &amp; normals from our textures</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      vec4 color <span style="color: #66cc66;">=</span> texture2D<span style="color: #66cc66;">&#40;</span>diffuseMap<span style="color: #66cc66;">,</span> uvVarying<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      vec3 nColor <span style="color: #66cc66;">=</span> texture2D<span style="color: #66cc66;">&#40;</span>normalMap<span style="color: #66cc66;">,</span> uvVarying<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">.</span>rgb<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      <span style="color: #66cc66;">//</span>normals need to be converted to <span style="color: #66cc66;">&#91;</span><span style="color: #66cc66;">-</span><span style="color: #cc66cc;">1.0</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">1.0</span><span style="color: #66cc66;">&#93;</span> range <span style="color: #aa9900; font-weight: bold;">and</span> normalized</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      vec3 normal <span style="color: #66cc66;">=</span> normalize<span style="color: #66cc66;">&#40;</span>nColor <span style="color: #66cc66;">*</span> <span style="color: #cc66cc;">2.0</span> <span style="color: #66cc66;">-</span> <span style="color: #cc66cc;">1.0</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      <span style="color: #66cc66;">//</span>here we <span style="color: #aa9900; font-weight: bold;">do</span> a simple distance calculation</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      vec3 deltaPos <span style="color: #66cc66;">=</span> vec3<span style="color: #66cc66;">&#40;</span>light<span style="color: #66cc66;">.</span>xy <span style="color: #66cc66;">-</span> positionVarying<span style="color: #66cc66;">.</span>xy<span style="color: #66cc66;">,</span> light<span style="color: #66cc66;">.</span>z <span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      float vertex_dist <span style="color: #66cc66;">=</span> length <span style="color: #66cc66;">&#40;</span>deltaPos<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      <span style="color: #66cc66;">//</span>gl_FragColor <span style="color: #66cc66;">=</span> vec4<span style="color: #66cc66;">&#40;</span>deltaPos<span style="color: #66cc66;">,</span> light<span style="color: #66cc66;">.</span>a<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      <span style="color: #66cc66;">//</span> Decay light factor depending on the vertex distance from light source</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      float decay <span style="color: #66cc66;">=</span> <span style="color: #0000aa;">max</span><span style="color: #66cc66;">&#40;</span> <span style="color: #cc66cc;">0.0</span><span style="color: #66cc66;">,</span> <span style="color: #66cc66;">&#40;</span>light_range <span style="color: #66cc66;">-</span> vertex_dist <span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">/</span> light_range <span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">*</span> <span style="color: #cc66cc;">2.0</span><span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      vec3 lightDir <span style="color: #66cc66;">=</span> normalize<span style="color: #66cc66;">&#40;</span>deltaPos<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      float lambert <span style="color: #66cc66;">=</span> clamp<span style="color: #66cc66;">&#40;</span>dot<span style="color: #66cc66;">&#40;</span>normal<span style="color: #66cc66;">,</span> lightDir<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">0.0</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">1.0</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">      <span style="color: #66cc66;">//</span>now let<span style="color: #ff6666;">'s get a nice little falloff</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      float d = sqrt(dot(deltaPos, deltaPos));      </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      float att = ( attenuation.x + (attenuation.y*d) + (attenuation.z*d*d) );</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      vec3 ambientColor = vec3(ambientColourR, ambientColourG, ambientColourB);</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      vec3 result = ambientColor + (lightColour.rgb * lambert * light_intensity * decay) * att;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      result *= color.rgb;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      if(is_black == 1.0)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">        result *= vec3(.35, .35, .35);</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      vec3 resCol = colourVarying.rgb * result.rgb;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      gl_FragColor = vec4(colourVarying.rgb * result.rgb, colourVarying.a * color.a);</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    }</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  ]]</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  local vsh = [[ </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    attribute vec4 position;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    attribute vec2 uv;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    attribute vec4 colour;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    uniform MEDP float lightX;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    uniform MEDP float lightY;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    uniform MEDP float lightZ;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    uniform MEDP float lightColourR;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    uniform MEDP float lightColourG;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    uniform MEDP float lightColourB;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    uniform MEDP float moveWithProp;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    uniform mat4 worldMatrix;               // Sum of all MOAITransforms on object</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    varying vec2 uvVarying;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    varying MEDP vec4 colourVarying;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    varying vec4 positionVarying;   </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    varying vec4 light;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    varying vec3 lightColour;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    void main () {</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      uvVarying = uv;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">        </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      positionVarying = position;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      if(moveWithProp &gt; 0.0)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">        light = positionVarying + vec4(lightX, lightY, lightZ, 1.0); // * worldMatrix;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      else</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">        light = vec4(lightX, lightY, lightZ, 1.0); // * worldMatrix;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">        </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      lightColour = vec3(lightColourR, lightColourG, lightColourB);</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      colourVarying = colour;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">      gl_Position = position;          </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    }</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  ]]</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  local program = MOAIShaderProgram.new ()</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:setVertexAttribute ( 1, '</span>position<span style="color: #ff6666;">' )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:setVertexAttribute ( 2, '</span>uv<span style="color: #ff6666;">' )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:setVertexAttribute ( 3, '</span>colour<span style="color: #ff6666;">' )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:reserveUniforms ( 16 )  </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 1, '</span>diffuseMap<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_INT )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 2, '</span>normalMap<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_INT )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 3, '</span>lightX<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_FLOAT )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 4, '</span>lightY<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_FLOAT )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 5, '</span>lightZ<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_FLOAT )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 6, '</span>lightColourR<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_FLOAT )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 7, '</span>lightColourG<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_FLOAT )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 8, '</span>lightColourB<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_FLOAT )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 9, '</span>light_intensity<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_FLOAT )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 10, '</span>light_range<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_FLOAT )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 11, '</span>ambientColourR<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_FLOAT )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 12, '</span>ambientColourG<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_FLOAT )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 13, '</span>ambientColourB<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_FLOAT )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 14, '</span>moveWithProp<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_FLOAT )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 15, '</span>isBlack<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_FLOAT ) </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:declareUniform( 16, '</span>worldMatrix<span style="color: #ff6666;">', MOAIShaderProgram.UNIFORM_TYPE_FLOAT, MOAIShaderProgram.UNIFORM_WIDTH_MATRIX_4X4 )  </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:load ( vsh, fsh )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:reserveTextures ( 2 ) </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:setTexture ( 1, 1, 1 ) </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:setTexture ( 2, 2, 2 ) </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:reserveGlobals(1)  </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  program:setGlobal ( 1, MOAIShaderProgram.GLOBAL_MODEL_TO_WORLD_MTX , 16, 1 )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  local shader = MOAIShader.new ()</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  shader:setProgram(program)    </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  shader:setUniform( 1, 0 )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  shader:setUniform( 2, 1 )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  shader:setUniform( 3, lightx )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  shader:setUniform( 4, lighty )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  shader:setUniform( 5, lightz )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  shader:setUniform( 6, red)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  shader:setUniform( 7, green )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  shader:setUniform( 8, blue )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  shader:setUniform( 9, intensity / 5)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  shader:setUniform( 10, range )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  shader:setUniform( 11, am_red)  </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  shader:setUniform( 12, am_green )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  shader:setUniform( 13, am_blue )</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  if move_with_prop ~= nil then</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    shader:setUniform( 14, 1.0)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  else </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    shader:setUniform( 14, 0.0)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  if is_black then</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    shader:setUniform( 15, 1.0)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  else </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">    shader:setUniform( 15, 0.0)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  </span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">  return shader</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff6666;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"> </div></li><br /></ol></code></dd></dl><br /><br />So here's the final shader I had for point lighting with normal maps, in case anyone needs it. It worked really well pre Moai 1.6 but some of the rendering pipeline stuff changed in 1.6 so it still works but I had to comment out the  // * worldMatrix; multiplication as it is broken now. <br /><br />What this means is that right now the lighting looks great but if you do things like flipping the sprite, then the lighting point flips with it instead of adjusting accordingly based on the GLOBAL_MODEL_TO_WORLD_MTX. <br /><br />If someone could get this to work again, I would really appreciate as I've been trying my best and failing with my limited knowledge of shaders and the Moai rendering pipeline. <br /><br />The final result with the normal maps (generated using SpriteIlluminator) looks like this:<br /><br /><img src="https://i.imgur.com/Mv5622o.png" alt="Image" /><p>Statistics: Posted by <a href="http://192.168.20.226:3000/forums/memberlist.php?mode=viewprofile&amp;u=1389">sshukul</a> — Wed Feb 28, 2018 5:23 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[naturally]]></name></author>
<updated>2018-02-05T16:38:42+00:00</updated>
<published>2018-02-05T16:38:42+00:00</published>
<id>/forums/viewtopic.php?t=3382&amp;p=18432#p18432</id>
<link href="http://192.168.20.226:3000/forums/viewtopic.php?t=3382&amp;p=18432#p18432"/>
<title type="html"><![CDATA[Moai SDK • Re: Strange text behavior with offset viewport]]></title>

<category term="Moai SDK" scheme="/forums/viewforum.php?f=7" label="Moai SDK"/>
<content type="html" xml:base="/forums/viewtopic.php?t=3382&amp;p=18432#p18432"><![CDATA[
Was this an Apple-specific issue?<p>Statistics: Posted by <a href="http://192.168.20.226:3000/forums/memberlist.php?mode=viewprofile&amp;u=1551">naturally</a> — Mon Feb 05, 2018 4:38 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[WhaleFood]]></name></author>
<updated>2018-01-31T01:53:37+00:00</updated>
<published>2018-01-31T01:53:37+00:00</published>
<id>/forums/viewtopic.php?t=3382&amp;p=18430#p18430</id>
<link href="http://192.168.20.226:3000/forums/viewtopic.php?t=3382&amp;p=18430#p18430"/>
<title type="html"><![CDATA[Moai SDK • Re: Strange text behavior with offset viewport]]></title>

<category term="Moai SDK" scheme="/forums/viewforum.php?f=7" label="Moai SDK"/>
<content type="html" xml:base="/forums/viewtopic.php?t=3382&amp;p=18430#p18430"><![CDATA[
Figured out a workaround.  Making the viewport way bigger than the window (I chose 2x) seems to fix the issue.<p>Statistics: Posted by <a href="http://192.168.20.226:3000/forums/memberlist.php?mode=viewprofile&amp;u=1373">WhaleFood</a> — Wed Jan 31, 2018 1:53 am</p><hr />
]]></content>
</entry>
</feed>