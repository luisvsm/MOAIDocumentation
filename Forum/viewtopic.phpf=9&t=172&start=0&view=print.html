<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta name="robots" content="noindex" />

<title>Moai Forum | The mobile platform for pro game developers &bull; View topic - Organising a large Moai project&#39;s functionality: what approaches are people using?</title>

<link href="styles/proFormell/theme/print.css" rel="stylesheet" type="text/css" />
<link type="image/vnd.microsoft.icon" rel="shortcut icon" href="styles/proFormell/theme/images/favicon.ico">
</head>

<body id="phpbb">
<div id="wrap">
	<a id="top" name="top" accesskey="t"></a>

	<div id="page-header">
		<h1>Moai Forum | The mobile platform for pro game developers</h1>
		<p>The mobile platform for pro game developers<br /><a href="index.html">/forums/</a></p>

		<h2>Organising a large Moai project&#39;s functionality: what approaches are people using?</h2>
		<p><a href="organising-a-large-moai-project-s-functionality-what-approaches-are-people-using-t172/index.html">/forums/organising-a-large-moai-project-s-functionality-what-approaches-are-people-using-t172/</a></p>
	</div>

	<div id="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
		
			<div class="post">
				<h3>Organising a large Moai project&#39;s functionality: what approaches are people using?</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Wed Oct 26, 2011 8:28 pm</strong></div>
				<div class="author">by <strong>tim</strong></div>
				<div class="content">Okay, so I've got past the initial hurdles with getting to grips with Moai basics. I've completed the Rocket Lobster tutorial, and I think I understand everything that's going on there.
<br />
<br />However, Rocket Lobster is just a single-file project, so what are the ways that experienced Moai users logically divide their projects up? In our <a href="http://launchingpadgames.com" target="_blank">previous</a> Objective-C/cocos2d projects, I've typically stuck to a strongly object-oriented MVC pattern, dividing my game entities into models and corresponding views, each of which have their own sourcecode files. That approach works well in Objective-C with its emphasis on classes and objects.
<br />
<br />I don't want to shoehorn my previous approach into Lua/Moai if it's not going to be a good fit. I realise that Lua can be made to provide classes and inheritance fairly easily, but I don't see that approach used in Rocket Lobster — rather, it's a series of <em>makeX()</em> functions that produce objects on demand. Experienced Moai developers: do you recommend using the Rocket Lobster approach across an entire project, and just breaking off <em>makeX()</em>-type functions into modules accessed via <em>require()</em> as you see fit? If not, how do you organise the functionality of your game (be it classical classes or something more exotic)?</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Organising a large Moai project&#39;s functionality: what approaches are people using?</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Wed Oct 26, 2011 10:32 pm</strong></div>
				<div class="author">by <strong>patrick</strong></div>
				<div class="content">I hope more people post here - this is a great topic.
<br />
<br />When we first started using Lua, we did try to go down a heavily OOP path, but backed off a lot. The model we favor now is a 'decoration' idea where we start with a table and then add methods to it in order to build up more complex behavior. So composition over inheritance, basically.
<br />
<br />In terms of runtime, for our own games we have a very lightweight scene manager, resource cache and state machine pattern. We also have the notion of a 'rig' which is a container for a collection of framework objects. There's also a bag of standalone utility functions to do things like wait for touches, wrap input differences, etc.
<br />
<br />I have a feeling we'll be refining some of these ideas and rewriting them for our next project. When we get something a bit more mature, will post it up as an example. But the overall trend (for us) seems to be less is more.
<br />
<br />Would really like to hear how other developers are thinking about it as well.</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Organising a large Moai project&#39;s functionality: what approaches are people using?</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Thu Oct 27, 2011 1:58 pm</strong></div>
				<div class="author">by <strong>tim</strong></div>
				<div class="content">Thanks for the detailed response, Patrick! Sounds like an excellent approach. If you ever feel that what you've got is example-worthy, I'll be first in line to read it. <img src="http://192.168.20.226:3000/wp-content/forum-smileys/sf-smile.gif" alt="Smile" />
<br />
<br />If you have time, I'd love to hear more about how your 'decoration'/'adding methods to a table' concept works. (I tend to favour composition over inheritance too — it seems to fit better with how my brain works, plus make for cleaner optimisation passes.)</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Organising a large Moai project&#39;s functionality: what approaches are people using?</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Fri Oct 28, 2011 3:42 am</strong></div>
				<div class="author">by <strong>patrick</strong></div>
				<div class="content">Sure. The basic idea is just to keep adding methods to a table. So you have something like:
<br />
<br />object = {}
<br />
<br />makePhysicsObject ( object )
<br />
<br />makeSprite ( object )
<br />
<br />makeParticleEmitter ( object )
<br />
<br />Or something like that. Each method extends the object to include the new interface. Obviously, the devil's in the details. When we're a bit further along, will ask Eric to share what out game team has been doing.</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Organising a large Moai project&#39;s functionality: what approaches are people using?</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Fri Oct 28, 2011 1:44 pm</strong></div>
				<div class="author">by <strong>tim</strong></div>
				<div class="content">Oo, I really like that approach. It feels like a more natural fit with Lua than deep hierarchies of classes. (And in fact, I probably should have also used that idea <a href="http://launchingpadgames.com/games/the-pretender-trilogy/" target="_blank">back when I was intensively using Actionscript 3 with Flash</a> - marked most of my classes as dynamic and then just attached more methods to them as required.)</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Organising a large Moai project&#39;s functionality: what approaches are people using?</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Fri Oct 28, 2011 11:35 pm</strong></div>
				<div class="author">by <strong>patrick</strong></div>
				<div class="content">Let us know how it works out for you. You may beat us to posting a really good example of it. Lua is such a cool/different paradigm... there's a real zen to it.</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Organising a large Moai project&#39;s functionality: what approaches are people using?</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Fri Dec 02, 2011 8:24 am</strong></div>
				<div class="author">by <strong>robin.baumgarten</strong></div>
				<div class="content">I'm an Android game dev, and for my next project I'm looking at something that more easily ports to iOS. The Moai sdk looks really nice for that.
<br />
<br />However, having no real LUA experience yet, I'd also be really happy about a bit more fleshed out, multi-file and multi-screen example, like hinted at in <a href="new-users/some-handy-links-for-new-developers/index.html" target="_blank">another thread</a>. An open-source game, if you will, that shows some best practices with the decorator-style object handling as described above. Right now, I don't really know where to start to make an efficient, manageable game.</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Organising a large Moai project&#39;s functionality: what approaches are people using?</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Mon Dec 05, 2011 4:10 am</strong></div>
				<div class="author">by <strong>milleniummike</strong></div>
				<div class="content">I'm new to LUA having a java, c# and php background.
<br />
<br />
<br />
<br />I have played with the samples and the potential is looking good.
<br />
<br />
<br />
<br />I like the "minimal" approach so far on lua but have a feeling a full app/game will start to sprawl with logic and modules.
<br />
<br />
<br />
<br />In terms of using multiple file structure I notice lua has a dofile command so you can split out your code into seperate files.
<br />
<br />ex.
<br />
<br />dofile "functions.lua"
<br />
<br />
<br />
<br />As a project gets more complicated my approach will probably be to split out the code into seperate files for managability maybe along the lines of
<br />
<br />resources.lua - to load all sprites, bodies,audio, levels via xml and resources
<br />
<br />gamelogic.lua - functions around the game logic - collisions, user actions
<br />
<br />menu.lua - functions around splashscreen / game menu etc
<br />
<br />
<br />
<br />For the resources - ie audio, images etc I think I'll just put these into subfolders (ie images audio etc) to keep the whole project tidy.</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: Organising a large Moai project's functionality: what ap</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Mon May 28, 2012 10:05 pm</strong></div>
				<div class="author">by <strong>nosheet</strong></div>
				<div class="content">This is a very interesting thread. I am new to Moai but fairly experienced with Lua, building quite a few apps (business and games) on another lua SDK.<br />So far I have been organizing large projects using very light Class-approach, where I would declare classes in separate .lua files, then instantiate and decorate with whatever I might need.<br />Very basic .lua file to define a class would be:<br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=9&amp;t=172&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- inside of animal.lua</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> Animal <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> Animal_mt <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span> __index <span style="color: #66cc66;">=</span> Animal <span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> Animal<span style="color: #66cc66;">:</span>decorate<span style="color: #66cc66;">&#40;</span> moduleFileName <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> behavior <span style="color: #66cc66;">=</span> <span style="color: #0000aa;">require</span> moduleFileName</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">for</span> k<span style="color: #66cc66;">,</span>v <span style="color: #aa9900; font-weight: bold;">in</span> <span style="color: #0000aa;">pairs</span><span style="color: #66cc66;">&#40;</span>behavior<span style="color: #66cc66;">&#41;</span> <span style="color: #aa9900; font-weight: bold;">do</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; self<span style="color: #66cc66;">&#91;</span>k<span style="color: #66cc66;">&#93;</span> <span style="color: #66cc66;">=</span> v</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; module<span style="color: #66cc66;">.</span>loaded<span style="color: #66cc66;">&#91;</span>moduleFileName<span style="color: #66cc66;">&#93;</span> <span style="color: #66cc66;">=</span> <span style="color: #aa9900;">nil</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> Animal<span style="color: #66cc66;">.</span>new<span style="color: #66cc66;">&#40;</span> params <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> self &nbsp;<span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000aa;">setmetatable</span><span style="color: #66cc66;">&#40;</span> self<span style="color: #66cc66;">,</span> Animal_mt <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">-- do some stuff with common parameters/members for the class</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> self</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">return</span> Animal</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl><br /><br /><br />Then instead of creating more classes through inheritance, I would decorate, ideally storing the interface in a separate file, like:<br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=9&amp;t=172&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- dog_behavior.lua</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> DogBehavior <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">DogBehavior<span style="color: #66cc66;">.</span>bark <span style="color: #66cc66;">=</span> <span style="color: #aa9900; font-weight: bold;">function</span><span style="color: #66cc66;">&#40;</span> self<span style="color: #66cc66;">,</span> barkSound <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;This dog says &quot;</span><span style="color: #66cc66;">..</span>barkSound<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">return</span> DogBehavior</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl><br /><br />And inheritance itself would be done through:<br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=9&amp;t=172&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> AnimalClass <span style="color: #66cc66;">=</span> <span style="color: #0000aa;">require</span> <span style="color: #ff6666;">&quot;animal.lua&quot;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> myAnimal <span style="color: #66cc66;">=</span> AnimalClass<span style="color: #66cc66;">.</span>new<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">myAnimal<span style="color: #66cc66;">:</span>decorate<span style="color: #66cc66;">&#40;</span> <span style="color: #ff6666;">&quot;dog_behavior&quot;</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">myAnimal<span style="color: #66cc66;">:</span>bark<span style="color: #66cc66;">&#40;</span> <span style="color: #ff6666;">&quot;WOF,WOF!&quot;</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- which would give us &quot;WOF,WOF!&quot; in output</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl><br /><br />Well, ok I wrote this from the top of my head inside of forum post editor, so it might not work as it is, but that's the general idea.<br />Also, most of the classes might have a .view property that would point to whatever I will be using to represent them on screen.<br />This all might look like an overkill at beginning but as project grows an early investment in proper definition of &quot;classes&quot; and their responsibilities always pay off.<br /><br />Apart from these, I would normally have a couple of singleton classes too:<br />- Scene Manager<br />- Resource Manager<br />- Sound Manager<br />- Settings ( keeps the states, and saves to preference file )<br /><br />Hope it gives some idea.<br />A few things that I generally avoid is using module(package.seeall)...</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: Organising a large Moai project's functionality: what ap</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Tue May 29, 2012 2:32 am</strong></div>
				<div class="author">by <strong>aminusia</strong></div>
				<div class="content">I am new to lua and Moai and came from the ActionScript 3 comfort zone. So the first thing I looking for when working with Moai/lua is by looking a way that closer with AS object and packaging culture. <br /><br />Thats why I use this table-class constructor function from <a href="http://lua-users.org/wiki/SimpleLuaClasses" class="postlink">http://lua-users.org/wiki/SimpleLuaClasses</a>. As for packaging, lua itself is reading directories as packages as long as you put this command on the beginning of the file.<br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=9&amp;t=172&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">module<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">...,</span> package<span style="color: #66cc66;">.</span>seeall<span style="color: #66cc66;">&#41;</span></div></li><br /></ol></code></dd></dl><br />Other units will straightly recognize them as package.<br /><br />So directories are arranged this way:<br />|- main.lua<br />|- scene<br />|  .   . |- ModuleA.lua<br />|- assets<br /> .   .  . |- AssetB.lua<br /><br />And access the package inside main.lua as below<br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=9&amp;t=172&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000aa;">require</span> <span style="color: #ff6666;">&quot;scene.ModuleA.lua&quot;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000aa;">require</span> <span style="color: #ff6666;">&quot;assets.AssetB.lua&quot;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">moduleA <span style="color: #66cc66;">=</span> scene<span style="color: #66cc66;">.</span>ModuleA<span style="color: #66cc66;">.</span>ModuleA<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">assetA <span style="color: #66cc66;">=</span> assets<span style="color: #66cc66;">.</span>AssetB<span style="color: #66cc66;">.</span>AssetB<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /></ol></code></dd></dl><br /><br />As for singletons, it seems that people are using the exact same singleton arrangement:<br />- Scenes<br />- Sounds<br />- Resources<br />- General Data and Configuration<br /><br />I guess it comes out from the AS3 habit, as I had to put sound and resource manager in a way that accessible by all part of the application. This way we can simplify our resource and sound management to reduce any leakage threat.</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: Organising a large Moai project's functionality: what ap</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Tue May 29, 2012 7:07 am</strong></div>
				<div class="author">by <strong>ibisum</strong></div>
				<div class="content">I've done about 5 projects with MOAI so far, and have settled (evolved into?) on a 'table-driven' approach, whereby a core engine takes in tables as its input and spits out game/app logic.  So, I'm in the 'decoration over inheritance camp', mostly.<br /><br />For my physics game, I have one table and one function per game-level - the table defines the static stuff, and the function generates the dynamics physics content.  My engine processes the table, calls the generator for each scene, and handles the game logic - when the level is 'won' or lost, the engine itself tears down all of the items found in the table and generator-function(), then goes on to the next table entry.  This has made it very, very easy to build levels very quickly - most of the work is in the game/table design and how the generator emits characters for handling in the main game engine loop.<br /><br />For my GUI-based application, which is a little more conservative, I have been using (and extending) the moaigui contributed framework for my needs.  This has meant a lot more class/object-oriented development than I would normally feel comfortable using with MOAI, but it turns out to work okay.  But again, at the higher level, for each form in the application (screen/dialog, whatever you want to call it) there is a table defining the static data, and then a table full of handler methods for any of the GUI events.  This, also, works pretty well.<br /><br />For my next project, another physics game, I will return to the engine-eating-tables approach and leave the class() stuff alone - I don't *really* think its necessary for my projects, its mostly just a way for me to get organized using 'traditional methods', but for the most part with my MOAI experience now, I don't think its necessarily important - the table-contains-data-*And-functions idea (decoration) is pretty powerful.</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: Organising a large Moai project's functionality: what ap</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Tue May 29, 2012 2:43 pm</strong></div>
				<div class="author">by <strong>sgeos</strong></div>
				<div class="content">I have a game state module that contains all the &quot;global&quot; data.  I pass that into other modules from the game loop in main.lua.  The plan is to use a data driven approach and drop game data into sqlite tables.</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: Organising a large Moai project's functionality: what ap</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Tue May 29, 2012 4:38 pm</strong></div>
				<div class="author">by <strong>makotok1123</strong></div>
				<div class="content">I have followed the principles of object-oriented.<br /><br />Create a class which will be a base, to add functionality to the order.<br />Delegates in some cases.<br /><br />Having a thin wrapper, automatically manage the resource.<br />Minimize the code to implement it.<br /><br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=9&amp;t=172&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">layer <span style="color: #66cc66;">=</span> Layer <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">sprite <span style="color: #66cc66;">=</span> Sprite <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#123;</span>texture <span style="color: #66cc66;">=</span> <span style="color: #ff6666;">&quot;cathead.png&quot;</span><span style="color: #66cc66;">,</span> layer <span style="color: #66cc66;">=</span> layer<span style="color: #66cc66;">&#125;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl><br /><br />Game logic is based on the thinking entity.<br />This is the domain model.<br /> <br />I is not game developers,  business application developer.<br />may not necessarily be appropriate.<br /><br />-----<br />I'm familiar with ActionScript and Java.<br />In particular, ActionScript is using FlexSDK.<br />This is a very good model.<br /><br />I wanted to bring this idea to MOAISDK.<br />I have created a framework for own ease.<br />Framework is a result of certain came out.<br />Currently, while creating my game.<br /><br />The current results are published below.<br /><br /><!-- m --><a class="postlink" href="https://github.com/makotok/Hanappe">https://github.com/makotok/Hanappe</a><!-- m --></div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: Organising a large Moai project's functionality: what ap</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Tue May 29, 2012 8:12 pm</strong></div>
				<div class="author">by <strong>rhoster</strong></div>
				<div class="content">I'll add my two cents to this here and provide links to the latest resources as of May 2012:<br /><br />My Background: I come from a Computer Science background, but have been pretty much exclusively coding in PHP/MySQL for the last few years.  Making the switch to Lua has been very easy!  There is plenty of great documentation on the web for getting started, here are a few links:<br /><br />Lua 5.2 Reference Manual - <!-- m --><a class="postlink" href="http://www.lua.org/manual/5.2/manual.html">http://www.lua.org/manual/5.2/manual.html</a><!-- m --><br />(I particularly like the EBNF for the language at the bottom section 9)<br />Programming in Lua - <!-- m --><a class="postlink" href="http://www.lua.org/pil/#online">http://www.lua.org/pil/#online</a><!-- m --><br /><br />The thing that threw me at first was that I wasn't sure exactly how to create an object oriented structure; I quickly learned that it would be through tables (the collection variable in Lua).  The code I ended up using came from this page and takes advantage of Metatables (a newer feature of Lua I believe) which seems to be the best practice for now:<br /><br /><!-- m --><a class="postlink" href="http://lua-users.org/wiki/LuaClassesWithMetatable">http://lua-users.org/wiki/LuaClassesWithMetatable</a><!-- m --><br /><br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=9&amp;t=172&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> Class<span style="color: #66cc66;">&#40;</span>members<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; members <span style="color: #66cc66;">=</span> members <span style="color: #aa9900; font-weight: bold;">or</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> mt <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; __metatable <span style="color: #66cc66;">=</span> members<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; __index &nbsp; &nbsp; <span style="color: #66cc66;">=</span> members<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> <span style="color: #aa9900; font-weight: bold;">function</span> new<span style="color: #66cc66;">&#40;</span>_<span style="color: #66cc66;">,</span> init<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> <span style="color: #0000aa;">setmetatable</span><span style="color: #66cc66;">&#40;</span>init <span style="color: #aa9900; font-weight: bold;">or</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span><span style="color: #66cc66;">,</span> mt<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> <span style="color: #aa9900; font-weight: bold;">function</span> copy<span style="color: #66cc66;">&#40;</span>obj<span style="color: #66cc66;">,</span> <span style="color: #66cc66;">...</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> newobj <span style="color: #66cc66;">=</span> obj<span style="color: #66cc66;">:</span>new<span style="color: #66cc66;">&#40;</span><span style="color: #0000aa;">unpack</span><span style="color: #66cc66;">&#40;</span>arg<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">for</span> n<span style="color: #66cc66;">,</span>v <span style="color: #aa9900; font-weight: bold;">in</span> <span style="color: #0000aa;">pairs</span><span style="color: #66cc66;">&#40;</span>obj<span style="color: #66cc66;">&#41;</span> <span style="color: #aa9900; font-weight: bold;">do</span> newobj<span style="color: #66cc66;">&#91;</span>n<span style="color: #66cc66;">&#93;</span> <span style="color: #66cc66;">=</span> v <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> newobj</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; members<span style="color: #66cc66;">.</span>new &nbsp;<span style="color: #66cc66;">=</span> members<span style="color: #66cc66;">.</span>new &nbsp;<span style="color: #aa9900; font-weight: bold;">or</span> new</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; members<span style="color: #66cc66;">.</span>copy <span style="color: #66cc66;">=</span> members<span style="color: #66cc66;">.</span>copy <span style="color: #aa9900; font-weight: bold;">or</span> copy</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> mt</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /></ol></code></dd></dl><br /><br />This gives you a basic Class object from which you can derive all other Objects.  The example Vector implementation is a perfect example and gives you a template for creating your own classes:<br /><br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=9&amp;t=172&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000aa;">require</span> <span style="color: #ff6666;">'Class'</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">Vector <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> Vector_mt <span style="color: #66cc66;">=</span> Class<span style="color: #66cc66;">&#40;</span>Vector<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> Vector<span style="color: #66cc66;">:</span>new<span style="color: #66cc66;">&#40;</span>x<span style="color: #66cc66;">,</span>y<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> <span style="color: #0000aa;">setmetatable</span><span style="color: #66cc66;">&#40;</span> <span style="color: #66cc66;">&#123;</span>x<span style="color: #66cc66;">=</span>x<span style="color: #66cc66;">,</span> y<span style="color: #66cc66;">=</span>y<span style="color: #66cc66;">&#125;</span><span style="color: #66cc66;">,</span> Vector_mt<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> Vector<span style="color: #66cc66;">:</span>mag<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> <span style="color: #0000aa;">math.sqrt</span><span style="color: #66cc66;">&#40;</span>self<span style="color: #66cc66;">:</span>dot<span style="color: #66cc66;">&#40;</span>self<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> Vector<span style="color: #66cc66;">:</span>dot<span style="color: #66cc66;">&#40;</span>v<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> self<span style="color: #66cc66;">.</span>x <span style="color: #66cc66;">*</span> v<span style="color: #66cc66;">.</span>x <span style="color: #66cc66;">+</span> self<span style="color: #66cc66;">.</span>y <span style="color: #66cc66;">*</span> v<span style="color: #66cc66;">.</span>y</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /></ol></code></dd></dl><br /><br />So that is how I make my classes, for project structure - I tend to favor composition objects and inheritance if it truly makes sense (I haven't used it yet, but anticipate doing some for the game specific objects that I'd like to share a codebase).  I think the MVC framework is a little too heavy for this and I tend to separate things into just two sections, Control and Display.<br /><br />The benefits of composition are fairly well explained in this article (from 1998!!):<br /><br /><!-- m --><a class="postlink" href="http://www.javaworld.com/jw-11-1998/jw-11-techniques.html">http://www.javaworld.com/jw-11-1998/jw- ... iques.html</a><!-- m --><br /><br />-Bobby</div>
			</div>
			<hr />
		
	</div>

	<div id="page-footer">
		<div class="page-number">All times are UTC <br />Page <strong>1</strong> of <strong>1</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</div>
	</div>
</div>

</body>
</html>