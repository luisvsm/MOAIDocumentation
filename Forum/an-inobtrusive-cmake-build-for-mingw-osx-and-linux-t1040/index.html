<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>Moai Forum | The mobile platform for pro game developers &bull; View topic - An inobtrusive cmake build for mingw, osx and linux.</title>

<link rel="alternate" type="application/atom+xml" title="Feed - Moai Forum | The mobile platform for pro game developers" href="../feed.php.html" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="../feed.php%3Fmode=forums.html" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="../feed.php%3Fmode=topics.html" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="../feed.php%3Fmode=topics_active.html" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - Moai SDK Developer Support" href="../feed.php%3Ff=7.html" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - An inobtrusive cmake build for mingw, osx and linux." href="http://192.168.20.226:3000/forums/feed.php?f=7&amp;t=1040" />

<!--
	phpBB style name: proFormell
	Based on style:   prosilver (this is the default phpBB3 style)
	Inspired by:	  Formell (Joomla Style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  	  Marc Alexander
	
	NOTE: This page was generated by phpBB, the free open-source bulletin board package.
	      The phpBB Group is not responsible for the content of this page and forum. For more information
	      about phpBB please visit http://www.phpbb.com
-->

<script type="text/javascript">
// <![CDATA[
	var jump_page = 'Enter the page number you wish to go to:';
	var on_page = '1';
	var per_page = '';
	var base_url = '';
	var style_cookie = 'phpBBstyle';
	var style_cookie_settings = '; path=/';
	var onload_functions = new Array();
	var onunload_functions = new Array();
	var is_ie6 = false;

	/**
	* Find a member
	*/
	function find_username(url)
	{
		popup(url, 760, 570, '_usersearch');
		return false;
	}

	/**
	* New function for handling multiple calls to window.onload and window.unload by pentapenguin
	*/
	window.onload = function()
	{
		for (var i = 0; i < onload_functions.length; i++)
		{
			eval(onload_functions[i]);
		}
	}

	window.onunload = function()
	{
		for (var i = 0; i < onunload_functions.length; i++)
		{
			eval(onunload_functions[i]);
		}
	}

// ]]>
</script>
<!--[if lt IE 7]>
<script type="text/javascript">
// <![CDATA[
var is_ie6 = true;
// ]]>
</script>
<![endif]-->


<link href="../styles/proFormell/theme/print.css" rel="stylesheet" type="text/css" media="print" title="printonly" />

<link href="../style.css" rel="stylesheet" type="text/css" media="screen, projection" />



<link href="../styles/proFormell/theme/images/favicon.ico" rel="shortcut icon" />

<script type="text/javascript" src="../styles/prosilver/template/forum_fn.js"></script>
<script src="../styles/prosilver/template/jquery-1.4.4.min.js" type="text/javascript"></script>

<script type="text/javascript">
// <![CDATA[
/**
* New pop-up functions
* based on  http://yensdesign.com/2008/09/how-to-create-a-stunning-and-smooth-popup-using-jquery/
*/

//SETTING UP OUR POPUP
//0 means disabled; 1 means enabled;
var popupStatus = 0;
var openPopup = '';

//loading popup with jQuery magic!
function loadPopup()
{
	//loads popup only if it is disabled
	if(popupStatus==0)
	{
		$('#backgroundPopup').css({'opacity': '0.7'});
		// Now let's make sure we actually see the image
		var scroll = $(window).scrollTop();
		$('#popupPM').animate({marginTop: scroll}, 'fast', function() {
			// Animation complete.
			});
		$('#backgroundPopup').fadeIn('slow');
		$('#popupPM').fadeIn('slow');
		popupStatus = 1;
		openPopup = 'PM';
	}
}

//disabling popup with jQuery magic!
function disablePopup()
{
	//disables popup only if it is enabled
	if(popupStatus==1 && openPopup == 'PM')
	{
		$('#backgroundPopup').fadeOut('slow');
		$('#popupPM').fadeOut('slow');
		popupStatus = 0;
		openPopup = '';
	}
}

//centering popup
function centerPopup()
{
	//request data for centering
	var windowWidth = document.documentElement.clientWidth;
	var windowHeight = document.documentElement.clientHeight;
	var popupHeight = $('#popupPM').height();
	var popupWidth = $('#popupPM').width();
	//centering
	$('#popupPM').css({
	'position': 'absolute',
	'top': windowHeight/2-popupHeight/2,
	'left': windowWidth/2-popupWidth/2
	});
	//only need force for IE6
	$('#backgroundPopup').css({'height': windowHeight});
}

$(document).ready(function(){
	
	resize_images();
	
	
	// IE6 and below PNG fix (not really)
	if(is_ie6)
	{
		replace_png();
	}
	
	//CLOSING POPUP
	//Click the x event!
	$('#popupPMClose').click(function(){
		disablePopup();
	});
	//Click out event!
	$('#backgroundPopup').click(function(){
		disablePopup();
		disableImage();
	});
	//Press Escape event!
	$(document).keypress(function(e){
		if(e.keyCode==27 && popupStatus==1)
		{
			disablePopup();
			disableImage();
		}
	});
	
	
	// Image popup
	$('img', 'dt.attach-image').click(function(){
		image_load($(this).attr('src'), $(this).attr('alt'));
		centerImage();
	});
	
	$('.content img').click(function(){
		var check = $(this).parent().hasClass('content');
		if(check)
		{
			image_load($(this).attr('src'), $(this).attr('alt'));
			centerImage();
		}
	});
	
	// Closing Image popup
	//Click the x event!
	$('#popupImageClose').click(function(){
		disableImage();
	});
	
	//Click image box event
	$('#popupImage').click(function(){
		disableImage();
	});
	
	//Click image event
	$('#ImagePopup img').click(function(){
		disableImage();
	});
	

});

/**
* Replaces weird looking PNG files with the respectie GIF file
* Only run this if the browser is IE6 or below
*/
function replace_png()
{
	// Fix Logo
	var str = $('#logo img').attr('src'); 
	$('#logo img').attr('src', str.substring(0, str.length - 3) + 'gif');
	
	// Fix forum icons
	$('dl.icon').each(function() {
		var str = $(this).css('background-image');
		if(str != '')
		{
			$(this).css('background-image', str.substring(0, str.length - 5) + 'gif")');
		}
	});
}


/**
* Image resizer
*/
function resize_images()
{
	var hello = $('dl.attachbox dd dl.file dt.attach-image img').innerWidth();
	var maxWidth = $('div.content').innerWidth() - 30;
	
	// resize the attached images
	$('img', 'dt.attach-image').each(function(i){
		// check the width of the image
		if ($(this).width() > maxWidth)
		{
			// calculate new image dimensions
			newWidth = maxWidth;
			newHeight = $(this).height() / ( $(this).width() / maxWidth );
			   
			// set new image dimensions
			$(this).height(newHeight).width(newWidth);
		}
	});
	
	// resize the images that were added via [img] bbcode
	$('img', 'div.content').each(function(i){
		// check the width of the image
		$(this).css('max-width', maxWidth); // fix for IE
		if ($(this).width() > maxWidth)
		{
			// calculate new image dimensions
			newWidth = maxWidth;
			newHeight = $(this).height() / ( $(this).width() / maxWidth );
			   
			// set new image dimensions
			$(this).height(newHeight).width(newWidth);
		}
	});
}

/**
* Image pop-up
*/
function image_load(src, alt)
{
	//loads popup only if it is disabled
	if(popupStatus==0)
	{
		$('#ImagePopup').html('<img id="imgpopup" src="http://192.168.20.226:3000/forums/an-inobtrusive-cmake-build-for-mingw-osx-and-linux-t1040/'&#32;+&#32;src&#32;+&#32;'" alt="' + alt + '" />');
		var windowWidth = document.documentElement.clientWidth;
		var windowHeight = document.documentElement.clientHeight;
		var maxWidth = windowWidth * 0.85;
		var maxHeight = windowHeight * 0.85;
		$('#popupImage img').css('max-width', maxWidth);
		$('#popupImage img').css('max-height', maxHeight);
		$('#backgroundPopup').css({'opacity': '0.7'});
		// Now let's make sure we actually see the image
		var scroll = $(window).scrollTop();
		$('#popupImage').animate({marginTop: scroll}, 'fast', function() {
			// Animation complete.
			});
		$('#backgroundPopup').fadeIn('slow');
		$('#popupImage').fadeIn('slow');
		popupStatus = 1;
		openPopup = 'Image';
	}
}

//centering popup
function centerImage()
{
	//request data for centering
	var windowWidth = document.documentElement.clientWidth;
	var windowHeight = document.documentElement.clientHeight;
	var popupHeight = $('#popupImage').height();
	var popupWidth = $('#popupImage').width();
	var newTop = windowHeight/2-popupHeight/2;
	var newLeft = windowWidth/2-popupWidth/2;
	//centering
	$('#popupImage').css({
	'position': 'absolute',
	'top': newTop,
	'left': newLeft
	});
	
	//only need force for IE6
	$('#backgroundPopup').css({'height': windowHeight});
}

//disabling popup with jQuery magic!
function disableImage()
{
	//disables popup only if it is enabled
	if(popupStatus==1 && openPopup == 'Image')
	{
		$('#backgroundPopup').fadeOut('slow');
		$('#popupImage').fadeOut('slow');
		popupStatus = 0;
		openPopup = '';
	}
}


// ]]>
</script>

</head>

<body id="phpbb" class="section-viewtopic ltr">
<!--- box border START -->
<div id="box">

<div class="top-left"></div><div class="top-center"></div><div class="top-right"></div>
<div id="left-border">
<div id="right-border">


<!--- box border END -->
<div class="inside">
 <div class="notopgap">
<div id="wrap">
	<a id="top" name="top" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar">
			<div class="inner"><!-- <span class="corners-top"><span></span></span> -->
			<div style="height: 140px ;">
			<div id="site-description">
				<div class="header-pad"><a href="index.html" title="" id="logo"><img src="../styles/proFormell/imageset/site-logo.png" width="410" height="98" alt="" title="" /></a></div>
			
		<!--		<p class="site-desc">The mobile platform for pro game developers</p> -->
				<p class="skiplink"><a href="index.html#start_here">Skip to content</a></p>
			</div>

		
    </div>

			<span class="corners-bottom"><span></span></span></div>
		</div>

		<div class="navbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<ul class="linklist navlinks">
				<li class="icon-home"><a href="../index.html" accesskey="h">Board index</a>  <strong>&#8249;</strong> <a href="../moai-development-forums.html">Moai Development Forums</a> <strong>&#8249;</strong> <a href="../moai-sdk-developer-support.html">Moai SDK Developer Support</a></li>

				<li class="rightside"><a href="index.html#" onclick="fontsizeup(); return false;" onkeypress="return fontsizeup(event);" class="fontsize" title="Change font size">Change font size</a></li>

				<li class="rightside"><a href="http://192.168.20.226:3000/forums/memberlist.php?mode=email&amp;t=1040" title="E-mail friend" class="sendemail">E-mail friend</a></li><li class="rightside"><a href="http://192.168.20.226:3000/forums/viewtopic.php?f=7&amp;t=1040&amp;start=0&amp;view=print" title="Print view" accesskey="p" class="print">Print view</a></li>
			</ul>

			

			<ul class="linklist rightside">
				<li class="icon-faq"><a href="../faq.php.html" title="Frequently Asked Questions">FAQ</a></li>
				
				
			</ul>

			<span class="corners-bottom"><span></span></span></div>
		</div>
	</div>

	<a name="start_here"></a>
	<div id="page-body">
		
<h2><a href="index.html">An inobtrusive cmake build for mingw, osx and linux.</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body --><div style="display: none !important;">Support for using Moai on IOS and Android - post questions, bugs and issues here.<br /></div>

<div class="topic-actions">

	<div class="buttons">
	
	</div>

	
		<div class="pagination">
			15 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	

</div>
<div class="clear"></div>


	<div id="p5548" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 class="first"><a href="index.html#p5548">An inobtrusive cmake build for mingw, osx and linux.</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>shadowmint</strong> &raquo; Thu Jul 26, 2012 2:46 pm </p>

			

			<div class="content"><!-- m --><a class="postlink" href="https://github.com/shadowmint/moai-dev/tree/Version-1.2-Build-56-cmake">https://github.com/shadowmint/moai-dev/ ... d-56-cmake</a><!-- m --><br /><br />Comments welcome.<br /><br />The moai team has seemed reluctant to accept any push requests for cmake because other things are more important, and this does have some side effects (notably to get mingw working the MAC address fetcher is disabled; all calls of alloca have been replaced with malloc for the same reason).... so I haven't bothered with a push request.<br /><br />I expect I'll merge the next tagged release into my own branch when it comes out. <br /><br />Doesn't build android via cmake, and doesn't build the moaitests; that's the next step (I suspect the way openssl and zlib are linked might not be quite right, but it seems to run the samples and tests I've tried ok, so, eh, maybe its fine).<br /><br />Enjoy~<br /><br />Edit: Caveat; I've only actually _built_ this on 64-bit ubuntu; but it's compiling the 3rd party libraries, not using system libraries for pretty much everything, so I don't see why a 32-bit build wouldnt work. NFI about debian, sorry, I don't have a box to test it on, but I think the networking wont compile; might have to use the OSX code for that. (ie. if_dl.h in uslscore/USAdapterInfo_posix.cpp)</div>

			

		</div>

		
			<dl class="postprofile" id="profile5548">
			<dt>
				<strong>shadowmint</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 24</dd><dd><strong>Joined:</strong> Sun May 20, 2012 2:42 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5590" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p5590">Re: An inobtrusive cmake build for mingw, osx and linux.</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>pygy79</strong> &raquo; Fri Jul 27, 2012 3:38 pm </p>

			

			<div class="content">I see you've also added a bunch of free(), that, I suppose, plug memory leaks... It would be nice if you could submit them independently.<br /><br />Did you try to build for iOS, Android and Chrome after your changes?</div>

			

		</div>

		
			<dl class="postprofile" id="profile5590">
			<dt>
				<img src="../download/file.php%253favatar%253d362_1326899945.png" width="73" height="73" alt="User avatar" /><br />
				<strong>pygy79</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 68</dd><dd><strong>Joined:</strong> Wed Jan 04, 2012 10:13 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5604" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p5604">Re: An inobtrusive cmake build for mingw, osx and linux.</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Hach-Que</strong> &raquo; Sat Jul 28, 2012 1:34 am </p>

			

			<div class="content">We're using CMake for the Linux build.<br /><br />However, I think having a cross-platform CMake for other platforms as well is going to either be really complex, really messy or both since Moai is rather complex in terms of what libraries it needs on what platforms.  For now, my guess would be that leaving the existing project infrastructure in place for each platform is a better idea.<br /><br />It means that while yes, they all need to be updated when files are added / removed, it's a lot easier to change project files to ensure that Moai builds on a particular platform without happening to break it on one of the other platforms (for example, I can't build for Mac or mobile devices, so I don't want to break those projects when dev'ing the Linux port).</div>

			<div id="sig5604" class="signature">I'm working on Linux client support for the Moai engine and other things.<br />You can find me on <a href="https://plus.google.com/108898148540815254002" class="postlink">Google+</a>.</div>

		</div>

		
			<dl class="postprofile" id="profile5604">
			<dt>
				<img src="../download/file.php%253favatar%253d124_1327323332.jpg" width="120" height="120" alt="User avatar" /><br />
				<strong>Hach-Que</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 25</dd><dd><strong>Joined:</strong> Sun Apr 10, 2011 1:43 pm</dd><dd><strong>Location:</strong> Australia</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5610" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p5610">Re: An inobtrusive cmake build for mingw, osx and linux.</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>shadowmint</strong> &raquo; Sat Jul 28, 2012 2:01 am </p>

			

			<div class="content">The free() calls are only to match the malloc() calls that replace the inline alloca(), because I could not for the life of me get alloca to work under mingw. Perhaps alloca is more performant than malloc, but if it doesn't compile it can get lost as far as I'm concerned. This is not a memory leak fix.<br /><br />All of the changes to /src/ are because the source wouldnt build under linux or mingw without them. I tried to minimize these to make merging easier:<br /><!-- m --><a class="postlink" href="https://github.com/shadowmint/moai-dev/commit/006ad6beb81db0a5dc785e13b9d1ed71646884dd">https://github.com/shadowmint/moai-dev/ ... 71646884dd</a><!-- m --><br /><!-- m --><a class="postlink" href="https://github.com/shadowmint/moai-dev/commit/b3f19551fdd763c0e33e98fb1ac84219e42f55bb">https://github.com/shadowmint/moai-dev/ ... 19e42f55bb</a><!-- m --><br /><br />The xcode project compiles osx fine; android likewise fine. Chrome I have no idea how to test, and ios I would rather stab myself with a spoon in the eye than bother to touch, so I have no idea, but I imagine given the minimal changes to /src/ that it's fine.</div>

			

		</div>

		
			<dl class="postprofile" id="profile5610">
			<dt>
				<strong>shadowmint</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 24</dd><dd><strong>Joined:</strong> Sun May 20, 2012 2:42 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5611" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p5611">Re: An inobtrusive cmake build for mingw, osx and linux.</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>shadowmint</strong> &raquo; Sat Jul 28, 2012 2:07 am </p>

			

			<div class="content">Re: single build type for each platform.<br /><br />You're welcome to do whatever you want.<br /><br />However, I like having a single project I can clone and build using a single script. I don't want to run visual studio. I don't want to run xcode. I want my code, to compile. That's it. Just compile. <br /><br />Not, oh, but you have to open it up in xcode and setup an xcode project to add your custom extra moai bits into it. <br /><br />Not, oh, you ALSO have to setup a visual studio project and figure out how to do that in your visual studio project as well.<br /><br />I'm already using this cmake build to have a moai binary that automatically locates the encrypted application zip file, load it, extracts the .lua files internally and runs the application when you click on the binary, rather than having a .bat file and .sh file to run moai blah.lua. <br /><br />It's a vastly better experience; it's also a significantly more pain in the ass experience using a bzillion split up build methods.<br /><br />That's why I plan to ADD android support to the cmake build, and NOT to remove any of the other builds from it.<br /><br />However, I realize not everyone shares my views on this; that's why I haven't made a push request. I'm just going to keep maintaining my branch and pulling the mainline tag'd releases into it as then come out.<br /><br />If the core devs decide to merge my changes in, I'll review what they've done and (if like you suggest) they've made cmake into a stand alone linux build, I'll continue to ignore the mainline and maintain my own branch. *shrug*</div>

			

		</div>

		
			<dl class="postprofile" id="profile5611">
			<dt>
				<strong>shadowmint</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 24</dd><dd><strong>Joined:</strong> Sun May 20, 2012 2:42 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5620" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p5620">Re: An inobtrusive cmake build for mingw, osx and linux.</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>pygy79</strong> &raquo; Sat Jul 28, 2012 12:30 pm </p>

			

			<div class="content">Sounds like we rubbed you the wrong way, I'm sure it was not the intent.<br /><br />Your work is definitely be useful. <br /><br />As Hach-Que said,it will probably not be merged upstream in the near future for practical reasons, but that should not deter you from pursuing it (obviously it doesn't).<br /><br />That being said, I would appreciate if you could keep a more civil tone when sharing your thoughts in the forums. You sound very angry...<br /><br />For alloca, what was the problem exactly?</div>

			

		</div>

		
			<dl class="postprofile" id="profile5620">
			<dt>
				<img src="../download/file.php%253favatar%253d362_1326899945.png" width="73" height="73" alt="User avatar" /><br />
				<strong>pygy79</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 68</dd><dd><strong>Joined:</strong> Wed Jan 04, 2012 10:13 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5629" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p5629">Re: An inobtrusive cmake build for mingw, osx and linux.</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>shadowmint</strong> &raquo; Sat Jul 28, 2012 4:27 pm </p>

			

			<div class="content">My apologies if anything I've said has come across as angry or agressive, that's certainly not my intention. I simply have very firm opinions on certain things (apples decision to disallow dynamic libraries like any other sane OS make it a platform I have no interest in touching, autotools is a broken tool that is a best-fit to try to solve cross platform builds in a way that is totally not platform independent). I make no apologies for these opinions, but I'm happy to acknowledge not everyone shares them. <br /><br />Any of my comments regarding merging cmake changes into the mainline are purely because of the statements on the previous push request that got put in, I'm sure you're familiar with it.<br /><br />Anyway, alloca seems to be an undefined symbol for win XP and windows 7; I'm not sure why; it's defined in the headers, but if you grep for the symbol in C:\Mingw\lib\* nothing matches. ?? So all the code with alloca calls in them would compile successfully but fail to link (and obviously because the binary format is incompatible you can't just link against the VC runtime to get that (or any other) symbols. <br /><br />So, short answer: I couldn't figure out how to make it work. After spending 3 days unsuccessfully asking questions in IRC channels I just gave up and replaced the calls with malloc.</div>

			

		</div>

		
			<dl class="postprofile" id="profile5629">
			<dt>
				<strong>shadowmint</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 24</dd><dd><strong>Joined:</strong> Sun May 20, 2012 2:42 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5711" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p5711">Re: An inobtrusive cmake build for mingw, osx and linux.</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>zeldin</strong> &raquo; Wed Aug 01, 2012 11:07 am </p>

			

			<div class="content">alloca can't be implemented as a regular function on most platforms, it's a compiler intrinsic.  So it's not surprising you would not find alloca in lib/*.  If you get references to alloca in your object files, it sounds like a compiler problem.</div>

			

		</div>

		
			<dl class="postprofile" id="profile5711">
			<dt>
				<strong>zeldin</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 5</dd><dd><strong>Joined:</strong> Sun May 13, 2012 2:07 pm</dd><dd><strong>Location:</strong> Linköping</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5733" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p5733">Re: An inobtrusive cmake build for mingw, osx and linux.</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>shadowmint</strong> &raquo; Thu Aug 02, 2012 1:58 am </p>

			

			<div class="content">Hm.... could be; reading a bit about it, it sounds like you're right. The compiler should be inlining it and automagically replacing the alloca calls with an implementation. Absolutely doesn't work on mingw tho, from my tests.<br /><br />Why that is...? who knows. Maybe the mingw GCC compiler is compiled with special flags that disable this behaviour. <br /><br />At a tangible level tho, it doesn't work. If it doesn't work, I can't see any good reason not to replace it with something that does.... (which is what I've done)</div>

			

		</div>

		
			<dl class="postprofile" id="profile5733">
			<dt>
				<strong>shadowmint</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 24</dd><dd><strong>Joined:</strong> Sun May 20, 2012 2:42 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5760" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p5760">Re: An inobtrusive cmake build for mingw, osx and linux.</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>pygy79</strong> &raquo; Fri Aug 03, 2012 10:58 am </p>

			

			<div class="content">Did you see this thread? <!-- m --><a class="postlink" href="http://old.nabble.com/documentation-of-AC_FUNC_ALLOCA-and-mingw-w64-compilers-td33182985.html">http://old.nabble.com/documentation-of- ... 82985.html</a><!-- m --><br /><br />Apparently the -ansi option also influences the behavior of the compiler (or  at it least used to).</div>

			

		</div>

		
			<dl class="postprofile" id="profile5760">
			<dt>
				<img src="../download/file.php%253favatar%253d362_1326899945.png" width="73" height="73" alt="User avatar" /><br />
				<strong>pygy79</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 68</dd><dd><strong>Joined:</strong> Wed Jan 04, 2012 10:13 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5769" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p5769">Re: An inobtrusive cmake build for mingw, osx and linux.</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>shadowmint</strong> &raquo; Sat Aug 04, 2012 3:34 am </p>

			

			<div class="content">interesting. <br /><br />I may revisit this alloca issue again; for the time being (although you wont see any public commits on it) I'm converting all the libraries into core cmake format and dropping automake; as well as allowing the android-cmake port to work, this also seems to work (he said tentatively, in that it almost compiles... <img src="../images/smilies/icon_razz.gif" alt=":P" title="Razz" />) with cmake generated visual studio 2010 projects. <br /><br />If nothing else it seems plausible to wrap dropping alloca in a #ifdef __MINGW__ block until I can figure out how to make alloca work; certainly that post looks spot on, the header is running #define alloca _alloca, and _alloca is coming up as an undefined symbol.</div>

			

		</div>

		
			<dl class="postprofile" id="profile5769">
			<dt>
				<strong>shadowmint</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 24</dd><dd><strong>Joined:</strong> Sun May 20, 2012 2:42 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5783" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p5783">Re: An inobtrusive cmake build for mingw, osx and linux.</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>zeldin</strong> &raquo; Sat Aug 04, 2012 9:16 pm </p>

			

			<div class="content">In that case an #include &lt;malloc.h&gt; should fix the problem, since according to the same post the MinGW malloc.h #defines _alloca as __builtin_alloca, which is the magic function provided by GCC itself.  Good luck!</div>

			

		</div>

		
			<dl class="postprofile" id="profile5783">
			<dt>
				<strong>zeldin</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 5</dd><dd><strong>Joined:</strong> Sun May 13, 2012 2:07 pm</dd><dd><strong>Location:</strong> Linköping</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5784" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p5784">Re: An inobtrusive cmake build for mingw, osx and linux.</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>shadowmint</strong> &raquo; Sun Aug 05, 2012 1:34 am </p>

			

			<div class="content">Thanks~ <br /><br />yeah, sadly, that still didn't work for me. *kicks stone*<br /><br />edit: <br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="v" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">#ifdef __MINGW__</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">#undef alloca</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">#define alloca __builtin_alloca</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">#endif</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl><br /><br />Compiles! ...and crashes. Oh well, I'll have another shot at this if I get time this week.</div>

			

		</div>

		
			<dl class="postprofile" id="profile5784">
			<dt>
				<strong>shadowmint</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 24</dd><dd><strong>Joined:</strong> Sun May 20, 2012 2:42 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5790" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p5790">Re: An inobtrusive cmake build for mingw, osx and linux.</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>zeldin</strong> &raquo; Sun Aug 05, 2012 2:31 pm </p>

			

			<div class="content">Which GCC version are you using?  Some further googling suggests that the alloca implementation for MinGW was broken in some GCC releases between 4.2 and 4.4...</div>

			

		</div>

		
			<dl class="postprofile" id="profile5790">
			<dt>
				<strong>zeldin</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 5</dd><dd><strong>Joined:</strong> Sun May 13, 2012 2:07 pm</dd><dd><strong>Location:</strong> Linköping</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5800" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p5800">Re: An inobtrusive cmake build for mingw, osx and linux.</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>shadowmint</strong> &raquo; Mon Aug 06, 2012 8:13 am </p>

			

			<div class="content">doug@ZED e:/projects/moai-dev/cmake/build<br />$ gcc --version<br />gcc.exe (GCC) 4.6.2<br />Copyright (C) 2011 Free Software Foundation, Inc.<br />This is free software; see the source for copying conditions.  There is NO<br />warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.<br /><br />:/</div>

			

		</div>

		
			<dl class="postprofile" id="profile5800">
			<dt>
				<strong>shadowmint</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 24</dd><dd><strong>Joined:</strong> Sun May 20, 2012 2:42 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<form id="viewtopic" method="post" action="index.html">

	<fieldset class="display-options" style="margin-top: 0; ">
		
	</fieldset>

	</form>
	<hr />


<div class="topic-actions">
	<div class="buttons">
	
	</div>

	
		<div class="pagination">
			15 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	
</div>


	<p></p><p><a href="../moai-sdk-developer-support.html" class="left-box left" accesskey="r">Return to Moai SDK Developer Support</a></p>

	<form method="post" id="jumpbox" action="http://192.168.20.226:3000/forums/viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	
		<fieldset class="jumpbox">
	
			<label for="f" accesskey="j">Jump to:</label>
			<select name="f" id="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">
			
				<option value="-1">Select a forum</option>
			<option value="-1">------------------</option>
				<option value="4">Moai Development Forums</option>
			
				<option value="7" selected="selected">&nbsp; &nbsp;Moai SDK Developer Support</option>
			
				<option value="8">&nbsp; &nbsp;Moai Cloud Developer Support</option>
			
				<option value="9">&nbsp; &nbsp;New Users</option>
			
				<option value="10">&nbsp; &nbsp;Bug Reports</option>
			
				<option value="3">Moai Community Forums</option>
			
				<option value="5">&nbsp; &nbsp;Moai Roadmap</option>
			
				<option value="6">&nbsp; &nbsp;Made With Moai</option>
			
			</select>
			<input type="submit" value="Go" class="button2" />
		</fieldset>
	</form>


	<h3>Who is online</h3>
	<p>Users browsing this forum: No registered users and 1 guest</p>
</div>

<div id="page-footer">

	<div class="navbar">
		<div class="inner"><span class="corners-top"><span></span></span>

		<ul class="linklist">
			<li class="icon-home"><a href="../index.html" accesskey="h">Board index</a></li>
				
			<li class="rightside">All times are UTC </li>
		</ul>

		<span class="corners-bottom"><span></span></span></div>
	</div>
	
	<div class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group<br />Style by <a href="http://www.m-a-styles.de">Marc Alexander</a> &copy;
		<br /><br /><a href="http://www.phpbb-seo.com/" title="Search Engine Optimization"><img src="../images/phpbb-seo.png" alt="phpBB SEO"/></a><br />Time : 0.051s | 11 Queries | GZIP : Off
	</div>
</div>

</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
	
	</div>
	</div>
<div class="nobottomgap"></div>
</div>
<!--- end of box border -->
</div></div>
<!-- -->
<div class="bottom-left"></div><div class="bottom-center"></div><div class="bottom-right"></div>
</div>
<!-- JQuery Pop Up --><!-- PM Popup --><!-- PM Popup end --><!-- Image Popup -->
<div id="popupImage">
	<p id="ImagePopup"></p>
	<a id="popupImageClose">x</a> 
</div>
<!-- Image Popup -->
<div id="backgroundPopup"></div> 
<!-- JQuery Pop Up END -->
</body>
</html>