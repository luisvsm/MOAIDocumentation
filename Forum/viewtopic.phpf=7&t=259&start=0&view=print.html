<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta name="robots" content="noindex" />

<title>Moai Forum | The mobile platform for pro game developers &bull; View topic - Code snips sharing thread</title>

<link href="styles/proFormell/theme/print.css" rel="stylesheet" type="text/css" />
<link type="image/vnd.microsoft.icon" rel="shortcut icon" href="styles/proFormell/theme/images/favicon.ico">
</head>

<body id="phpbb">
<div id="wrap">
	<a id="top" name="top" accesskey="t"></a>

	<div id="page-header">
		<h1>Moai Forum | The mobile platform for pro game developers</h1>
		<p>The mobile platform for pro game developers<br /><a href="index.html">/forums/</a></p>

		<h2>Code snips sharing thread</h2>
		<p><a href="code-snips-sharing-thread-t259/index.html">/forums/code-snips-sharing-thread-t259/</a></p>
	</div>

	<div id="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Mon Dec 12, 2011 3:30 pm</strong></div>
				<div class="author">by <strong>mikea</strong></div>
				<div class="content">We had a great request today to create a place where Moai developers can ask for a sample code snip for a problem they're working on, or share their own samples with the Moai community.  This is the fastest way to start that process, so please feel free to post two kinds of articles here:
<br />
<br />1) Sample code to share and discuss: e.g. "here's how I'm handling isometric tiles and rendering z-order right now."
<br />
<br />2) Please help request: e.g. "I'm not sure what will make for a good way to handle collision detection with >100 objects in the scene. Anyone else dealing with this situation and have a code sample to share?"
<br />
<br />Happy coding.</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Tue Dec 13, 2011 12:34 am</strong></div>
				<div class="author">by <strong>gromina</strong></div>
				<div class="content">@mikea thanks for snippets section
<br />
<br />
<br />
<br />I need help with (un)binding props to each other:
<br />
<br />
<br />
<br />Let's say we have <strong>flag</strong> prop and <strong>vehicle</strong> prop. vehicle is moving so do <strong>flag.</strong> At some moment we want to bind <strong>flag</strong> to <strong>vehicle</strong>. And later we unbinding <strong>flag</strong>
<br />
<br />so steps needed - 
<br />
<br />binding:
<br />
<br /><ol>
<br /><li>convert <strong>flag's</strong> transform into <strong>vehicle</strong> model space (worldToModel for position, but what about rotation and scale?)</li>
<br /><li>bind <strong>flag</strong> to <strong>vehicle</strong> (all clear, just use setAttrLink)</li>
<br /></ol>
<br />then to unbind:
<br />
<br /><ol>
<br /><li>convert <strong>flag's</strong> local coordinates into world space (looks like getWorldDir/Loc will work fine)</li>
<br /><li>unbind (use clearAttrLink here )</li>
<br /></ol>
<br />So actually my question is - what is the proper way to convert Prop's rotation/scale into other Prop's model space? <img src="http://192.168.20.226:3000/wp-content/forum-smileys/sf-smile.gif" alt="Smile" /></div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Tue Dec 13, 2011 11:25 am</strong></div>
				<div class="author">by <strong>gromina</strong></div>
				<div class="content"><strong>binding/unbinding Prop2D to Box2DBody.</strong>
<br />
<br />
<br />
<br />Finally got it working but used all my magic skills<img src="http://192.168.20.226:3000/wp-content/forum-smileys/sf-laugh.gif" alt="Laugh" />
<br />
<br />
<br />
<br /><a href="http://pastebin.com/3cY9W8C8" target="_blank">http://pastebin.com/3cY9W8C8</a>
<br />
<br />
<br />
<br />Have you got any ideas where that magic come from? Are there better solutions? Pity, I couldn't use worldToModel since Box2D has no that method.
<br />
<br />
<br />
<br />P.S. How to embed source code directly into forum?</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Wed Dec 14, 2011 12:42 am</strong></div>
				<div class="author">by <strong>patrick</strong></div>
				<div class="content">Haven't had time to look into why the magic works.
<br />
<br />To handle generalized bind/unbind I'd need to expose shear. You can wind up with a situation where a child transform gets rotated and scaled by its parent, then rotates itself again. When you unbind you can get a funky sheared transform. (More specifically: any rotation is a shear derived from the given angle.)
<br />
<br />To handle things properly I'd need to store the shear instead of the rotation. I could continue to model rotation as a virtual attribute, but the 'what do you mean?' problem then arises when you go to get the rotation for a transform.
<br />
<br />Let me ponder it a bit more and see what it would take to either handle the generalized case or give you a better workaround.</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Fri Dec 16, 2011 7:40 am</strong></div>
				<div class="author">by <strong>develop</strong></div>
				<div class="content">Here's our reference implementation of a very basic scene manager:
<br />
<br /><a href="https://github.com/reflare/Moai-Libraries/tree/master/scene" rel="nofollow" target="_blank">https://github.com/reflare/Moai-Libraries/tree/master/scene</a></div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Sat Dec 17, 2011 2:14 pm</strong></div>
				<div class="author">by <strong>bonozogames</strong></div>
				<div class="content">I actually believe for Code Snippets, a Wiki would work better, or here in the forum, where each problem can have it's own thread.  To combine multiple issues in one thread could make it too long to be practical, and with multiple issues going on could even be hard to follow.  It may eventually stop growing, and it will just sit pinned on the top, over-powering new and bumped posts.  Just feedback, the Moai Team is top-notch!</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Sun Dec 18, 2011 1:11 am</strong></div>
				<div class="author">by <strong>gromina</strong></div>
				<div class="content">I'm sure when they'll got time to answer previous questions, they then port this thread to wiki :)
<br />
<br />
<br />
<br />At the same time, here is new snippet:
<br />
<br />
<br />
<br /><a href="http://pastebin.com/A6iWQ9tK" target="_blank">http://pastebin.com/A6iWQ9tK</a>
<br />
<br />
<br />
<br />maybe it'll help someone. It compiles lua files using moai SDK itself (so you're sure lua version is the same)</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Mon Dec 19, 2011 3:18 am</strong></div>
				<div class="author">by <strong>anddrewscott</strong></div>
				<div class="content"><a href="http://192.168.20.226:3000/wiki/Code_snips" target="_blank">/wiki/Code_snips</a></div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Mon Dec 19, 2011 5:16 am</strong></div>
				<div class="author">by <strong>gromina</strong></div>
				<div class="content">Is it possible to make same login/password for forum and wiki?</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Tue Dec 20, 2011 2:48 am</strong></div>
				<div class="author">by <strong>milleniummike</strong></div>
				<div class="content">I agree.. having a forum and wiki with different user details is confusing.
<br />
<br />
<br />
<br />In fact I can't work out how to get a user account on the wiki? It isn't linked to the wordpress forum and there is no option to sign up for an account..... <a href="http://192.168.20.226:3000/forums/UserLogin/signup" target="_blank">/wiki/Specia.....gin/signup</a>
<br />
<br />
<br />
<br />In an ideal world there would be 1 forum with the ability to store documentation and code (ie syntax aware) posts (not using pastebin)
<br />
<br />
<br />
<br />In the meantime I'll keep dropping any useful "gems" or code snippets into pastebin and reference them from this forum.
<br />
<br />
<br />
<br />Maybe it makes sense to create a "Code Snippet" section under "Moai Development Forums" for the purpose?</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Wed Dec 21, 2011 12:11 pm</strong></div>
				<div class="author">by <strong>mikea</strong></div>
				<div class="content">Thanks for the thoughts.  Our goal is to get to a single OpenID login for everything on getmoai.com.  We're in progress on a new web site architecture right now.
<br />
<br />Mike.</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Tue Dec 27, 2011 2:38 pm</strong></div>
				<div class="author">by <strong>bonozogames</strong></div>
				<div class="content">@andrew, how were you able to edit the Wiki?  I was unable to create an account:
<br />
<br /><blockquote>
<br />You do not have permission to create this user account, for the following reason:
<br />The action you have requested is limited to users in the group: <a class="new" title="Moai Wiki:Administrators (page does not exist)" href="http://192.168.20.226:3000/forums/Administrators&amp;action=edit&amp;redlink=1" target="_blank">Administrators</a>.
<br />
<br /></blockquote></div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Tue Dec 27, 2011 3:21 pm</strong></div>
				<div class="author">by <strong>anddrewscott</strong></div>
				<div class="content">Send an email to:
<br />
<br />mike at ziplinegames dot com
<br />
<br /> or 
<br />
<br />getmoai at getmoai dot com
<br />
<br />
<br />
<br />and ask for an account</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Wed Dec 28, 2011 12:21 am</strong></div>
				<div class="author">by <strong>gromina</strong></div>
				<div class="content">Need sample and/or tutorial on how to run compiled lua code.
<br />
<br />
<br />
<br />Still need explanation on props (un)binding (upper this thread)
<br />
<br />
<br />
<br /><img src="http://192.168.20.226:3000/wp-content/forum-smileys/sf-wink.gif" alt="Wink" />
<br />
<br />P.S. This forum have not so many people, guess it is reasonable to make wiki registration open (or open+approval from administrators) This SDK is hardly lacking documentation</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Wed Dec 28, 2011 6:19 pm</strong></div>
				<div class="author">by <strong>patrick</strong></div>
				<div class="content">@gromina I haven't forgotten - just swamped. I have a note to look into a more generalized transformation bind/unbind in my todo list; will revisit the issue then. Is your workaround OK for now, or are you blocked on this?</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Thu Dec 29, 2011 8:33 am</strong></div>
				<div class="author">by <strong>gromina</strong></div>
				<div class="content">It is not a blocker for me at all. I'm fine with current code.
<br />
<br />Lua compilation pipeline is higher priority for now for me.</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Thu Dec 29, 2011 9:10 am</strong></div>
				<div class="author">by <strong>bonozogames</strong></div>
				<div class="content">I can look into this, I have quite a bit of lua experience.  But before I begin, what is the issue now when (1) you compile and (2) execute the compiled code?</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Thu Dec 29, 2011 9:33 am</strong></div>
				<div class="author">by <strong>gromina</strong></div>
				<div class="content"> I'm not so confident with lua. And because of this simply can't catch the pipeline.
<br />
<br />
<br />
<br />1. I develop using pure lua code
<br />
<br />2. at some moment i should compile sources and pack the release project. 
<br />
<br />
<br />
<br />Optimal Scheme is just compiling without changing code and removing *.lua
<br />
<br />But it seems 'require' do not work with compiled code and i need to make 'dofile' instead. Correct me if I'm wrong</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Thu Dec 29, 2011 10:53 am</strong></div>
				<div class="author">by <strong>bonozogames</strong></div>
				<div class="content"><strong>Compiling Moai Lua Example:</strong>
<br />
<br />1) Install <a href="http://code.google.com/p/luaforwindows/downloads/list" target="_blank">lua5.1.4-45</a>
<br />2) At top of main.lua:
<br />
<br /><blockquote>
<br />
<br />package.path = "?<strong>.luo</strong>"
<br />
<br />require ( "util" )
<br />require ( "game" )
<br />
<br />…
<br />
<br /></blockquote>
<br />3) Compile each .lua with "lua -o <em>filename</em><strong>.luo</strong> <em>filename</em>.lua"
<br />4) "del *.lua", for this <em>test.</em>
<br />5) Execute run.bat with .luo:
<br />
<br /><blockquote>
<br />
<br />. . / . . / . . / . . /bin/win32/moai.exe ". . / . . / . . /config/config.lua" "main<strong>.luo</strong>" 
<br />
<br /></blockquote>
<br />
<br />
<br /><strong>NOTES:</strong>
<br />
<br />1) Use "require", <em>not </em>"dofile"
<br />2) Do <em>not </em>use an extension in the require (ex. "util", not "util.lua")
<br />3) The trick here is setting "package.path".  Often people use ".[backslash]?.luo" instead (may need 2 backslashes for string)
<br />4) I prefer <strong>.luo</strong> over <strong>.luac</strong>, but .luac in all places of .luo, will work.
<br />5) I ran this on Win32 only (i.e. not iOS)
<br />6) Your <a href="http://pastebin.com/A6iWQ9tK" target="_blank">recursive compiling script</a> looks awesome, but I did not try it, in this first attempt.  I may actually give it a whirl.
<br />7) Though this step-by-step shows only 2+ requires, my actual test project had <strong>15</strong>, all sharing globals. (i.e. a good test)
<br />8) Section <a href="http://www.lua.org/manual/5.1/manual.html" target="_blank">5.3 Modules</a> explains in detail.  You may not want to use such a brute force package.path setting if you require other modules, etc. 
<br />9) I did not review the need to compile ". . / . . / . . /config/config.lua"
<br />10) Set package.path to "?.<strong>lua</strong>;?.<strong>luo</strong>" to support script and compiled (i.e. development)
<br />11) This forum editor has issues with 2 dots and backslashes, so do not copy/paste any without fixing-up. </div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Code snips sharing thread</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Thu Dec 29, 2011 11:33 am</strong></div>
				<div class="author">by <strong>gromina</strong></div>
				<div class="content">@bonzo thanks a lot for your detailed post. It is a real useful snippet!
<br />
<br />I'll try this in a week or two. </div>
			</div>
			<hr />
		
	</div>

	<div id="page-footer">
		<div class="page-number">All times are UTC <br />Page <strong>1</strong> of <strong>1</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</div>
	</div>
</div>

</body>
</html>