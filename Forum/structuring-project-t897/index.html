<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>Moai Forum &bull; View topic - Structuring Project</title>

<link rel="alternate" type="application/atom+xml" title="Feed - Moai Forum" href="../feed.php.html" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="../feed.php%3Fmode=forums.html" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="../feed.php%3Fmode=topics.html" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="../feed.php%3Fmode=topics_active.html" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - Questions and Tips" href="../feed.php%3Ff=9.html" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - Structuring Project" href="http://192.168.20.226:3000/forums/feed.php?f=9&amp;t=897" />

<!--
	phpBB style name: proFormell
	Based on style:   prosilver (this is the default phpBB3 style)
	Inspired by:	  Formell (Joomla Style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  	  Marc Alexander
	
	NOTE: This page was generated by phpBB, the free open-source bulletin board package.
	      The phpBB Group is not responsible for the content of this page and forum. For more information
	      about phpBB please visit http://www.phpbb.com
-->

<script type="text/javascript">
// <![CDATA[
	var jump_page = 'Enter the page number you wish to go to:';
	var on_page = '1';
	var per_page = '';
	var base_url = '';
	var style_cookie = 'phpBBstyle';
	var style_cookie_settings = '; path=/';
	var onload_functions = new Array();
	var onunload_functions = new Array();
	var is_ie6 = false;

	/**
	* Find a member
	*/
	function find_username(url)
	{
		popup(url, 760, 570, '_usersearch');
		return false;
	}

	/**
	* New function for handling multiple calls to window.onload and window.unload by pentapenguin
	*/
	window.onload = function()
	{
		for (var i = 0; i < onload_functions.length; i++)
		{
			eval(onload_functions[i]);
		}
	}

	window.onunload = function()
	{
		for (var i = 0; i < onunload_functions.length; i++)
		{
			eval(onunload_functions[i]);
		}
	}

// ]]>
</script>
<!--[if lt IE 7]>
<script type="text/javascript">
// <![CDATA[
var is_ie6 = true;
// ]]>
</script>
<![endif]-->


<link href="../styles/proFormell/theme/print.css" rel="stylesheet" type="text/css" media="print" title="printonly" />

<link href="../style.css" rel="stylesheet" type="text/css" media="screen, projection" />



<link href="../styles/proFormell/theme/images/favicon.ico" rel="shortcut icon" />

<script type="text/javascript" src="../styles/prosilver/template/forum_fn.js"></script>
<script src="../styles/prosilver/template/jquery-1.4.4.min.js" type="text/javascript"></script>

<script type="text/javascript">
// <![CDATA[
/**
* New pop-up functions
* based on  http://yensdesign.com/2008/09/how-to-create-a-stunning-and-smooth-popup-using-jquery/
*/

//SETTING UP OUR POPUP
//0 means disabled; 1 means enabled;
var popupStatus = 0;
var openPopup = '';

//loading popup with jQuery magic!
function loadPopup()
{
	//loads popup only if it is disabled
	if(popupStatus==0)
	{
		$('#backgroundPopup').css({'opacity': '0.7'});
		// Now let's make sure we actually see the image
		var scroll = $(window).scrollTop();
		$('#popupPM').animate({marginTop: scroll}, 'fast', function() {
			// Animation complete.
			});
		$('#backgroundPopup').fadeIn('slow');
		$('#popupPM').fadeIn('slow');
		popupStatus = 1;
		openPopup = 'PM';
	}
}

//disabling popup with jQuery magic!
function disablePopup()
{
	//disables popup only if it is enabled
	if(popupStatus==1 && openPopup == 'PM')
	{
		$('#backgroundPopup').fadeOut('slow');
		$('#popupPM').fadeOut('slow');
		popupStatus = 0;
		openPopup = '';
	}
}

//centering popup
function centerPopup()
{
	//request data for centering
	var windowWidth = document.documentElement.clientWidth;
	var windowHeight = document.documentElement.clientHeight;
	var popupHeight = $('#popupPM').height();
	var popupWidth = $('#popupPM').width();
	//centering
	$('#popupPM').css({
	'position': 'absolute',
	'top': windowHeight/2-popupHeight/2,
	'left': windowWidth/2-popupWidth/2
	});
	//only need force for IE6
	$('#backgroundPopup').css({'height': windowHeight});
}

$(document).ready(function(){
	
	resize_images();
	
	
	// IE6 and below PNG fix (not really)
	if(is_ie6)
	{
		replace_png();
	}
	
	//CLOSING POPUP
	//Click the x event!
	$('#popupPMClose').click(function(){
		disablePopup();
	});
	//Click out event!
	$('#backgroundPopup').click(function(){
		disablePopup();
		disableImage();
	});
	//Press Escape event!
	$(document).keypress(function(e){
		if(e.keyCode==27 && popupStatus==1)
		{
			disablePopup();
			disableImage();
		}
	});
	
	
	// Image popup
	$('img', 'dt.attach-image').click(function(){
		image_load($(this).attr('src'), $(this).attr('alt'));
		centerImage();
	});
	
	$('.content img').click(function(){
		var check = $(this).parent().hasClass('content');
		if(check)
		{
			image_load($(this).attr('src'), $(this).attr('alt'));
			centerImage();
		}
	});
	
	// Closing Image popup
	//Click the x event!
	$('#popupImageClose').click(function(){
		disableImage();
	});
	
	//Click image box event
	$('#popupImage').click(function(){
		disableImage();
	});
	
	//Click image event
	$('#ImagePopup img').click(function(){
		disableImage();
	});
	

});

/**
* Replaces weird looking PNG files with the respectie GIF file
* Only run this if the browser is IE6 or below
*/
function replace_png()
{
	// Fix Logo
	var str = $('#logo img').attr('src'); 
	$('#logo img').attr('src', str.substring(0, str.length - 3) + 'gif');
	
	// Fix forum icons
	$('dl.icon').each(function() {
		var str = $(this).css('background-image');
		if(str != '')
		{
			$(this).css('background-image', str.substring(0, str.length - 5) + 'gif")');
		}
	});
}


/**
* Image resizer
*/
function resize_images()
{
	var hello = $('dl.attachbox dd dl.file dt.attach-image img').innerWidth();
	var maxWidth = $('div.content').innerWidth() - 30;
	
	// resize the attached images
	$('img', 'dt.attach-image').each(function(i){
		// check the width of the image
		if ($(this).width() > maxWidth)
		{
			// calculate new image dimensions
			newWidth = maxWidth;
			newHeight = $(this).height() / ( $(this).width() / maxWidth );
			   
			// set new image dimensions
			$(this).height(newHeight).width(newWidth);
		}
	});
	
	// resize the images that were added via [img] bbcode
	$('img', 'div.content').each(function(i){
		// check the width of the image
		$(this).css('max-width', maxWidth); // fix for IE
		if ($(this).width() > maxWidth)
		{
			// calculate new image dimensions
			newWidth = maxWidth;
			newHeight = $(this).height() / ( $(this).width() / maxWidth );
			   
			// set new image dimensions
			$(this).height(newHeight).width(newWidth);
		}
	});
}

/**
* Image pop-up
*/
function image_load(src, alt)
{
	//loads popup only if it is disabled
	if(popupStatus==0)
	{
		$('#ImagePopup').html('<img id="imgpopup" src="http://192.168.20.226:3000/forums/structuring-project-t897/'&#32;+&#32;src&#32;+&#32;'" alt="' + alt + '" />');
		var windowWidth = document.documentElement.clientWidth;
		var windowHeight = document.documentElement.clientHeight;
		var maxWidth = windowWidth * 0.85;
		var maxHeight = windowHeight * 0.85;
		$('#popupImage img').css('max-width', maxWidth);
		$('#popupImage img').css('max-height', maxHeight);
		$('#backgroundPopup').css({'opacity': '0.7'});
		// Now let's make sure we actually see the image
		var scroll = $(window).scrollTop();
		$('#popupImage').animate({marginTop: scroll}, 'fast', function() {
			// Animation complete.
			});
		$('#backgroundPopup').fadeIn('slow');
		$('#popupImage').fadeIn('slow');
		popupStatus = 1;
		openPopup = 'Image';
	}
}

//centering popup
function centerImage()
{
	//request data for centering
	var windowWidth = document.documentElement.clientWidth;
	var windowHeight = document.documentElement.clientHeight;
	var popupHeight = $('#popupImage').height();
	var popupWidth = $('#popupImage').width();
	var newTop = windowHeight/2-popupHeight/2;
	var newLeft = windowWidth/2-popupWidth/2;
	//centering
	$('#popupImage').css({
	'position': 'absolute',
	'top': newTop,
	'left': newLeft
	});
	
	//only need force for IE6
	$('#backgroundPopup').css({'height': windowHeight});
}

//disabling popup with jQuery magic!
function disableImage()
{
	//disables popup only if it is enabled
	if(popupStatus==1 && openPopup == 'Image')
	{
		$('#backgroundPopup').fadeOut('slow');
		$('#popupImage').fadeOut('slow');
		popupStatus = 0;
		openPopup = '';
	}
}


// ]]>
</script>

</head>

<body id="phpbb" class="section-viewtopic ltr">
<!--- box border START -->
<div id="box">

<div class="top-left"></div><div class="top-center"></div><div class="top-right"></div>
<div id="left-border">
<div id="right-border">


<!--- box border END -->
<div class="inside">
 <div class="notopgap">
<div id="wrap">
	<a id="top" name="top" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar">
			<div class="inner"><!-- <span class="corners-top"><span></span></span> -->
			<div style="height: 140px ;">
			<div id="site-description">
				<div class="header-pad"><a href="http://getmoai.com" title="" id="logo"><img src="../styles/proFormell/imageset/site-logo.png" width="410" height="98" alt="" title="" /></a></div>
			
		<!--		<p class="site-desc">The mobile platform for pro game developers</p> -->
				<p class="skiplink"><a href="index.html#start_here">Skip to content</a></p>
			</div>

		
    </div>

			<span class="corners-bottom"><span></span></span></div>
		</div>

		<div class="navbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<ul class="linklist navlinks">
				<li class="icon-home"><a href="../index.html" accesskey="h">Board index</a>  <strong>&#8249;</strong> <a href="../moai-development-forums.html">Moai Development Forums</a> <strong>&#8249;</strong> <a href="../new-users.html">Questions and Tips</a></li>

				<li class="rightside"><a href="index.html#" onclick="fontsizeup(); return false;" onkeypress="return fontsizeup(event);" class="fontsize" title="Change font size">Change font size</a></li>

				<li class="rightside"><a href="http://192.168.20.226:3000/forums/memberlist.php?mode=email&amp;t=897" title="E-mail friend" class="sendemail">E-mail friend</a></li><li class="rightside"><a href="http://192.168.20.226:3000/forums/viewtopic.php?f=9&amp;t=897&amp;start=0&amp;view=print" title="Print view" accesskey="p" class="print">Print view</a></li>
			</ul>

			

			<ul class="linklist rightside">
				<li class="icon-faq"><a href="../faq.php.html" title="Frequently Asked Questions">FAQ</a></li>
				
				
			</ul>

			<span class="corners-bottom"><span></span></span></div>
		</div>
	</div>

	<a name="start_here"></a>
	<div id="page-body">
		
<h2><a href="index.html">Structuring Project</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body --><div style="display: none !important;">New to Moai? Get started here with our best tips and tutorials.<br /></div>
	<p>
		
			<strong>Moderator:</strong> DanielWolf
		

	</p>


<div class="topic-actions">

	<div class="buttons">
	
	</div>

	
		<div class="pagination">
			13 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	

</div>
<div class="clear"></div>


	<div id="p4662" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 class="first"><a href="index.html#p4662">Structuring Project</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Jay</strong> &raquo; Mon Jun 18, 2012 3:45 am </p>

			

			<div class="content">Hello, I am new to both Moai and Lua. The main languages I know are C++ and Objective-C.<br /><br />Anyway, I am just not sure how to structure projects in Moai/Lua, and there doesn't seem to be much relevant (somewhat large) sample code or tutorials. I did read through this thread: <!-- l --><a class="postlink-local" href="../organising-a-large-moai-project-s-functionality-what-approaches-are-people-using-t172/index.html">organising-a-large-moai-project-s-functionality-what-approaches-are-people-using-t172/</a><!-- l --><br /><br />Right now, I am trying to figure out the best way to do the following:<br />Simple world with a tile background.<br />The world will have static objects.<br />There will also be dynamic objects, that have different behaviors, always with one current behavior.<br />These objects, depending on their current behavior, will query the world for other (dynamic/static) objects. The object will then move to the other object, and interact with the other object in some way. The object will then select another one of its behaviors, and start over.<br /><br />I really have no idea how to implement this, so any help would be appreciated.</div>

			

		</div>

		
			<dl class="postprofile" id="profile4662">
			<dt>
				<strong>Jay</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 14</dd><dd><strong>Joined:</strong> Mon Jun 18, 2012 3:20 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4694" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4694">Re: Structuring Project</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>sgeos</strong> &raquo; Mon Jun 18, 2012 2:43 pm </p>

			

			<div class="content">Start by learning how to use Lua <a href="http://www.lua.org/manual/5.1/manual.html#5.3" class="postlink">modules</a>.  They are covered in the Lua 5.1 <a href="http://www.lua.org/manual/5.1/manual.html" class="postlink">manual</a>.  Here is a list of the modules in my project:<br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="text" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">Background.lua&nbsp; Character.lua &nbsp; GetInput.lua&nbsp; &nbsp; Sound.lua &nbsp; &nbsp; &nbsp; Stage.lua &nbsp; &nbsp; &nbsp; State.lua &nbsp; &nbsp; &nbsp; Title.lua &nbsp; &nbsp; &nbsp; main.lua</div></li><br /></ol></code></dd></dl><br />My main module looks like this:<br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- Program State</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> state <span style="color: #66cc66;">=</span> State<span style="color: #66cc66;">.</span>new<span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;Name of Game&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">60</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">:</span>init<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- Debug</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> <span style="color: #0000aa;">debug</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; MOAIDebugLines<span style="color: #66cc66;">.</span>setStyle <span style="color: #66cc66;">&#40;</span> MOAIDebugLines<span style="color: #66cc66;">.</span>PROP_MODEL_BOUNDS<span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">2</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">1</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; MOAIDebugLines<span style="color: #66cc66;">.</span>setStyle <span style="color: #66cc66;">&#40;</span> MOAIDebugLines<span style="color: #66cc66;">.</span>PROP_WORLD_BOUNDS<span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">2</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">0.75</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">0.75</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">0.75</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- Main Loop</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> mainLoop<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; MOAIUntzSystem<span style="color: #66cc66;">.</span>initialize<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #0000aa;">debug</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">while</span> <span style="color: #aa9900;">true</span> <span style="color: #aa9900; font-weight: bold;">do</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; Title<span style="color: #66cc66;">.</span>loop<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; Stage<span style="color: #66cc66;">.</span>loop<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">7</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- Start Program</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">mainThread <span style="color: #66cc66;">=</span> MOAIThread<span style="color: #66cc66;">.</span>new<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">mainThread<span style="color: #66cc66;">:</span>run<span style="color: #66cc66;">&#40;</span> mainLoop<span style="color: #66cc66;">,</span> state <span style="color: #66cc66;">&#41;</span></div></li><br /></ol></code></dd></dl><br />Title.loop() and Stage.loop() run the title screen and game screen respectively.  Here is a slightly abridged version of Title.lua:<br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">module <span style="color: #66cc66;">&#40;</span> <span style="color: #66cc66;">...,</span> package<span style="color: #66cc66;">.</span>seeall <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000aa;">require</span> <span style="color: #ff6666;">&quot;State&quot;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000aa;">require</span> <span style="color: #ff6666;">&quot;Background&quot;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000aa;">require</span> <span style="color: #ff6666;">&quot;GetInput&quot;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000aa;">require</span> <span style="color: #ff6666;">&quot;Sound&quot;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> loadBackground<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> result <span style="color: #66cc66;">=</span> Background<span style="color: #66cc66;">.</span>loadImage<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">,</span> <span style="color: #ff6666;">&quot;title.png&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">.</span>prop<span style="color: #66cc66;">:</span>moveLoc <span style="color: #66cc66;">&#40;</span> <span style="color: #cc66cc;">0</span><span style="color: #66cc66;">,</span> <span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">.</span>scaleX <span style="color: #66cc66;">-</span> pState<span style="color: #66cc66;">.</span>scaleY<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">/</span> <span style="color: #cc66cc;">2</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">0</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> result</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> loadButton<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">,</span> pLayer<span style="color: #66cc66;">,</span> pPartition<span style="color: #66cc66;">,</span> pTileset<span style="color: #66cc66;">,</span> pIndex<span style="color: #66cc66;">,</span> pX<span style="color: #66cc66;">,</span> pY<span style="color: #66cc66;">,</span> pCenterX<span style="color: #66cc66;">,</span> pCenterY<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> result <span style="color: #66cc66;">=</span> MOAIProp2D<span style="color: #66cc66;">.</span>new <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">:</span>setDeck <span style="color: #66cc66;">&#40;</span> pTileset <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">:</span>setAttr <span style="color: #66cc66;">&#40;</span> MOAIProp2D<span style="color: #66cc66;">.</span>ATTR_INDEX<span style="color: #66cc66;">,</span> pIndex <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; pLayer<span style="color: #66cc66;">:</span>insertProp <span style="color: #66cc66;">&#40;</span> result <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">:</span>setPiv<span style="color: #66cc66;">&#40;</span> pX<span style="color: #66cc66;">,</span> pY <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">:</span>setLoc<span style="color: #66cc66;">&#40;</span> pCenterX<span style="color: #66cc66;">,</span> pCenterY <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; pPartition<span style="color: #66cc66;">:</span>insertProp<span style="color: #66cc66;">&#40;</span> result <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> result</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> loadButtonPlay<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">,</span> pLayer<span style="color: #66cc66;">,</span> pPartition<span style="color: #66cc66;">,</span> pTileset<span style="color: #66cc66;">,</span> pScaleW<span style="color: #66cc66;">,</span> pScaleH<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> index &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">10</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> x<span style="color: #66cc66;">,</span> y &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">0</span><span style="color: #66cc66;">,</span> <span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">.</span>scaleY <span style="color: #66cc66;">/</span> <span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">-</span> <span style="color: #66cc66;">&#40;</span>pScaleH <span style="color: #66cc66;">/</span> <span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> centerX<span style="color: #66cc66;">,</span> centerY <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">0</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">0</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> result <span style="color: #66cc66;">=</span> loadButton<span style="color: #66cc66;">&#40;</span> pState<span style="color: #66cc66;">,</span> pLayer<span style="color: #66cc66;">,</span> pPartition<span style="color: #66cc66;">,</span> pTileset<span style="color: #66cc66;">,</span> index<span style="color: #66cc66;">,</span> x<span style="color: #66cc66;">,</span> y<span style="color: #66cc66;">,</span> centerX<span style="color: #66cc66;">,</span> centerY <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> result</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> loadButtons<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">,</span> pUI<span style="color: #66cc66;">,</span> pScaleW<span style="color: #66cc66;">,</span> pScaleH<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> result &nbsp; <span style="color: #66cc66;">=</span> pUI</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">.</span>button &nbsp;<span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">.</span>button<span style="color: #66cc66;">.</span>play &nbsp; &nbsp; &nbsp;<span style="color: #66cc66;">=</span> loadButtonPlay<span style="color: #66cc66;">&#40;</span> pState<span style="color: #66cc66;">,</span> result<span style="color: #66cc66;">.</span>layer<span style="color: #66cc66;">,</span> result<span style="color: #66cc66;">.</span>partition<span style="color: #66cc66;">,</span> result<span style="color: #66cc66;">.</span>tileset<span style="color: #66cc66;">,</span> pScaleW<span style="color: #66cc66;">,</span> pScaleH <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> result</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> loadUI<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> result &nbsp; <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> tilesetW <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">4</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> tilesetH <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">8</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> scaleW &nbsp; <span style="color: #66cc66;">=</span> pState<span style="color: #66cc66;">.</span>scaleX <span style="color: #66cc66;">/</span> tilesetW</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> scaleH &nbsp; <span style="color: #66cc66;">=</span> pState<span style="color: #66cc66;">.</span>scaleX <span style="color: #66cc66;">/</span> tilesetH</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #808080; font-style: italic;">-- File Name</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">.</span>fileName <span style="color: #66cc66;">=</span> <span style="color: #ff6666;">&quot;buttons.png&quot;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #808080; font-style: italic;">-- Tileset</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">.</span>tileset &nbsp;<span style="color: #66cc66;">=</span> MOAITileDeck2D<span style="color: #66cc66;">.</span>new <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">.</span>tileset<span style="color: #66cc66;">:</span>setTexture <span style="color: #66cc66;">&#40;</span> result<span style="color: #66cc66;">.</span>fileName <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">.</span>tileset<span style="color: #66cc66;">:</span>setSize <span style="color: #66cc66;">&#40;</span> tilesetW<span style="color: #66cc66;">,</span> tilesetH <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">.</span>tileset<span style="color: #66cc66;">:</span>setRect <span style="color: #66cc66;">&#40;</span> <span style="color: #66cc66;">-</span>scaleW<span style="color: #66cc66;">/</span><span style="color: #cc66cc;">2</span><span style="color: #66cc66;">,</span> <span style="color: #66cc66;">-</span>scaleH<span style="color: #66cc66;">/</span><span style="color: #cc66cc;">2</span><span style="color: #66cc66;">,</span> scaleW<span style="color: #66cc66;">/</span><span style="color: #cc66cc;">2</span><span style="color: #66cc66;">,</span> scaleH<span style="color: #66cc66;">/</span><span style="color: #cc66cc;">2</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #808080; font-style: italic;">-- Layer</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">.</span>layer <span style="color: #66cc66;">=</span> MOAILayer2D<span style="color: #66cc66;">.</span>new <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">.</span>layer<span style="color: #66cc66;">:</span>setViewport <span style="color: #66cc66;">&#40;</span> pState<span style="color: #66cc66;">.</span>viewport <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">.</span>layer<span style="color: #66cc66;">:</span>setCamera <span style="color: #66cc66;">&#40;</span> pState<span style="color: #66cc66;">.</span>camera <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; MOAISim<span style="color: #66cc66;">.</span>pushRenderPass <span style="color: #66cc66;">&#40;</span> result<span style="color: #66cc66;">.</span>layer <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #808080; font-style: italic;">-- Partition</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">.</span>partition <span style="color: #66cc66;">=</span> MOAIPartition<span style="color: #66cc66;">.</span>new <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">.</span>layer<span style="color: #66cc66;">:</span>setPartition <span style="color: #66cc66;">&#40;</span> result<span style="color: #66cc66;">.</span>partition <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #808080; font-style: italic;">-- Buttons</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; loadButtons<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">,</span> result<span style="color: #66cc66;">,</span> scaleW<span style="color: #66cc66;">,</span> scaleH<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #808080; font-style: italic;">-- Done</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> result</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> update<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">,</span> pBackground<span style="color: #66cc66;">,</span> pUI<span style="color: #66cc66;">,</span> pBGM<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #808080; font-style: italic;">-- Get Input</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> touch<span style="color: #66cc66;">,</span> x<span style="color: #66cc66;">,</span> y <span style="color: #66cc66;">=</span> GetInput<span style="color: #66cc66;">.</span>touch<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #808080; font-style: italic;">-- Process Input</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> done <span style="color: #66cc66;">=</span> <span style="color: #aa9900;">false</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> pick</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">if</span> touch <span style="color: #aa9900; font-weight: bold;">then</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; pick <span style="color: #66cc66;">=</span> pUI<span style="color: #66cc66;">.</span>partition<span style="color: #66cc66;">:</span>propForPoint <span style="color: #66cc66;">&#40;</span> pUI<span style="color: #66cc66;">.</span>layer<span style="color: #66cc66;">:</span>wndToWorld <span style="color: #66cc66;">&#40;</span> x<span style="color: #66cc66;">,</span> y <span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">-- print(&quot;Touch&quot;, x, y)</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">-- if pick then print(&quot;Pick&quot;, pick) end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">if</span> pick <span style="color: #aa9900; font-weight: bold;">then</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; Sound<span style="color: #66cc66;">.</span>playSFX<span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">'button.mp3'</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">if</span> pick <span style="color: #66cc66;">==</span> pUI<span style="color: #66cc66;">.</span>button<span style="color: #66cc66;">.</span>play <span style="color: #aa9900; font-weight: bold;">then</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; done <span style="color: #66cc66;">=</span> <span style="color: #aa9900;">true</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #808080; font-style: italic;">-- Done</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> done</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- State Loop</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> loop<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> background <span style="color: #66cc66;">=</span> loadBackground<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> ui &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">=</span> loadUI<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> bgm &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #66cc66;">=</span> Sound<span style="color: #66cc66;">.</span>playBGM<span style="color: #66cc66;">&#40;</span> <span style="color: #ff6666;">'title.mp3'</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> done &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">=</span> <span style="color: #aa9900;">false</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">while</span> <span style="color: #aa9900; font-weight: bold;">not</span> done <span style="color: #aa9900; font-weight: bold;">do</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #0000aa;">coroutine.yield</span> <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; done <span style="color: #66cc66;">=</span> update<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">,</span> background<span style="color: #66cc66;">,</span> ui<span style="color: #66cc66;">,</span> bgm<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /></ol></code></dd></dl><br />Something like Sound.lua is small, simple, self contained module:<br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">module <span style="color: #66cc66;">&#40;</span> <span style="color: #66cc66;">...,</span> package<span style="color: #66cc66;">.</span>seeall <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> bgm</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> playSound<span style="color: #66cc66;">&#40;</span>pFileName<span style="color: #66cc66;">,</span> pLoadIntoMemory<span style="color: #66cc66;">,</span> pVolume<span style="color: #66cc66;">,</span> pLoop<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> result <span style="color: #66cc66;">=</span> MOAIUntzSound<span style="color: #66cc66;">.</span>new <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">:</span>load<span style="color: #66cc66;">&#40;</span> pFileName<span style="color: #66cc66;">,</span> pLoadIntoMemory <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">:</span>setVolume<span style="color: #66cc66;">&#40;</span> pVolume <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">:</span>setLooping<span style="color: #66cc66;">&#40;</span> pLoop <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">:</span>play<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> result</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> playSFX<span style="color: #66cc66;">&#40;</span>pFileName<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> loadIntoMemory <span style="color: #66cc66;">=</span> <span style="color: #aa9900;">false</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> volume &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">2</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> loop &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">=</span> <span style="color: #aa9900;">false</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; sfx <span style="color: #66cc66;">=</span> playSound<span style="color: #66cc66;">&#40;</span>pFileName<span style="color: #66cc66;">,</span> loadIntoMemory<span style="color: #66cc66;">,</span> volume<span style="color: #66cc66;">,</span> loop<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> sfx</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> playBGM<span style="color: #66cc66;">&#40;</span>pFileName<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> loadIntoMemory <span style="color: #66cc66;">=</span> <span style="color: #aa9900;">false</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> volume &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">0.5</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> loop &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">=</span> <span style="color: #aa9900;">true</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">if</span> bgm <span style="color: #aa9900; font-weight: bold;">then</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; bgm<span style="color: #66cc66;">:</span>stop<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; bgm <span style="color: #66cc66;">=</span> <span style="color: #aa9900;">nil</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; bgm <span style="color: #66cc66;">=</span> playSound<span style="color: #66cc66;">&#40;</span>pFileName<span style="color: #66cc66;">,</span> loadIntoMemory<span style="color: #66cc66;">,</span> volume<span style="color: #66cc66;">,</span> loop<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> bgm</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /></ol></code></dd></dl><br />The contents of State.lua can be found in <a href="../get-screen-resolution-sdk-1-2-t894/index.html" class="postlink">this thread</a>.<br /><br />This project is still in the works.  I add new modules as I need them.  As I move along, I will be enhancing the main loop so that I can transition from state to state in a robust fashion.  I do not feel burdened by <a href="http://en.wikipedia.org/wiki/Technical_debt" class="postlink">technical debt</a> using this architecture.</div>

			<div id="sig4694" class="signature">Any original code posted by me is released via the <a href="http://creativecommons.org/publicdomain/zero/1.0/legalcode" class="postlink">CC0 Public Domain Dedication</a>.  It is in the <span style="font-weight: bold">public domain</span>.  Do whatever you want with it.</div>

		</div>

		
			<dl class="postprofile" id="profile4694">
			<dt>
				<img src="../download/file.php%253favatar%253d844_1341653178.jpg" width="120" height="120" alt="User avatar" /><br />
				<strong>sgeos</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 241</dd><dd><strong>Joined:</strong> Sat Apr 28, 2012 11:42 am</dd><dd><strong>Location:</strong> Married in Japan.</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4744" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4744">Re: Structuring Project</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>rhoster</strong> &raquo; Tue Jun 19, 2012 6:48 pm </p>

			

			<div class="content">I think you kind of nailed it in your question <img src="../images/smilies/icon_e_smile.gif" alt=":)" title="Smile" />  Your design abstraction is well done.  I'm writing a similar type of engine right now and would implement what you're talking about as follows:<br /><br />World<br />- Display<br />-- TileMapDisplay<br />-- PropDisplay<br />- Control<br />-- PropControl<br /><br />The idea is that you set up the world in your Control module - where you keep track of your MOAIGrid objects.  The Display module would handle the actual display - the MOAIProp that is the actual TileMap and the table of MOAIProp objects for your dynamic game objects.  The main Display module would contain your MOAIViewport and two MOAILayer objects - one for the TileMapDisplay module and another for the PropDisplay module; it would also contain the various MOAITileDeck2D, MOAIGfxQuadDeck2D, and MOAIGfxQuad2D objects you need to load into texture memory.<br /><br />You would process the Control (via pointer or keyboard) by checking which Prop (a dynamic game object or part of the TileMap) is being clicked and then do some processing.  Your game loop would handle the scheduling of what actions your Props are doing through the PropControl module.<br /><br />My assumption is that you'll have some type of user control for game objects as well as an AI that schedules actions for them as well.  You should process the requests in the same place - your Control module.  This way, there is no functional difference between you telling a game object to move to (x,y) on the TileMap grid and the user clicking on the grid to direct a dynamic game object that is active to do the same thing.<br /><br />I hope this makes sense and is helpful, let me know if you have any questions.</div>

			
				<div class="notice">Last edited by rhoster on Wed Jun 20, 2012 6:17 am, edited 2 times in total.
					
				</div>
			

		</div>

		
			<dl class="postprofile" id="profile4744">
			<dt>
				<img src="../download/file.php%253favatar%253d909_1372089208.jpg" width="120" height="109" alt="User avatar" /><br />
				<strong>rhoster</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 232</dd><dd><strong>Joined:</strong> Sat May 26, 2012 10:59 pm</dd><dd><strong>Location:</strong> Santa Barbara, CA</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4755" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4755">Re: Structuring Project</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>sgeos</strong> &raquo; Wed Jun 20, 2012 12:42 am </p>

			

			<div class="content">I guess the short answer is finite-state machines and model-view-controller.</div>

			<div id="sig4755" class="signature">Any original code posted by me is released via the <a href="http://creativecommons.org/publicdomain/zero/1.0/legalcode" class="postlink">CC0 Public Domain Dedication</a>.  It is in the <span style="font-weight: bold">public domain</span>.  Do whatever you want with it.</div>

		</div>

		
			<dl class="postprofile" id="profile4755">
			<dt>
				<img src="../download/file.php%253favatar%253d844_1341653178.jpg" width="120" height="120" alt="User avatar" /><br />
				<strong>sgeos</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 241</dd><dd><strong>Joined:</strong> Sat Apr 28, 2012 11:42 am</dd><dd><strong>Location:</strong> Married in Japan.</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4758" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4758">Re: Structuring Project</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Jay</strong> &raquo; Wed Jun 20, 2012 5:44 am </p>

			

			<div class="content">Hey sgeos and rhoster, thanks for the replies!<br /><br />I am busy this week but will try to get going over the weekend.. I'll be sure to let you know when I have more questions.</div>

			

		</div>

		
			<dl class="postprofile" id="profile4758">
			<dt>
				<strong>Jay</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 14</dd><dd><strong>Joined:</strong> Mon Jun 18, 2012 3:20 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4889" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4889">Re: Structuring Project</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Jay</strong> &raquo; Sun Jun 24, 2012 4:43 am </p>

			

			<div class="content">Alright, I've already got a question. How do I get some sort of seconds-base dt in my functions?<br />In other words, functions such as prop:seekLoc( x, y, seconds ) are based off of seconds, how would I implement something similar?<br /><br />Edit:<br />Should I use MOAISim.getStep()?<br />What if a function isn't called for several frames, but it needs to know the time elapsed since it was last called? How would I handle that?</div>

			

		</div>

		
			<dl class="postprofile" id="profile4889">
			<dt>
				<strong>Jay</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 14</dd><dd><strong>Joined:</strong> Mon Jun 18, 2012 3:20 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4892" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4892">Re: Structuring Project</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>rhoster</strong> &raquo; Sun Jun 24, 2012 6:06 am </p>

			

			<div class="content">Hey Jay,<br /><br />The class you're looking for is MOAISim: <!-- m --><a class="postlink" href="http://192.168.20.226:3000/docs/class_m_o_a_i_sim.html">/docs/class_m_o_a_i_sim.html</a><!-- m --><br /><br />You use the setStep( ( 1 / APP_FRAMES_PER_SECOND ) ) like so for 60 frames a second:<br /><br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">MOAISim<span style="color: #66cc66;">.</span>setSet<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">/</span><span style="color: #cc66cc;">60</span><span style="color: #66cc66;">&#41;</span></div></li><br /></ol></code></dd></dl><br /><br />Now you can use the MOAISim.getElapsedFrames() to get the current frame (there will be 60 per second).  You can also use MOAISim.getElapsedTime() to get the time in seconds or MOAISim.getPerformance() to get the frames per second - both of these values are estimates so the precision isn't perfect.<br /><br />You're also going to want to set up a game loop like so:<br /><br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">MOAISim<span style="color: #66cc66;">.</span>openWindow<span style="color: #66cc66;">&#40;</span>App_title<span style="color: #66cc66;">,</span> App_width_px<span style="color: #66cc66;">,</span> App_height_px<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">MOAISim<span style="color: #66cc66;">.</span>setStep<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">/</span>App_fps<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> <span style="color: #aa9900; font-weight: bold;">function</span> update<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; FRAME <span style="color: #66cc66;">=</span> MOAISim<span style="color: #66cc66;">.</span>getElapsedFrames<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000aa;">coroutine.yield</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> App_loop <span style="color: #66cc66;">=</span> MOAICoroutine<span style="color: #66cc66;">.</span>new<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">App_loop<span style="color: #66cc66;">:</span>run<span style="color: #66cc66;">&#40;</span>update<span style="color: #66cc66;">&#41;</span></div></li><br /></ol></code></dd></dl><br /><br />Hope that helps!  Let me know if you have more questions.</div>

			

		</div>

		
			<dl class="postprofile" id="profile4892">
			<dt>
				<img src="../download/file.php%253favatar%253d909_1372089208.jpg" width="120" height="109" alt="User avatar" /><br />
				<strong>rhoster</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 232</dd><dd><strong>Joined:</strong> Sat May 26, 2012 10:59 pm</dd><dd><strong>Location:</strong> Santa Barbara, CA</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4896" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4896">Re: Structuring Project</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>sgeos</strong> &raquo; Sun Jun 24, 2012 8:33 am </p>

			

			<div class="content">If you have not done so, you may wish to read the SDK Basics tutorials on the wiki (<a href="http://192.168.20.226:3000/wiki/index.php?title=Moai_SDK_Basics_Part_One" class="postlink">Part One</a> and <a href="http://192.168.20.226:3000/wiki/index.php?title=Moai_SDK_Basics_Part_Two" class="postlink">Part Two</a>).  You may find the <a href="http://192.168.20.226:3000/wiki/index.php?title=Moai_SDK_Basics_Part_Two#Action_Sequencing" class="postlink">section on action sequencing</a> interesting.<br /><br /><blockquote><div><cite>rhoster wrote:</cite>You use the setStep( ( 1 / APP_FRAMES_PER_SECOND ) ) like so for 60 frames a second:<br /></div></blockquote><br />I explicitly initialize the FPS and store the value so I can use it in timing calculations.<br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> new<span style="color: #66cc66;">&#40;</span>pProgramName<span style="color: #66cc66;">,</span> pFPS<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #808080; font-style: italic;">-- Program State</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> result <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #808080; font-style: italic;">-- FPS</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; result<span style="color: #66cc66;">.</span>fps &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #66cc66;">=</span> pFPS <span style="color: #aa9900; font-weight: bold;">or</span> <span style="color: #cc66cc;">60</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; MOAISim<span style="color: #66cc66;">.</span>setStep<span style="color: #66cc66;">&#40;</span> <span style="color: #cc66cc;">1</span> <span style="color: #66cc66;">/</span> result<span style="color: #66cc66;">.</span>fps <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #808080; font-style: italic;">-- initialize other stuff</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> result</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- The stored value is later used for timing calculations.</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> getScrollDeltaX<span style="color: #66cc66;">&#40;</span>pState<span style="color: #66cc66;">,</span> pScreens<span style="color: #66cc66;">,</span> pSeconds<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> result <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#40;</span>pScreens <span style="color: #66cc66;">*</span> pState<span style="color: #66cc66;">.</span>scaleX<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">/</span> <span style="color: #66cc66;">&#40;</span>pSeconds <span style="color: #66cc66;">*</span> pState<span style="color: #66cc66;">.</span>fps<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> result</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /></ol></code></dd></dl></div>

			<div id="sig4896" class="signature">Any original code posted by me is released via the <a href="http://creativecommons.org/publicdomain/zero/1.0/legalcode" class="postlink">CC0 Public Domain Dedication</a>.  It is in the <span style="font-weight: bold">public domain</span>.  Do whatever you want with it.</div>

		</div>

		
			<dl class="postprofile" id="profile4896">
			<dt>
				<img src="../download/file.php%253favatar%253d844_1341653178.jpg" width="120" height="120" alt="User avatar" /><br />
				<strong>sgeos</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 241</dd><dd><strong>Joined:</strong> Sat Apr 28, 2012 11:42 am</dd><dd><strong>Location:</strong> Married in Japan.</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4993" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4993">Re: Structuring Project</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Jay</strong> &raquo; Wed Jun 27, 2012 2:56 am </p>

			

			<div class="content">Thanks rhoster and sgeos. Also, instead of storing an FPS value, I could use the MOAISim.getStep() method, couldn't I? Or would that be a bad idea?<br /><br />I did read the SDK Basics tutorials a while back... I wish there was a part 3!</div>

			

		</div>

		
			<dl class="postprofile" id="profile4993">
			<dt>
				<strong>Jay</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 14</dd><dd><strong>Joined:</strong> Mon Jun 18, 2012 3:20 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4994" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4994">Re: Structuring Project</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>sgeos</strong> &raquo; Wed Jun 27, 2012 4:36 am </p>

			

			<div class="content"><blockquote><div><cite>Jay wrote:</cite>Also, instead of storing an FPS value, I could use the MOAISim.getStep() method, couldn't I?</div></blockquote><br />MOAISim.getStep() will give you 1 / FPS.  Running this:<br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> fps <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">60</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; MOAISim<span style="color: #66cc66;">.</span>setStep<span style="color: #66cc66;">&#40;</span> <span style="color: #cc66cc;">1</span> <span style="color: #66cc66;">/</span> fps <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;local fps &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;</span><span style="color: #66cc66;">,</span> fps<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;1 / fps &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">1</span> <span style="color: #66cc66;">/</span> fps<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;MOAISim.getStep() &nbsp; &nbsp;&quot;</span><span style="color: #66cc66;">,</span> MOAISim<span style="color: #66cc66;">.</span>getStep<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;1 / MOAISim.getStep()&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">1</span> <span style="color: #66cc66;">/</span> MOAISim<span style="color: #66cc66;">.</span>getStep<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span></div></li><br /></ol></code></dd></dl><br />Gives the following output:<br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="bash" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #7a0874; font-weight: bold;">local</span> fps &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">60</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #000000;">1</span> <span style="color: #000000; font-weight: bold;">/</span> fps &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">0.016666666666667</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">MOAISim.getStep<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span> &nbsp; &nbsp; &nbsp; <span style="color: #000000;">0.016666666666667</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #000000;">1</span> <span style="color: #000000; font-weight: bold;">/</span> MOAISim.getStep<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span> &nbsp; <span style="color: #000000;">60</span></div></li><br /></ol></code></dd></dl></div>

			<div id="sig4994" class="signature">Any original code posted by me is released via the <a href="http://creativecommons.org/publicdomain/zero/1.0/legalcode" class="postlink">CC0 Public Domain Dedication</a>.  It is in the <span style="font-weight: bold">public domain</span>.  Do whatever you want with it.</div>

		</div>

		
			<dl class="postprofile" id="profile4994">
			<dt>
				<img src="../download/file.php%253favatar%253d844_1341653178.jpg" width="120" height="120" alt="User avatar" /><br />
				<strong>sgeos</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 241</dd><dd><strong>Joined:</strong> Sat Apr 28, 2012 11:42 am</dd><dd><strong>Location:</strong> Married in Japan.</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4995" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4995">Re: Structuring Project</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Jay</strong> &raquo; Wed Jun 27, 2012 4:53 am </p>

			

			<div class="content">So then it should work fine, correct? Especially since 1/fps is likely to be used a lot more than fps anyway... And when the FPS is needed, it could easily be calculated like line 7 of your sample code.<br />Or would it be better to store the FPS or 1/FPS (or both) in a state object like you did in your previous post?</div>

			

		</div>

		
			<dl class="postprofile" id="profile4995">
			<dt>
				<strong>Jay</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 14</dd><dd><strong>Joined:</strong> Mon Jun 18, 2012 3:20 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4998" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4998">Re: Structuring Project</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>sgeos</strong> &raquo; Wed Jun 27, 2012 6:43 am </p>

			

			<div class="content">So far as I can tell both approaches give the same results.  There is no &quot;best&quot; way to manage your variables.  It really depends on how your brain works and what you are trying to do.<br /><br />MOAISim.getStep() returns seconds per frame.  I prefer to use frames per second.  The conversion from one to the other is simple.  Storing the value is also a matter of preference.  I like to pass a program state variable around.  If you prefer the API call or another approach, feel free to use it.<br /><br /><span style="font-weight: bold">EDIT:</span> If you decide to cache the values, it is probably a good idea to do that with the API call:<br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> fps <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">60</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">MOAISim<span style="color: #66cc66;">.</span>setStep<span style="color: #66cc66;">&#40;</span> <span style="color: #cc66cc;">1</span> <span style="color: #66cc66;">/</span> fps <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">fps <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">1</span> <span style="color: #66cc66;">/</span> MOAISim<span style="color: #66cc66;">.</span>getStep<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> spf <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">1</span> <span style="color: #66cc66;">/</span> fps <span style="color: #808080; font-style: italic;">-- if you want both values</span></div></li><br /></ol></code></dd></dl></div>

			<div id="sig4998" class="signature">Any original code posted by me is released via the <a href="http://creativecommons.org/publicdomain/zero/1.0/legalcode" class="postlink">CC0 Public Domain Dedication</a>.  It is in the <span style="font-weight: bold">public domain</span>.  Do whatever you want with it.</div>

		</div>

		
			<dl class="postprofile" id="profile4998">
			<dt>
				<img src="../download/file.php%253favatar%253d844_1341653178.jpg" width="120" height="120" alt="User avatar" /><br />
				<strong>sgeos</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 241</dd><dd><strong>Joined:</strong> Sat Apr 28, 2012 11:42 am</dd><dd><strong>Location:</strong> Married in Japan.</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p5034" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p5034">Re: Structuring Project</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Jay</strong> &raquo; Thu Jun 28, 2012 2:29 am </p>

			

			<div class="content">Okay, thanks sgeos.</div>

			

		</div>

		
			<dl class="postprofile" id="profile5034">
			<dt>
				<strong>Jay</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 14</dd><dd><strong>Joined:</strong> Mon Jun 18, 2012 3:20 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<form id="viewtopic" method="post" action="index.html">

	<fieldset class="display-options" style="margin-top: 0; ">
		
	</fieldset>

	</form>
	<hr />


<div class="topic-actions">
	<div class="buttons">
	
	</div>

	
		<div class="pagination">
			13 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	
</div>


	<p></p><p><a href="../new-users.html" class="left-box left" accesskey="r">Return to Questions and Tips</a></p>

	<form method="post" id="jumpbox" action="http://192.168.20.226:3000/forums/viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	
		<fieldset class="jumpbox">
	
			<label for="f" accesskey="j">Jump to:</label>
			<select name="f" id="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">
			
				<option value="-1">Select a forum</option>
			<option value="-1">------------------</option>
				<option value="4">Moai Development Forums</option>
			
				<option value="7">&nbsp; &nbsp;Moai SDK</option>
			
				<option value="9" selected="selected">&nbsp; &nbsp;Questions and Tips</option>
			
				<option value="10">&nbsp; &nbsp;Bug Reports</option>
			
				<option value="29">&nbsp; &nbsp;Reviewers</option>
			
				<option value="3">Moai Community Forums</option>
			
				<option value="11">&nbsp; &nbsp;Community Contributions</option>
			
				<option value="25">&nbsp; &nbsp;&nbsp; &nbsp;Flower</option>
			
				<option value="28">&nbsp; &nbsp;&nbsp; &nbsp;Rapanui</option>
			
				<option value="26">&nbsp; &nbsp;&nbsp; &nbsp;Snippets</option>
			
				<option value="5">&nbsp; &nbsp;Moai Roadmap</option>
			
				<option value="8">&nbsp; &nbsp;&nbsp; &nbsp;Moai Cloud</option>
			
				<option value="6">&nbsp; &nbsp;Made With Moai</option>
			
				<option value="12">Platform Specifics</option>
			
				<option value="17">&nbsp; &nbsp;Android</option>
			
				<option value="18">&nbsp; &nbsp;Apple</option>
			
				<option value="20">&nbsp; &nbsp;Linux</option>
			
				<option value="19">&nbsp; &nbsp;Windows</option>
			
				<option value="21">&nbsp; &nbsp;Browser + Other</option>
			
				<option value="13">Third Party Libraries and Plugins</option>
			
				<option value="22">&nbsp; &nbsp;Physics</option>
			
				<option value="23">&nbsp; &nbsp;Sound + Music</option>
			
				<option value="24">&nbsp; &nbsp;Advertising + Networking + IAPs</option>
			
				<option value="14">Additional</option>
			
				<option value="16">&nbsp; &nbsp;Game Development</option>
			
				<option value="27">&nbsp; &nbsp;Off Topic</option>
			
			</select>
			<input type="submit" value="Go" class="button2" />
		</fieldset>
	</form>


	<h3>Who is online</h3>
	<p>Users browsing this forum: No registered users and 0 guests</p>
</div>

<div id="page-footer">

	<div class="navbar">
		<div class="inner"><span class="corners-top"><span></span></span>

		<ul class="linklist">
			<li class="icon-home"><a href="../index.html" accesskey="h">Board index</a></li>
				
			<li class="rightside">All times are UTC </li>
		</ul>

		<span class="corners-bottom"><span></span></span></div>
	</div>
	
	<div class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group<br />Style by <a href="http://www.m-a-styles.de">Marc Alexander</a> &copy;
		<br /><br /><a href="http://www.phpbb-seo.com/" title="Search Engine Optimization"><img src="../images/phpbb-seo.png" alt="phpBB SEO"/></a><br />Time : 0.118s | 11 Queries | GZIP : Off
	</div>
</div>

</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
	
	</div>
	</div>
<div class="nobottomgap"></div>
</div>
<!--- end of box border -->
</div></div>
<!-- -->
<div class="bottom-left"></div><div class="bottom-center"></div><div class="bottom-right"></div>
</div>
<!-- JQuery Pop Up --><!-- PM Popup --><!-- PM Popup end --><!-- Image Popup -->
<div id="popupImage">
	<p id="ImagePopup"></p>
	<a id="popupImageClose">x</a> 
</div>
<!-- Image Popup -->
<div id="backgroundPopup"></div> 
<!-- JQuery Pop Up END -->
</body>
</html>