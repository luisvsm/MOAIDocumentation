<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>Moai Forum | The mobile platform for pro game developers &bull; View topic - Organising a large Moai project&#39;s functionality: what approaches are people using?</title>

<link rel="alternate" type="application/atom+xml" title="Feed - Moai Forum | The mobile platform for pro game developers" href="../feed.php.html" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="../feed.php%3Fmode=forums.html" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="../feed.php%3Fmode=topics.html" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="../feed.php%3Fmode=topics_active.html" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - New Users" href="../feed.php%3Ff=9.html" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - Organising a large Moai project&#39;s functionality: what approaches are people using?" href="../feed.php%3Ff=9&amp;t=172.html" />

<!--
	phpBB style name: proFormell
	Based on style:   prosilver (this is the default phpBB3 style)
	Inspired by:	  Formell (Joomla Style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  	  Marc Alexander
	
	NOTE: This page was generated by phpBB, the free open-source bulletin board package.
	      The phpBB Group is not responsible for the content of this page and forum. For more information
	      about phpBB please visit http://www.phpbb.com
-->

<script type="text/javascript">
// <![CDATA[
	var jump_page = 'Enter the page number you wish to go to:';
	var on_page = '1';
	var per_page = '';
	var base_url = '';
	var style_cookie = 'phpBBstyle';
	var style_cookie_settings = '; path=/';
	var onload_functions = new Array();
	var onunload_functions = new Array();
	var is_ie6 = false;

	/**
	* Find a member
	*/
	function find_username(url)
	{
		popup(url, 760, 570, '_usersearch');
		return false;
	}

	/**
	* New function for handling multiple calls to window.onload and window.unload by pentapenguin
	*/
	window.onload = function()
	{
		for (var i = 0; i < onload_functions.length; i++)
		{
			eval(onload_functions[i]);
		}
	}

	window.onunload = function()
	{
		for (var i = 0; i < onunload_functions.length; i++)
		{
			eval(onunload_functions[i]);
		}
	}

// ]]>
</script>
<!--[if lt IE 7]>
<script type="text/javascript">
// <![CDATA[
var is_ie6 = true;
// ]]>
</script>
<![endif]-->


<link href="../styles/proFormell/theme/print.css" rel="stylesheet" type="text/css" media="print" title="printonly" />

<link href="../style.css" rel="stylesheet" type="text/css" media="screen, projection" />



<link href="../styles/proFormell/theme/images/favicon.ico" rel="shortcut icon" />

<script type="text/javascript" src="../styles/prosilver/template/forum_fn.js"></script>
<script src="../styles/prosilver/template/jquery-1.4.4.min.js" type="text/javascript"></script>

<script type="text/javascript">
// <![CDATA[
/**
* New pop-up functions
* based on  http://yensdesign.com/2008/09/how-to-create-a-stunning-and-smooth-popup-using-jquery/
*/

//SETTING UP OUR POPUP
//0 means disabled; 1 means enabled;
var popupStatus = 0;
var openPopup = '';

//loading popup with jQuery magic!
function loadPopup()
{
	//loads popup only if it is disabled
	if(popupStatus==0)
	{
		$('#backgroundPopup').css({'opacity': '0.7'});
		// Now let's make sure we actually see the image
		var scroll = $(window).scrollTop();
		$('#popupPM').animate({marginTop: scroll}, 'fast', function() {
			// Animation complete.
			});
		$('#backgroundPopup').fadeIn('slow');
		$('#popupPM').fadeIn('slow');
		popupStatus = 1;
		openPopup = 'PM';
	}
}

//disabling popup with jQuery magic!
function disablePopup()
{
	//disables popup only if it is enabled
	if(popupStatus==1 && openPopup == 'PM')
	{
		$('#backgroundPopup').fadeOut('slow');
		$('#popupPM').fadeOut('slow');
		popupStatus = 0;
		openPopup = '';
	}
}

//centering popup
function centerPopup()
{
	//request data for centering
	var windowWidth = document.documentElement.clientWidth;
	var windowHeight = document.documentElement.clientHeight;
	var popupHeight = $('#popupPM').height();
	var popupWidth = $('#popupPM').width();
	//centering
	$('#popupPM').css({
	'position': 'absolute',
	'top': windowHeight/2-popupHeight/2,
	'left': windowWidth/2-popupWidth/2
	});
	//only need force for IE6
	$('#backgroundPopup').css({'height': windowHeight});
}

$(document).ready(function(){
	
	resize_images();
	
	
	// IE6 and below PNG fix (not really)
	if(is_ie6)
	{
		replace_png();
	}
	
	//CLOSING POPUP
	//Click the x event!
	$('#popupPMClose').click(function(){
		disablePopup();
	});
	//Click out event!
	$('#backgroundPopup').click(function(){
		disablePopup();
		disableImage();
	});
	//Press Escape event!
	$(document).keypress(function(e){
		if(e.keyCode==27 && popupStatus==1)
		{
			disablePopup();
			disableImage();
		}
	});
	
	
	// Image popup
	$('img', 'dt.attach-image').click(function(){
		image_load($(this).attr('src'), $(this).attr('alt'));
		centerImage();
	});
	
	$('.content img').click(function(){
		var check = $(this).parent().hasClass('content');
		if(check)
		{
			image_load($(this).attr('src'), $(this).attr('alt'));
			centerImage();
		}
	});
	
	// Closing Image popup
	//Click the x event!
	$('#popupImageClose').click(function(){
		disableImage();
	});
	
	//Click image box event
	$('#popupImage').click(function(){
		disableImage();
	});
	
	//Click image event
	$('#ImagePopup img').click(function(){
		disableImage();
	});
	

});

/**
* Replaces weird looking PNG files with the respectie GIF file
* Only run this if the browser is IE6 or below
*/
function replace_png()
{
	// Fix Logo
	var str = $('#logo img').attr('src'); 
	$('#logo img').attr('src', str.substring(0, str.length - 3) + 'gif');
	
	// Fix forum icons
	$('dl.icon').each(function() {
		var str = $(this).css('background-image');
		if(str != '')
		{
			$(this).css('background-image', str.substring(0, str.length - 5) + 'gif")');
		}
	});
}


/**
* Image resizer
*/
function resize_images()
{
	var hello = $('dl.attachbox dd dl.file dt.attach-image img').innerWidth();
	var maxWidth = $('div.content').innerWidth() - 30;
	
	// resize the attached images
	$('img', 'dt.attach-image').each(function(i){
		// check the width of the image
		if ($(this).width() > maxWidth)
		{
			// calculate new image dimensions
			newWidth = maxWidth;
			newHeight = $(this).height() / ( $(this).width() / maxWidth );
			   
			// set new image dimensions
			$(this).height(newHeight).width(newWidth);
		}
	});
	
	// resize the images that were added via [img] bbcode
	$('img', 'div.content').each(function(i){
		// check the width of the image
		$(this).css('max-width', maxWidth); // fix for IE
		if ($(this).width() > maxWidth)
		{
			// calculate new image dimensions
			newWidth = maxWidth;
			newHeight = $(this).height() / ( $(this).width() / maxWidth );
			   
			// set new image dimensions
			$(this).height(newHeight).width(newWidth);
		}
	});
}

/**
* Image pop-up
*/
function image_load(src, alt)
{
	//loads popup only if it is disabled
	if(popupStatus==0)
	{
		$('#ImagePopup').html('<img id="imgpopup" src="http://192.168.20.226:3000/forums/organising-a-large-moai-project-s-functionality-what-approaches-are-people-using-t172/'&#32;+&#32;src&#32;+&#32;'" alt="' + alt + '" />');
		var windowWidth = document.documentElement.clientWidth;
		var windowHeight = document.documentElement.clientHeight;
		var maxWidth = windowWidth * 0.85;
		var maxHeight = windowHeight * 0.85;
		$('#popupImage img').css('max-width', maxWidth);
		$('#popupImage img').css('max-height', maxHeight);
		$('#backgroundPopup').css({'opacity': '0.7'});
		// Now let's make sure we actually see the image
		var scroll = $(window).scrollTop();
		$('#popupImage').animate({marginTop: scroll}, 'fast', function() {
			// Animation complete.
			});
		$('#backgroundPopup').fadeIn('slow');
		$('#popupImage').fadeIn('slow');
		popupStatus = 1;
		openPopup = 'Image';
	}
}

//centering popup
function centerImage()
{
	//request data for centering
	var windowWidth = document.documentElement.clientWidth;
	var windowHeight = document.documentElement.clientHeight;
	var popupHeight = $('#popupImage').height();
	var popupWidth = $('#popupImage').width();
	var newTop = windowHeight/2-popupHeight/2;
	var newLeft = windowWidth/2-popupWidth/2;
	//centering
	$('#popupImage').css({
	'position': 'absolute',
	'top': newTop,
	'left': newLeft
	});
	
	//only need force for IE6
	$('#backgroundPopup').css({'height': windowHeight});
}

//disabling popup with jQuery magic!
function disableImage()
{
	//disables popup only if it is enabled
	if(popupStatus==1 && openPopup == 'Image')
	{
		$('#backgroundPopup').fadeOut('slow');
		$('#popupImage').fadeOut('slow');
		popupStatus = 0;
		openPopup = '';
	}
}


// ]]>
</script>

</head>

<body id="phpbb" class="section-viewtopic ltr">
<!--- box border START -->
<div id="box">

<div class="top-left"></div><div class="top-center"></div><div class="top-right"></div>
<div id="left-border">
<div id="right-border">


<!--- box border END -->
<div class="inside">
 <div class="notopgap">
<div id="wrap">
	<a id="top" name="top" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar">
			<div class="inner"><!-- <span class="corners-top"><span></span></span> -->
			<div style="height: 140px ;">
			<div id="site-description">
				<div class="header-pad"><a href="index.html" title="" id="logo"><img src="../styles/proFormell/imageset/site-logo.png" width="410" height="98" alt="" title="" /></a></div>
			
		<!--		<p class="site-desc">The mobile platform for pro game developers</p> -->
				<p class="skiplink"><a href="index.html#start_here">Skip to content</a></p>
			</div>

		
    </div>

			<span class="corners-bottom"><span></span></span></div>
		</div>

		<div class="navbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<ul class="linklist navlinks">
				<li class="icon-home"><a href="../index.html" accesskey="h">Board index</a>  <strong>&#8249;</strong> <a href="../moai-development-forums.html">Moai Development Forums</a> <strong>&#8249;</strong> <a href="../new-users.html">New Users</a></li>

				<li class="rightside"><a href="index.html#" onclick="fontsizeup(); return false;" onkeypress="return fontsizeup(event);" class="fontsize" title="Change font size">Change font size</a></li>

				<li class="rightside"><a href="http://192.168.20.226:3000/forums/memberlist.php?mode=email&amp;t=172" title="E-mail friend" class="sendemail">E-mail friend</a></li><li class="rightside"><a href="../viewtopic.php%3Ff=9&amp;t=172&amp;start=0&amp;view=print.html" title="Print view" accesskey="p" class="print">Print view</a></li>
			</ul>

			

			<ul class="linklist rightside">
				<li class="icon-faq"><a href="../faq.php.html" title="Frequently Asked Questions">FAQ</a></li>
				
				
			</ul>

			<span class="corners-bottom"><span></span></span></div>
		</div>
	</div>

	<a name="start_here"></a>
	<div id="page-body">
		
<h2><a href="index.html">Organising a large Moai project&#39;s functionality: what approaches are people using?</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body --><div style="display: none !important;">New to Moai? Get started here with our best tips and tutorials.<br /></div>

<div class="topic-actions">

	<div class="buttons">
	
	</div>

	
		<div class="pagination">
			14 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	

</div>
<div class="clear"></div>


	<div id="p794" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 class="first"><a href="index.html#p794">Organising a large Moai project&#39;s functionality: what approaches are people using?</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>tim</strong> &raquo; Wed Oct 26, 2011 8:28 pm </p>

			

			<div class="content">Okay, so I've got past the initial hurdles with getting to grips with Moai basics. I've completed the Rocket Lobster tutorial, and I think I understand everything that's going on there.
<br />
<br />However, Rocket Lobster is just a single-file project, so what are the ways that experienced Moai users logically divide their projects up? In our <a href="http://launchingpadgames.com" target="_blank">previous</a> Objective-C/cocos2d projects, I've typically stuck to a strongly object-oriented MVC pattern, dividing my game entities into models and corresponding views, each of which have their own sourcecode files. That approach works well in Objective-C with its emphasis on classes and objects.
<br />
<br />I don't want to shoehorn my previous approach into Lua/Moai if it's not going to be a good fit. I realise that Lua can be made to provide classes and inheritance fairly easily, but I don't see that approach used in Rocket Lobster — rather, it's a series of <em>makeX()</em> functions that produce objects on demand. Experienced Moai developers: do you recommend using the Rocket Lobster approach across an entire project, and just breaking off <em>makeX()</em>-type functions into modules accessed via <em>require()</em> as you see fit? If not, how do you organise the functionality of your game (be it classical classes or something more exotic)?</div>

			

		</div>

		
			<dl class="postprofile" id="profile794">
			<dt>
				<strong>tim</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 14</dd><dd><strong>Joined:</strong> Mon Oct 17, 2011 8:29 pm</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p797" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p797">Organising a large Moai project&#39;s functionality: what approaches are people using?</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong><span style="color: #AA0000;" class="username-coloured">patrick</span></strong> &raquo; Wed Oct 26, 2011 10:32 pm </p>

			

			<div class="content">I hope more people post here - this is a great topic.
<br />
<br />When we first started using Lua, we did try to go down a heavily OOP path, but backed off a lot. The model we favor now is a 'decoration' idea where we start with a table and then add methods to it in order to build up more complex behavior. So composition over inheritance, basically.
<br />
<br />In terms of runtime, for our own games we have a very lightweight scene manager, resource cache and state machine pattern. We also have the notion of a 'rig' which is a container for a collection of framework objects. There's also a bag of standalone utility functions to do things like wait for touches, wrap input differences, etc.
<br />
<br />I have a feeling we'll be refining some of these ideas and rewriting them for our next project. When we get something a bit more mature, will post it up as an example. But the overall trend (for us) seems to be less is more.
<br />
<br />Would really like to hear how other developers are thinking about it as well.</div>

			

		</div>

		
			<dl class="postprofile" id="profile797">
			<dt>
				<img src="http://www.gravatar.com/avatar/3f2c5c26c628e4b5500d87c737c60015?s=120.jpg" width="120" height="120" alt="User avatar" /><br />
				<strong><span style="color: #AA0000;" class="username-coloured">patrick</span></strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 589</dd><dd><strong>Joined:</strong> Sun Apr 03, 2011 5:50 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p799" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p799">Organising a large Moai project&#39;s functionality: what approaches are people using?</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>tim</strong> &raquo; Thu Oct 27, 2011 1:58 pm </p>

			

			<div class="content">Thanks for the detailed response, Patrick! Sounds like an excellent approach. If you ever feel that what you've got is example-worthy, I'll be first in line to read it. <img src="http://192.168.20.226:3000/wp-content/forum-smileys/sf-smile.gif" alt="Smile" />
<br />
<br />If you have time, I'd love to hear more about how your 'decoration'/'adding methods to a table' concept works. (I tend to favour composition over inheritance too — it seems to fit better with how my brain works, plus make for cleaner optimisation passes.)</div>

			

		</div>

		
			<dl class="postprofile" id="profile799">
			<dt>
				<strong>tim</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 14</dd><dd><strong>Joined:</strong> Mon Oct 17, 2011 8:29 pm</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p816" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p816">Organising a large Moai project&#39;s functionality: what approaches are people using?</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong><span style="color: #AA0000;" class="username-coloured">patrick</span></strong> &raquo; Fri Oct 28, 2011 3:42 am </p>

			

			<div class="content">Sure. The basic idea is just to keep adding methods to a table. So you have something like:
<br />
<br />object = {}
<br />
<br />makePhysicsObject ( object )
<br />
<br />makeSprite ( object )
<br />
<br />makeParticleEmitter ( object )
<br />
<br />Or something like that. Each method extends the object to include the new interface. Obviously, the devil's in the details. When we're a bit further along, will ask Eric to share what out game team has been doing.</div>

			

		</div>

		
			<dl class="postprofile" id="profile816">
			<dt>
				<img src="http://www.gravatar.com/avatar/3f2c5c26c628e4b5500d87c737c60015?s=120.jpg" width="120" height="120" alt="User avatar" /><br />
				<strong><span style="color: #AA0000;" class="username-coloured">patrick</span></strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 589</dd><dd><strong>Joined:</strong> Sun Apr 03, 2011 5:50 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p826" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p826">Organising a large Moai project&#39;s functionality: what approaches are people using?</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>tim</strong> &raquo; Fri Oct 28, 2011 1:44 pm </p>

			

			<div class="content">Oo, I really like that approach. It feels like a more natural fit with Lua than deep hierarchies of classes. (And in fact, I probably should have also used that idea <a href="http://launchingpadgames.com/games/the-pretender-trilogy/" target="_blank">back when I was intensively using Actionscript 3 with Flash</a> - marked most of my classes as dynamic and then just attached more methods to them as required.)</div>

			

		</div>

		
			<dl class="postprofile" id="profile826">
			<dt>
				<strong>tim</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 14</dd><dd><strong>Joined:</strong> Mon Oct 17, 2011 8:29 pm</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p829" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p829">Organising a large Moai project&#39;s functionality: what approaches are people using?</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong><span style="color: #AA0000;" class="username-coloured">patrick</span></strong> &raquo; Fri Oct 28, 2011 11:35 pm </p>

			

			<div class="content">Let us know how it works out for you. You may beat us to posting a really good example of it. Lua is such a cool/different paradigm... there's a real zen to it.</div>

			

		</div>

		
			<dl class="postprofile" id="profile829">
			<dt>
				<img src="http://www.gravatar.com/avatar/3f2c5c26c628e4b5500d87c737c60015?s=120.jpg" width="120" height="120" alt="User avatar" /><br />
				<strong><span style="color: #AA0000;" class="username-coloured">patrick</span></strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 589</dd><dd><strong>Joined:</strong> Sun Apr 03, 2011 5:50 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1086" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1086">Organising a large Moai project&#39;s functionality: what approaches are people using?</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>robin.baumgarten</strong> &raquo; Fri Dec 02, 2011 8:24 am </p>

			

			<div class="content">I'm an Android game dev, and for my next project I'm looking at something that more easily ports to iOS. The Moai sdk looks really nice for that.
<br />
<br />However, having no real LUA experience yet, I'd also be really happy about a bit more fleshed out, multi-file and multi-screen example, like hinted at in <a href="../new-users/some-handy-links-for-new-developers/index.html" target="_blank">another thread</a>. An open-source game, if you will, that shows some best practices with the decorator-style object handling as described above. Right now, I don't really know where to start to make an efficient, manageable game.</div>

			

		</div>

		
			<dl class="postprofile" id="profile1086">
			<dt>
				<img src="http://192.168.20.226:3000/forums/download/file.php?avatar=320_1332853296.png" width="120" height="120" alt="User avatar" /><br />
				<strong>robin.baumgarten</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 16</dd><dd><strong>Joined:</strong> Fri Dec 02, 2011 4:15 pm</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p1123" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p1123">Organising a large Moai project&#39;s functionality: what approaches are people using?</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>milleniummike</strong> &raquo; Mon Dec 05, 2011 4:10 am </p>

			

			<div class="content">I'm new to LUA having a java, c# and php background.
<br />
<br />
<br />
<br />I have played with the samples and the potential is looking good.
<br />
<br />
<br />
<br />I like the "minimal" approach so far on lua but have a feeling a full app/game will start to sprawl with logic and modules.
<br />
<br />
<br />
<br />In terms of using multiple file structure I notice lua has a dofile command so you can split out your code into seperate files.
<br />
<br />ex.
<br />
<br />dofile "functions.lua"
<br />
<br />
<br />
<br />As a project gets more complicated my approach will probably be to split out the code into seperate files for managability maybe along the lines of
<br />
<br />resources.lua - to load all sprites, bodies,audio, levels via xml and resources
<br />
<br />gamelogic.lua - functions around the game logic - collisions, user actions
<br />
<br />menu.lua - functions around splashscreen / game menu etc
<br />
<br />
<br />
<br />For the resources - ie audio, images etc I think I'll just put these into subfolders (ie images audio etc) to keep the whole project tidy.</div>

			

		</div>

		
			<dl class="postprofile" id="profile1123">
			<dt>
				<strong>milleniummike</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 51</dd><dd><strong>Joined:</strong> Mon Dec 05, 2011 9:26 am</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4229" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4229">Re: Organising a large Moai project's functionality: what ap</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>nosheet</strong> &raquo; Mon May 28, 2012 10:05 pm </p>

			

			<div class="content">This is a very interesting thread. I am new to Moai but fairly experienced with Lua, building quite a few apps (business and games) on another lua SDK.<br />So far I have been organizing large projects using very light Class-approach, where I would declare classes in separate .lua files, then instantiate and decorate with whatever I might need.<br />Very basic .lua file to define a class would be:<br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- inside of animal.lua</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> Animal <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> Animal_mt <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span> __index <span style="color: #66cc66;">=</span> Animal <span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> Animal<span style="color: #66cc66;">:</span>decorate<span style="color: #66cc66;">&#40;</span> moduleFileName <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> behavior <span style="color: #66cc66;">=</span> <span style="color: #0000aa;">require</span> moduleFileName</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">for</span> k<span style="color: #66cc66;">,</span>v <span style="color: #aa9900; font-weight: bold;">in</span> <span style="color: #0000aa;">pairs</span><span style="color: #66cc66;">&#40;</span>behavior<span style="color: #66cc66;">&#41;</span> <span style="color: #aa9900; font-weight: bold;">do</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; self<span style="color: #66cc66;">&#91;</span>k<span style="color: #66cc66;">&#93;</span> <span style="color: #66cc66;">=</span> v</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; module<span style="color: #66cc66;">.</span>loaded<span style="color: #66cc66;">&#91;</span>moduleFileName<span style="color: #66cc66;">&#93;</span> <span style="color: #66cc66;">=</span> <span style="color: #aa9900;">nil</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> Animal<span style="color: #66cc66;">.</span>new<span style="color: #66cc66;">&#40;</span> params <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> self &nbsp;<span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000aa;">setmetatable</span><span style="color: #66cc66;">&#40;</span> self<span style="color: #66cc66;">,</span> Animal_mt <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">-- do some stuff with common parameters/members for the class</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> self</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">return</span> Animal</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl><br /><br /><br />Then instead of creating more classes through inheritance, I would decorate, ideally storing the interface in a separate file, like:<br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- dog_behavior.lua</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> DogBehavior <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">DogBehavior<span style="color: #66cc66;">.</span>bark <span style="color: #66cc66;">=</span> <span style="color: #aa9900; font-weight: bold;">function</span><span style="color: #66cc66;">&#40;</span> self<span style="color: #66cc66;">,</span> barkSound <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;This dog says &quot;</span><span style="color: #66cc66;">..</span>barkSound<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">return</span> DogBehavior</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl><br /><br />And inheritance itself would be done through:<br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> AnimalClass <span style="color: #66cc66;">=</span> <span style="color: #0000aa;">require</span> <span style="color: #ff6666;">&quot;animal.lua&quot;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> myAnimal <span style="color: #66cc66;">=</span> AnimalClass<span style="color: #66cc66;">.</span>new<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">myAnimal<span style="color: #66cc66;">:</span>decorate<span style="color: #66cc66;">&#40;</span> <span style="color: #ff6666;">&quot;dog_behavior&quot;</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">myAnimal<span style="color: #66cc66;">:</span>bark<span style="color: #66cc66;">&#40;</span> <span style="color: #ff6666;">&quot;WOF,WOF!&quot;</span> <span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #808080; font-style: italic;">-- which would give us &quot;WOF,WOF!&quot; in output</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl><br /><br />Well, ok I wrote this from the top of my head inside of forum post editor, so it might not work as it is, but that's the general idea.<br />Also, most of the classes might have a .view property that would point to whatever I will be using to represent them on screen.<br />This all might look like an overkill at beginning but as project grows an early investment in proper definition of &quot;classes&quot; and their responsibilities always pay off.<br /><br />Apart from these, I would normally have a couple of singleton classes too:<br />- Scene Manager<br />- Resource Manager<br />- Sound Manager<br />- Settings ( keeps the states, and saves to preference file )<br /><br />Hope it gives some idea.<br />A few things that I generally avoid is using module(package.seeall)...</div>

			<div id="sig4229" class="signature">You may hate my haircut, but you'll love my games:<br /><a href="http://www.spin-up-game.com" class="postlink">http://www.spin-up-game.com</a> and <a href="http://www.foosballhero.com" class="postlink">http://www.foosballhero.com</a></div>

		</div>

		
			<dl class="postprofile" id="profile4229">
			<dt>
				<img src="../download/file.php%253favatar%253d912_1339078320.jpg" width="120" height="120" alt="User avatar" /><br />
				<strong>nosheet</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 201</dd><dd><strong>Joined:</strong> Mon May 28, 2012 9:40 pm</dd><dd><strong>Location:</strong> Madrid, Spain</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4232" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4232">Re: Organising a large Moai project's functionality: what ap</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>aminusia</strong> &raquo; Tue May 29, 2012 2:32 am </p>

			

			<div class="content">I am new to lua and Moai and came from the ActionScript 3 comfort zone. So the first thing I looking for when working with Moai/lua is by looking a way that closer with AS object and packaging culture. <br /><br />Thats why I use this table-class constructor function from <a href="http://lua-users.org/wiki/SimpleLuaClasses" class="postlink">http://lua-users.org/wiki/SimpleLuaClasses</a>. As for packaging, lua itself is reading directories as packages as long as you put this command on the beginning of the file.<br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">module<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">...,</span> package<span style="color: #66cc66;">.</span>seeall<span style="color: #66cc66;">&#41;</span></div></li><br /></ol></code></dd></dl><br />Other units will straightly recognize them as package.<br /><br />So directories are arranged this way:<br />|- main.lua<br />|- scene<br />|  .   . |- ModuleA.lua<br />|- assets<br /> .   .  . |- AssetB.lua<br /><br />And access the package inside main.lua as below<br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000aa;">require</span> <span style="color: #ff6666;">&quot;scene.ModuleA.lua&quot;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000aa;">require</span> <span style="color: #ff6666;">&quot;assets.AssetB.lua&quot;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">moduleA <span style="color: #66cc66;">=</span> scene<span style="color: #66cc66;">.</span>ModuleA<span style="color: #66cc66;">.</span>ModuleA<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">assetA <span style="color: #66cc66;">=</span> assets<span style="color: #66cc66;">.</span>AssetB<span style="color: #66cc66;">.</span>AssetB<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /></ol></code></dd></dl><br /><br />As for singletons, it seems that people are using the exact same singleton arrangement:<br />- Scenes<br />- Sounds<br />- Resources<br />- General Data and Configuration<br /><br />I guess it comes out from the AS3 habit, as I had to put sound and resource manager in a way that accessible by all part of the application. This way we can simplify our resource and sound management to reduce any leakage threat.</div>

			

		</div>

		
			<dl class="postprofile" id="profile4232">
			<dt>
				<strong>aminusia</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 11</dd><dd><strong>Joined:</strong> Mon May 28, 2012 1:32 pm</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4240" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4240">Re: Organising a large Moai project's functionality: what ap</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>ibisum</strong> &raquo; Tue May 29, 2012 7:07 am </p>

			

			<div class="content">I've done about 5 projects with MOAI so far, and have settled (evolved into?) on a 'table-driven' approach, whereby a core engine takes in tables as its input and spits out game/app logic.  So, I'm in the 'decoration over inheritance camp', mostly.<br /><br />For my physics game, I have one table and one function per game-level - the table defines the static stuff, and the function generates the dynamics physics content.  My engine processes the table, calls the generator for each scene, and handles the game logic - when the level is 'won' or lost, the engine itself tears down all of the items found in the table and generator-function(), then goes on to the next table entry.  This has made it very, very easy to build levels very quickly - most of the work is in the game/table design and how the generator emits characters for handling in the main game engine loop.<br /><br />For my GUI-based application, which is a little more conservative, I have been using (and extending) the moaigui contributed framework for my needs.  This has meant a lot more class/object-oriented development than I would normally feel comfortable using with MOAI, but it turns out to work okay.  But again, at the higher level, for each form in the application (screen/dialog, whatever you want to call it) there is a table defining the static data, and then a table full of handler methods for any of the GUI events.  This, also, works pretty well.<br /><br />For my next project, another physics game, I will return to the engine-eating-tables approach and leave the class() stuff alone - I don't *really* think its necessary for my projects, its mostly just a way for me to get organized using 'traditional methods', but for the most part with my MOAI experience now, I don't think its necessarily important - the table-contains-data-*And-functions idea (decoration) is pretty powerful.</div>

			<div id="sig4240" class="signature">;<br />--<br /><!-- e --><a href="mailto:ibisum@gmail.com">ibisum@gmail.com</a><!-- e -->  <br />Got a MOAI snippet?  Please consider adding it to <a href="http://moaisnippets.info" class="postlink">http://moaisnippets.info</a></div>

		</div>

		
			<dl class="postprofile" id="profile4240">
			<dt>
				<img src="../download/file.php%253favatar%253d262_1340630942.png" width="120" height="90" alt="User avatar" /><br />
				<strong>ibisum</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 1024</dd><dd><strong>Joined:</strong> Mon Oct 17, 2011 8:11 am</dd><dd><strong>Location:</strong> Vienna, Austria</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4247" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4247">Re: Organising a large Moai project's functionality: what ap</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>sgeos</strong> &raquo; Tue May 29, 2012 2:43 pm </p>

			

			<div class="content">I have a game state module that contains all the &quot;global&quot; data.  I pass that into other modules from the game loop in main.lua.  The plan is to use a data driven approach and drop game data into sqlite tables.</div>

			<div id="sig4247" class="signature">Any original code posted by me is released via the <a href="http://creativecommons.org/publicdomain/zero/1.0/legalcode" class="postlink">CC0 Public Domain Dedication</a>.  It is in the <span style="font-weight: bold">public domain</span>.  Do whatever you want with it.</div>

		</div>

		
			<dl class="postprofile" id="profile4247">
			<dt>
				<img src="../download/file.php%253favatar%253d844_1341653178.jpg" width="120" height="120" alt="User avatar" /><br />
				<strong>sgeos</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 241</dd><dd><strong>Joined:</strong> Sat Apr 28, 2012 11:42 am</dd><dd><strong>Location:</strong> Married in Japan.</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4249" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4249">Re: Organising a large Moai project's functionality: what ap</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>makotok1123</strong> &raquo; Tue May 29, 2012 4:38 pm </p>

			

			<div class="content">I have followed the principles of object-oriented.<br /><br />Create a class which will be a base, to add functionality to the order.<br />Delegates in some cases.<br /><br />Having a thin wrapper, automatically manage the resource.<br />Minimize the code to implement it.<br /><br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">layer <span style="color: #66cc66;">=</span> Layer <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">sprite <span style="color: #66cc66;">=</span> Sprite <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#123;</span>texture <span style="color: #66cc66;">=</span> <span style="color: #ff6666;">&quot;cathead.png&quot;</span><span style="color: #66cc66;">,</span> layer <span style="color: #66cc66;">=</span> layer<span style="color: #66cc66;">&#125;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl><br /><br />Game logic is based on the thinking entity.<br />This is the domain model.<br /> <br />I is not game developers,  business application developer.<br />may not necessarily be appropriate.<br /><br />-----<br />I'm familiar with ActionScript and Java.<br />In particular, ActionScript is using FlexSDK.<br />This is a very good model.<br /><br />I wanted to bring this idea to MOAISDK.<br />I have created a framework for own ease.<br />Framework is a result of certain came out.<br />Currently, while creating my game.<br /><br />The current results are published below.<br /><br /><!-- m --><a class="postlink" href="https://github.com/makotok/Hanappe">https://github.com/makotok/Hanappe</a><!-- m --></div>

			

		</div>

		
			<dl class="postprofile" id="profile4249">
			<dt>
				<strong>makotok1123</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 177</dd><dd><strong>Joined:</strong> Fri Jan 06, 2012 6:31 pm</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p4256" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="index.html#p4256">Re: Organising a large Moai project's functionality: what ap</a></h3>
			<p class="author"><img src="../styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>rhoster</strong> &raquo; Tue May 29, 2012 8:12 pm </p>

			

			<div class="content">I'll add my two cents to this here and provide links to the latest resources as of May 2012:<br /><br />My Background: I come from a Computer Science background, but have been pretty much exclusively coding in PHP/MySQL for the last few years.  Making the switch to Lua has been very easy!  There is plenty of great documentation on the web for getting started, here are a few links:<br /><br />Lua 5.2 Reference Manual - <!-- m --><a class="postlink" href="http://www.lua.org/manual/5.2/manual.html">http://www.lua.org/manual/5.2/manual.html</a><!-- m --><br />(I particularly like the EBNF for the language at the bottom section 9)<br />Programming in Lua - <!-- m --><a class="postlink" href="http://www.lua.org/pil/#online">http://www.lua.org/pil/#online</a><!-- m --><br /><br />The thing that threw me at first was that I wasn't sure exactly how to create an object oriented structure; I quickly learned that it would be through tables (the collection variable in Lua).  The code I ended up using came from this page and takes advantage of Metatables (a newer feature of Lua I believe) which seems to be the best practice for now:<br /><br /><!-- m --><a class="postlink" href="http://lua-users.org/wiki/LuaClassesWithMetatable">http://lua-users.org/wiki/LuaClassesWithMetatable</a><!-- m --><br /><br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> Class<span style="color: #66cc66;">&#40;</span>members<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; members <span style="color: #66cc66;">=</span> members <span style="color: #aa9900; font-weight: bold;">or</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> mt <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; __metatable <span style="color: #66cc66;">=</span> members<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; __index &nbsp; &nbsp; <span style="color: #66cc66;">=</span> members<span style="color: #66cc66;">;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> <span style="color: #aa9900; font-weight: bold;">function</span> new<span style="color: #66cc66;">&#40;</span>_<span style="color: #66cc66;">,</span> init<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> <span style="color: #0000aa;">setmetatable</span><span style="color: #66cc66;">&#40;</span>init <span style="color: #aa9900; font-weight: bold;">or</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span><span style="color: #66cc66;">,</span> mt<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> <span style="color: #aa9900; font-weight: bold;">function</span> copy<span style="color: #66cc66;">&#40;</span>obj<span style="color: #66cc66;">,</span> <span style="color: #66cc66;">...</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> newobj <span style="color: #66cc66;">=</span> obj<span style="color: #66cc66;">:</span>new<span style="color: #66cc66;">&#40;</span><span style="color: #0000aa;">unpack</span><span style="color: #66cc66;">&#40;</span>arg<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">for</span> n<span style="color: #66cc66;">,</span>v <span style="color: #aa9900; font-weight: bold;">in</span> <span style="color: #0000aa;">pairs</span><span style="color: #66cc66;">&#40;</span>obj<span style="color: #66cc66;">&#41;</span> <span style="color: #aa9900; font-weight: bold;">do</span> newobj<span style="color: #66cc66;">&#91;</span>n<span style="color: #66cc66;">&#93;</span> <span style="color: #66cc66;">=</span> v <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> newobj</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; members<span style="color: #66cc66;">.</span>new &nbsp;<span style="color: #66cc66;">=</span> members<span style="color: #66cc66;">.</span>new &nbsp;<span style="color: #aa9900; font-weight: bold;">or</span> new</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; members<span style="color: #66cc66;">.</span>copy <span style="color: #66cc66;">=</span> members<span style="color: #66cc66;">.</span>copy <span style="color: #aa9900; font-weight: bold;">or</span> copy</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> mt</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /></ol></code></dd></dl><br /><br />This gives you a basic Class object from which you can derive all other Objects.  The example Vector implementation is a perfect example and gives you a template for creating your own classes:<br /><br /><dl class="codebox"><dt>Code: <a href="index.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000aa;">require</span> <span style="color: #ff6666;">'Class'</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">Vector <span style="color: #66cc66;">=</span> <span style="color: #66cc66;">&#123;</span><span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> Vector_mt <span style="color: #66cc66;">=</span> Class<span style="color: #66cc66;">&#40;</span>Vector<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> Vector<span style="color: #66cc66;">:</span>new<span style="color: #66cc66;">&#40;</span>x<span style="color: #66cc66;">,</span>y<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> <span style="color: #0000aa;">setmetatable</span><span style="color: #66cc66;">&#40;</span> <span style="color: #66cc66;">&#123;</span>x<span style="color: #66cc66;">=</span>x<span style="color: #66cc66;">,</span> y<span style="color: #66cc66;">=</span>y<span style="color: #66cc66;">&#125;</span><span style="color: #66cc66;">,</span> Vector_mt<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> Vector<span style="color: #66cc66;">:</span>mag<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> <span style="color: #0000aa;">math.sqrt</span><span style="color: #66cc66;">&#40;</span>self<span style="color: #66cc66;">:</span>dot<span style="color: #66cc66;">&#40;</span>self<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> Vector<span style="color: #66cc66;">:</span>dot<span style="color: #66cc66;">&#40;</span>v<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">return</span> self<span style="color: #66cc66;">.</span>x <span style="color: #66cc66;">*</span> v<span style="color: #66cc66;">.</span>x <span style="color: #66cc66;">+</span> self<span style="color: #66cc66;">.</span>y <span style="color: #66cc66;">*</span> v<span style="color: #66cc66;">.</span>y</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /></ol></code></dd></dl><br /><br />So that is how I make my classes, for project structure - I tend to favor composition objects and inheritance if it truly makes sense (I haven't used it yet, but anticipate doing some for the game specific objects that I'd like to share a codebase).  I think the MVC framework is a little too heavy for this and I tend to separate things into just two sections, Control and Display.<br /><br />The benefits of composition are fairly well explained in this article (from 1998!!):<br /><br /><!-- m --><a class="postlink" href="http://www.javaworld.com/jw-11-1998/jw-11-techniques.html">http://www.javaworld.com/jw-11-1998/jw- ... iques.html</a><!-- m --><br /><br />-Bobby</div>

			

		</div>

		
			<dl class="postprofile" id="profile4256">
			<dt>
				<img src="../download/file.php%253favatar%253d909_1338398515.jpeg.html" width="80" height="80" alt="User avatar" /><br />
				<strong>rhoster</strong>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 205</dd><dd><strong>Joined:</strong> Sat May 26, 2012 10:59 pm</dd><dd><strong>Location:</strong> Santa Barbara, CA</dd>

		</dl>
	

		<div class="back2top"><a href="index.html#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<form id="viewtopic" method="post" action="index.html">

	<fieldset class="display-options" style="margin-top: 0; ">
		
	</fieldset>

	</form>
	<hr />


<div class="topic-actions">
	<div class="buttons">
	
	</div>

	
		<div class="pagination">
			14 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	
</div>


	<p></p><p><a href="../new-users.html" class="left-box left" accesskey="r">Return to New Users</a></p>

	<form method="post" id="jumpbox" action="http://192.168.20.226:3000/forums/viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	
		<fieldset class="jumpbox">
	
			<label for="f" accesskey="j">Jump to:</label>
			<select name="f" id="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">
			
				<option value="-1">Select a forum</option>
			<option value="-1">------------------</option>
				<option value="4">Moai Development Forums</option>
			
				<option value="7">&nbsp; &nbsp;Moai SDK</option>
			
				<option value="11">&nbsp; &nbsp;&nbsp; &nbsp;Community Contributions</option>
			
				<option value="8">&nbsp; &nbsp;Moai Cloud</option>
			
				<option value="9" selected="selected">&nbsp; &nbsp;New Users</option>
			
				<option value="10">&nbsp; &nbsp;Bug Reports</option>
			
				<option value="3">Moai Community Forums</option>
			
				<option value="5">&nbsp; &nbsp;Moai Roadmap</option>
			
				<option value="6">&nbsp; &nbsp;Made With Moai</option>
			
			</select>
			<input type="submit" value="Go" class="button2" />
		</fieldset>
	</form>


	<h3>Who is online</h3>
	<p>Users browsing this forum: No registered users and 0 guests</p>
</div>

<div id="page-footer">

	<div class="navbar">
		<div class="inner"><span class="corners-top"><span></span></span>

		<ul class="linklist">
			<li class="icon-home"><a href="../index.html" accesskey="h">Board index</a></li>
				
			<li class="rightside">All times are UTC </li>
		</ul>

		<span class="corners-bottom"><span></span></span></div>
	</div>
	
	<div class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group<br />Style by <a href="http://www.m-a-styles.de">Marc Alexander</a> &copy;
		<br /><br /><a href="http://www.phpbb-seo.com/" title="Search Engine Optimization"><img src="../images/phpbb-seo.png" alt="phpBB SEO"/></a><br />Time : 0.083s | 11 Queries | GZIP : Off
	</div>
</div>

</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
	
	</div>
	</div>
<div class="nobottomgap"></div>
</div>
<!--- end of box border -->
</div></div>
<!-- -->
<div class="bottom-left"></div><div class="bottom-center"></div><div class="bottom-right"></div>
</div>
<!-- JQuery Pop Up --><!-- PM Popup --><!-- PM Popup end --><!-- Image Popup -->
<div id="popupImage">
	<p id="ImagePopup"></p>
	<a id="popupImageClose">x</a> 
</div>
<!-- Image Popup -->
<div id="backgroundPopup"></div> 
<!-- JQuery Pop Up END -->
</body>
</html>