<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta name="robots" content="noindex" />

<title>Moai Forum &bull; View topic - Lua Error Capturing/Logging</title>

<link href="styles/proFormell/theme/print.css" rel="stylesheet" type="text/css" />
<link type="image/vnd.microsoft.icon" rel="shortcut icon" href="styles/proFormell/theme/images/favicon.ico">
</head>

<body id="phpbb">
<div id="wrap">
	<a id="top" name="top" accesskey="t"></a>

	<div id="page-header">
		<h1>Moai Forum</h1>
		<p>The mobile platform for pro game developers<br /><a href="index.html">/forums/</a></p>

		<h2>Lua Error Capturing/Logging</h2>
		<p><a href="lua-error-capturing-logging-t2433/index.html">/forums/lua-error-capturing-logging-t2433/</a></p>
	</div>

	<div id="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
		
			<div class="post">
				<h3>Lua Error Capturing/Logging</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Wed Dec 25, 2013 2:32 am</strong></div>
				<div class="author">by <strong>Drake250</strong></div>
				<div class="content">So let's say I get a Lua error like this logged in the console while playing my app:<br /><br />E.G. when something happens<br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=7&amp;t=2433&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="text" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">.\game\file.lua:23: attempt to perform arithmetic on global 'dsfsd' (a nil value)</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">stack traceback:</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; [C] ?</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; .\game\file.lua:23 in function 'callback'</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; .\main.lua:11 in function 'start'</div></li><br /></ol></code></dd></dl>Is there a way to pipe this output to a file, like error.log, instead of standard output?<br /><br />I've played around with MOAILogMgr but that doesn't seem to handle these Lua errors.</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: Lua Error Capturing/Logging</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Wed Dec 25, 2013 3:54 am</strong></div>
				<div class="author">by <strong>btatarov</strong></div>
				<div class="content">The first thing that comes to my mind is:<br /><br /><span style="font-weight: bold">main.lua</span><br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=7&amp;t=2433&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">local</span> status<span style="color: #66cc66;">,</span> err <span style="color: #66cc66;">=</span> <span style="color: #0000aa;">pcall</span><span style="color: #66cc66;">&#40;</span><span style="color: #aa9900; font-weight: bold;">function</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #0000aa;">dofile</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;somefile.lua&quot;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #aa9900; font-weight: bold;">end</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">if</span> <span style="color: #aa9900; font-weight: bold;">not</span> status <span style="color: #aa9900; font-weight: bold;">then</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #808080; font-style: italic;">-- write err variable to a file</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl><br />Where somefile.lua is your main lua file.<br /><br />If you also need the traceback, you can try something like this (not sure if it will work, can't test right now):<br /><br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=7&amp;t=2433&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000aa;">xpcall</span><span style="color: #66cc66;">&#40;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">function</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp;<span style="color: #0000aa;">dofile</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;somefile.lua&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">end</span><span style="color: #66cc66;">,</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">function</span><span style="color: #66cc66;">&#40;</span>msg<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">-- write msg to file</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">-- write debug.traceback() to file</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; <span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl></div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: Lua Error Capturing/Logging</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Wed Dec 25, 2013 4:50 am</strong></div>
				<div class="author">by <strong>ezraanderson</strong></div>
				<div class="content">~<br />Yes, with MOAISim.setTraceback<br /><ul><li> docs--&gt; <!-- m --><a class="postlink" href="http://192.168.20.226:3000/docs/class_m_o_a_i_sim.html">/docs/class_m_o_a_i_sim.html</a><!-- m --></li><li> example --&gt; <!-- m --><a class="postlink" href="https://github.com/moai/moai-dev/blob/master/samples/util/util-crash-report/main.lua">https://github.com/moai/moai-dev/blob/m ... t/main.lua</a><!-- m --></li></ul><br />Check out the error handling video<br /><ul><li> video --&gt; <!-- l --><a class="postlink-local" href="website-launched-www-dead-dark-com-t1912/index.html">website-launched-www-dead-dark-com-t1912/</a><!-- l --></li></ul></div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: Lua Error Capturing/Logging</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Wed Dec 25, 2013 6:36 pm</strong></div>
				<div class="author">by <strong>Drake250</strong></div>
				<div class="content">MOAISim.setTrackback is perfect. Following that example I added this to my main code:<br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=7&amp;t=2433&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">MOAISim<span style="color: #66cc66;">.</span>setTraceback<span style="color: #66cc66;">&#40;</span><span style="color: #aa9900; font-weight: bold;">function</span><span style="color: #66cc66;">&#40;</span>message<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> trace <span style="color: #66cc66;">=</span> message <span style="color: #66cc66;">..</span> <span style="color: #ff6666;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span> <span style="color: #66cc66;">..</span> <span style="color: #0000aa;">debug</span><span style="color: #66cc66;">.</span>traceback<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> file <span style="color: #66cc66;">=</span> <span style="color: #0000aa;">io.open</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;error.log&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #ff6666;">&quot;w&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; file<span style="color: #66cc66;">:</span><span style="color: #0000aa;">write</span><span style="color: #66cc66;">&#40;</span>trace<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; file<span style="color: #66cc66;">:</span>close<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #0000aa;">print</span> <span style="color: #66cc66;">&#40;</span>trace<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span><span style="color: #66cc66;">&#41;</span></div></li><br /></ol></code></dd></dl><br />I initially tried to wrap my code in a xpcall() but that only got me the error message, not the traceback. debug.traceback() at that point gives a trace back to the callback in the xpcall(), not where the error occurred.<br /><br />I love the idea of dumping a screenshot too with errors. Do you have any example code for how to dump screenshots? I did not know MOAI was capable of this.<br /><br /><span style="font-style: italic">As a side note</span>: Developing in ZeroBrane Studio with the MOAISim.setTraceback set I no longer get the tracebacks at all: no terminal output and the traceback function doesn't get called when faulty code breaks. Only when I run my code outside of ZeroBrane Studio does it work, which is fine because I'm setting up this error logging for testers who won't be developing. Just thought I'd mention this for anyone trying this in the future.</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: Lua Error Capturing/Logging</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Wed Dec 25, 2013 8:21 pm</strong></div>
				<div class="author">by <strong>ezraanderson</strong></div>
				<div class="content">~<br />Dumping an error log with a screenshot to post to a server(or email to fogbugz) is a good technique for debugging.<br /><br />MOAIRenderMgr.grabNextFrame<br /><ul><li> <!-- m --><a class="postlink" href="http://192.168.20.226:3000/docs/class_m_o_a_i_render_mgr.html">/docs/class_m_o_a_i_render_mgr.html</a><!-- m --></li><li> <!-- m --><a class="postlink" href="https://github.com/moai/moai-dev/blob/master/samples/image/image-framebuffer-grab/main.lua">https://github.com/moai/moai-dev/blob/m ... b/main.lua</a><!-- m --></li></ul><br />Depending on the release of Moai you are using, check this thread.<br /><ul><li> <!-- l --><a class="postlink-local" href="image-framebuffer-grab-sample-not-working-t1748/index.html">image-framebuffer-grab-sample-not-working-t1748/</a><!-- l --></li></ul></div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: Lua Error Capturing/Logging</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Sat Dec 28, 2013 1:08 am</strong></div>
				<div class="author">by <strong>Drake250</strong></div>
				<div class="content">Thanks. Although those links didn't really help, I did manage through lots of trial &amp; error and some poking around on the forums I managed to take screen grabs and dump them to a file.<br /><br />Here's why I ended up with (roughly, I removed some of the flower specific code to make it more easily readable for newer MOAI users):<br /><dl class="codebox"><dt>Code: <a href="viewtopic.php%3Ff=7&amp;t=2433&amp;start=0&amp;view=print.html#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code style="line-height: 30%;"><ol class="lua" style="font-family:monospace;"><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">ftp <span style="color: #66cc66;">=</span> <span style="color: #0000aa;">require</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;socket.ftp&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">ltn12 <span style="color: #66cc66;">=</span> <span style="color: #0000aa;">require</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;ltn12&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">function</span> handleError<span style="color: #66cc66;">&#40;</span>trace<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;ERROR!&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> filename <span style="color: #66cc66;">=</span> <span style="color: #ff6666;">&quot;error&quot;</span> <span style="color: #66cc66;">..</span> <span style="color: #0000aa;">os.date</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;-%m_%d_%Y-%H.%M.%S&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #0000aa;">os.time</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;- writing error to file&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">local</span> file <span style="color: #66cc66;">=</span> <span style="color: #0000aa;">io.open</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;logs/&quot;</span> <span style="color: #66cc66;">..</span> filename <span style="color: #66cc66;">..</span> <span style="color: #ff6666;">&quot;.txt&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #ff6666;">&quot;w&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; file<span style="color: #66cc66;">:</span><span style="color: #0000aa;">write</span><span style="color: #66cc66;">&#40;</span>trace<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; file<span style="color: #66cc66;">:</span>close<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;- uploading error text to server&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; ftp<span style="color: #66cc66;">.</span>put<span style="color: #66cc66;">&#123;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; host <span style="color: #66cc66;">=</span> <span style="color: #ff6666;">&quot;ftp.yoursite.com&quot;</span><span style="color: #66cc66;">,</span> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; user <span style="color: #66cc66;">=</span> <span style="color: #ff6666;">&quot;yourFtpUser&quot;</span><span style="color: #66cc66;">,</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; password <span style="color: #66cc66;">=</span> <span style="color: #ff6666;">&quot;password&quot;</span><span style="color: #66cc66;">,</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; command <span style="color: #66cc66;">=</span> <span style="color: #ff6666;">&quot;STOR&quot;</span><span style="color: #66cc66;">,</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000aa;">type</span> <span style="color: #66cc66;">=</span> <span style="color: #ff6666;">&quot;a&quot;</span><span style="color: #66cc66;">,</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; argument <span style="color: #66cc66;">=</span> filename <span style="color: #66cc66;">..</span> <span style="color: #ff6666;">&quot;.txt&quot;</span><span style="color: #66cc66;">,</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; source <span style="color: #66cc66;">=</span> ltn12<span style="color: #66cc66;">.</span>source<span style="color: #66cc66;">.</span>file<span style="color: #66cc66;">&#40;</span><span style="color: #0000aa;">io.open</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;logs/&quot;</span> <span style="color: #66cc66;">..</span> filename <span style="color: #66cc66;">..</span> <span style="color: #ff6666;">&quot;.txt&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #ff6666;">&quot;r&quot;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;- capturing screenshot of error&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; img <span style="color: #66cc66;">=</span> MOAIImage<span style="color: #66cc66;">.</span>new<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">--fbf = MOAIGfxDevice.getFrameBuffer() -- Works, but produces weird &quot;Attempt to access MOAILuaObject userdata tagged for garbage collection&quot; errors...</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; fbf <span style="color: #66cc66;">=</span> MOAIFrameBufferTexture<span style="color: #66cc66;">.</span>new <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; fbf<span style="color: #66cc66;">:</span>setRenderTable<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#123;</span>game<span style="color: #66cc66;">.</span>layer<span style="color: #66cc66;">,</span> game<span style="color: #66cc66;">.</span>GUIlayer<span style="color: #66cc66;">&#125;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; fbf<span style="color: #66cc66;">:</span>init <span style="color: #66cc66;">&#40;</span>game<span style="color: #66cc66;">.</span>screenWidth<span style="color: #66cc66;">,</span> game<span style="color: #66cc66;">.</span>screenHeight<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; MOAIRenderMgr<span style="color: #66cc66;">.</span>setBufferTable <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#123;</span>fbf<span style="color: #66cc66;">&#125;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; fbf<span style="color: #66cc66;">:</span>grabNextFrame<span style="color: #66cc66;">&#40;</span>img<span style="color: #66cc66;">,</span> <span style="color: #aa9900; font-weight: bold;">function</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;- writing screenshot to file&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; img<span style="color: #66cc66;">:</span>writePNG<span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;logs/&quot;</span> <span style="color: #66cc66;">..</span> filename <span style="color: #66cc66;">..</span> &nbsp;<span style="color: #ff6666;">&quot;.png&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;- uploading error screenshot to server&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; ftp<span style="color: #66cc66;">.</span>put<span style="color: #66cc66;">&#123;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; host <span style="color: #66cc66;">=</span> <span style="color: #ff6666;">&quot;ftp.yoursite.com&quot;</span><span style="color: #66cc66;">,</span> </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; user <span style="color: #66cc66;">=</span> <span style="color: #ff6666;">&quot;yourFtpUser&quot;</span><span style="color: #66cc66;">,</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; password <span style="color: #66cc66;">=</span> <span style="color: #ff6666;">&quot;password&quot;</span><span style="color: #66cc66;">,</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; command <span style="color: #66cc66;">=</span> <span style="color: #ff6666;">&quot;STOR&quot;</span><span style="color: #66cc66;">,</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000aa;">type</span> <span style="color: #66cc66;">=</span> <span style="color: #ff6666;">&quot;i&quot;</span><span style="color: #66cc66;">,</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; argument <span style="color: #66cc66;">=</span> filename <span style="color: #66cc66;">..</span> <span style="color: #ff6666;">&quot;.png&quot;</span><span style="color: #66cc66;">,</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; source <span style="color: #66cc66;">=</span> ltn12<span style="color: #66cc66;">.</span>source<span style="color: #66cc66;">.</span>file<span style="color: #66cc66;">&#40;</span><span style="color: #0000aa;">io.open</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;logs/&quot;</span> <span style="color: #66cc66;">..</span> filename <span style="color: #66cc66;">..</span> <span style="color: #ff6666;">&quot;.png&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #ff6666;">&quot;rb&quot;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; </div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">-- show on console</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff6666;">&quot;- here's the error the broke the game:&quot;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000aa;">print</span><span style="color: #66cc66;">&#40;</span>trace<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #aa9900; font-weight: bold;">end</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">MOAISim<span style="color: #66cc66;">.</span>setTraceback<span style="color: #66cc66;">&#40;</span><span style="color: #aa9900; font-weight: bold;">function</span><span style="color: #66cc66;">&#40;</span>message<span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; handleError<span style="color: #66cc66;">&#40;</span>message <span style="color: #66cc66;">..</span> <span style="color: #ff6666;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span> <span style="color: #66cc66;">..</span> <span style="color: #0000aa;">debug</span><span style="color: #66cc66;">.</span>traceback<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #aa9900; font-weight: bold;">end</span><span style="color: #66cc66;">&#41;</span></div></li><br /><li style="line-height: 50%;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><br /></ol></code></dd></dl>This code:<br /><ul><li> intercept the error and trace</li><li> save the error and a screenshot of the game at the time</li><li> upload those files to a remote FTP server</li></ul>I also have a text file I ship with packages to my testers that identifies them so I tack that info into the text log to identify who produced which errors, all without any reporting on their end.<br /><br />I've added this to MOAI Snippets as well.</div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: Lua Error Capturing/Logging</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Sat Dec 28, 2013 4:15 am</strong></div>
				<div class="author">by <strong>ezraanderson</strong></div>
				<div class="content">~<br />great snippet <img src="images/smilies/icon_e_smile.gif" alt=":)" title="Smile" /></div>
			</div>
			<hr />
		
			<div class="post">
				<h3>Re: Lua Error Capturing/Logging</h3>
				<div class="date"><img src="styles/proFormell/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />Posted: <strong>Sun Dec 29, 2013 2:16 am</strong></div>
				<div class="author">by <strong>naturally</strong></div>
				<div class="content">Awesome snippet Drake250, adding this to the Top Tips thread.</div>
			</div>
			<hr />
		
	</div>

	<div id="page-footer">
		<div class="page-number">All times are UTC <br />Page <strong>1</strong> of <strong>1</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</div>
	</div>
</div>

</body>
</html>